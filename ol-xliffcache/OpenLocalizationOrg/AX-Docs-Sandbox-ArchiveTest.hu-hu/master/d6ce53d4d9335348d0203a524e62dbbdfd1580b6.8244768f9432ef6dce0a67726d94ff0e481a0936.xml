{"content":"---\n# required metadata\n\ntitle: Depreciation book upgrade overview\ndescription: In previous releases, there were two valuation concepts for fixed assets -  value models and depreciation books. In Microsoft Dynamics 365 for Operations (1611), the value model functionality and depreciation book functionality have been merged into a single concept that is known as a book. This topic provides some things to consider for the upgrade. \nauthor: twheeloc\nmanager: AnnBe\nms.date: 06/20/2017\nms.topic: article\nms.prod: \nms.service: dynamics-ax-applications\nms.technology: \n\n# optional metadata\n\n# ms.search.form: \n# ROBOTS: \naudience: Application User, Developer\n# ms.devlang: \nms.reviewer: twheeloc\nms.search.scope: Core, Operations, UnifiedOperations\n# ms.tgt_pltfrm: \nms.custom: 221624\nms.assetid: cf434099-36f9-4b0f-a7c8-bed091e34f39\nms.search.region: global\n# ms.search.industry: \nms.author: saraschi\nms.search.validFrom: 2016-11-30\nms.dyn365.ops.version: Version 1611\n\n---\n\n# Depreciation book upgrade overview\n\n[!include[banner](../includes/banner.md)]\n\n\nIn previous releases, there were two valuation concepts for fixed assets -  value models and depreciation books. In Microsoft Dynamics 365 for Operations (1611), the value model functionality and depreciation book functionality have been merged into a single concept that is known as a book. This topic provides some things to consider for the upgrade. \n\nThe upgrade process will move your existing setup and all existing transactions to the new book structure. Value models will remain as they currently are, as a book that posts to the general ledger. Depreciation books will be moved to a book that has the **Post to general ledger** option set to **No**. Depreciation book journal names will be moved to a general ledger journal name with the posting layer set to **None**. Depreciation book transactions will be moved to Fixed asset transactions. \n\nBefore running the data upgrade, you should understand the two options available for upgrading depreciation book journal lines to transaction vouchers, and the number sequence that will be used for the voucher series. \n\nOption 1:  **System-defined number sequence** - This is the default option to optimize upgrade performance. The upgrade will not use the number sequences framework, but instead will allocate vouchers with a set-based approach. After the upgrade, the new number sequence will be created with the **Next number set** appropriately based on the upgraded transactions. By default, the number sequence used will be in the FADBUpgr\\#\\#\\#\\#\\#\\#\\#\\#\\# format. There are a few parameters available to you to adjust the format when using this approach:\n\n-   **Number sequence code** – The code to identify the number sequence. This number sequence code cannot exist since it will be created by the upgrade.\n    -   Constant name: **NumberSequenceDefaultCode**\n    -   Default value: \"FADBUpgr\"\n-   **Prefix** – The constant string value that will be used as a prefix for the voucher numbers.\n    -   Constant name: **NumberSequenceDefaultParameterPrefix**\n    -   Default value: \"FADBUpgr\"\n-   **Alphanumeric length** – The length of the alphanumeric segment of the number sequence.\n    -   Constant name: **NumberSequenceDefaultParameterAlpanumericLength **\n    -   Default value: 9\n-   **Start number** - The first number to be used in the number sequence.\n    -   Constant name: **NumberSequenceDefaultParameterStartNumber  **\n    -   Default value: 1\n\nOption 2: **Existing user-defined number sequence** - This option will allow you to define the number sequence to be used for the upgrade. Consider using this option if you need advanced number sequence configuration. To use a number sequence, you must modify the upgrade class ReleaseUpdateDB70\\_FixedAssetJournalDepBookRemovalDepBookJournalTrans with the following information:\n\n-   **Number sequence code** – The code of the number sequence.\n    -   Constant name: **NumberSequenceExistingCode **\n    -   Default value: No default, this must be updated to the number sequence code.\n-   **Shared number sequence** – A boolean value to identify the scope of the number sequence. Use \"true\" for shared number sequences across all companies, and \"false\" for a company-specific scope. When using \"false\", the number sequence with the specified name must exist in every company that contains depreciation book transactions. Shared number sequences exist in every partition that contains depreciation book transactions.\n    -   Constant name: **NumberSequenceExistingIsShared **\n    -   Default value: true\n\nThe parameters are located at the beginning of the ReleaseUpdateDB70\\_FixedAssetJournalDepBookRemovalDepBookJournalTrans class. \n\n*// Specify a preferable approach of vouchers allocation* \n*// true, if you want to use an existing number sequence code* \n*// false, if you intend to use the system-defined number sequence (default)* const boolean NumberSequenceUseExistingCode = false;  \n\n*// If using the system-defined number sequence approach, specify the parameters for the number sequence.*\n*// A new number sequence will be created with these parameters.* \nconst str NumberSequenceDefaultCode = 'FADBUpgr'; \nconst str NumberSequenceDefaultParameterPrefix = 'FADBUpgr'; \nconst int NumberSequenceDefaultParameterAlpanumericLength = 9; \nconst int NumberSequenceDefaultParameterStartNumber = 1;   \n\n*// If using the existing number sequence approach, specify the existing number sequence code.* \n*// Voucher allocation will go row-by-row for existing number sequences.* \nconst str NumberSequenceExistingCode = ''; \n*// Specify the scope of the existing number sequence code* \n*// true, if the specified number sequence is shared* \n*// false, if the specified number sequence is per-company* \n*// The default system-defined number sequence will be used if a number sequence code with the specified scope is not found.* \nconst boolean NumberSequenceExistingIsShared = true; \n\nRebuild the project that contains the class after the constants have been modified. \n\nWhen using the system-generated number sequence approach (option 1), the upgrade will use set-based processing to allocate the voucher numbers as specified in the upgrade script parameters. It will also create a new number sequence with specified parameters after the allocation. \n\nWhen using the user-defined existing number sequence approach (option 2), the data upgrade checks whether the number sequence with the specified scope exists in the database for each partition and company with depreciation book transactions. If it does exist, the upgrade will use row-by-row processing to allocate the voucher numbers as specified by the number sequence using the number sequence framework. If the number sequence does not exist with the specified scope, the upgrade will use the default system-defined number sequence approach to allocate the voucher numbers, and will create a new number sequence with specified default parameters after the allocation.\n\nWith either approach, the data upgrade script will also use the number sequence for the **Voucher series** field on the new general ledger journal names created for the former depreciation book journal names.\n\n\n\n","nodes":[{"pos":[4,968],"embed":true,"restype":"x-metadata","content":"# required metadata\n\ntitle: Depreciation book upgrade overview\ndescription: In previous releases, there were two valuation concepts for fixed assets -  value models and depreciation books. In Microsoft Dynamics 365 for Operations (1611), the value model functionality and depreciation book functionality have been merged into a single concept that is known as a book. This topic provides some things to consider for the upgrade. \nauthor: twheeloc\nmanager: AnnBe\nms.date: 06/20/2017\nms.topic: article\nms.prod: \nms.service: dynamics-ax-applications\nms.technology: \n\n# optional metadata\n\n# ms.search.form: \n# ROBOTS: \naudience: Application User, Developer\n# ms.devlang: \nms.reviewer: twheeloc\nms.search.scope: Core, Operations, UnifiedOperations\n# ms.tgt_pltfrm: \nms.custom: 221624\nms.assetid: cf434099-36f9-4b0f-a7c8-bed091e34f39\nms.search.region: global\n# ms.search.industry: \nms.author: saraschi\nms.search.validFrom: 2016-11-30\nms.dyn365.ops.version: Version 1611\n","nodes":[{"content":"Depreciation book upgrade overview","nodes":[{"pos":[0,34],"content":"Depreciation book upgrade overview","nodes":[{"content":"Depreciation book upgrade overview","pos":[0,34]}]}],"path":["title"],"extradata":"MT"},{"content":"In previous releases, there were two valuation concepts for fixed assets -  value models and depreciation books. In Microsoft Dynamics 365 for Operations (1611), the value model functionality and depreciation book functionality have been merged into a single concept that is known as a book. This topic provides some things to consider for the upgrade.","nodes":[{"pos":[0,352],"content":"In previous releases, there were two valuation concepts for fixed assets -  value models and depreciation books. In Microsoft Dynamics 365 for Operations (1611), the value model functionality and depreciation book functionality have been merged into a single concept that is known as a book. This topic provides some things to consider for the upgrade.","nodes":[{"content":"In previous releases, there were two valuation concepts for fixed assets -  value models and depreciation books. In Microsoft Dynamics 365 for Operations (1611), the value model functionality and depreciation book functionality have been merged into a single concept that is known as a book. This topic provides some things to consider for the upgrade.","pos":[0,352],"nodes":[{"content":"In previous releases, there were two valuation concepts for fixed assets -  value models and depreciation books.","pos":[0,112]},{"content":"In Microsoft Dynamics 365 for Operations (1611), the value model functionality and depreciation book functionality have been merged into a single concept that is known as a book.","pos":[113,291]},{"content":"This topic provides some things to consider for the upgrade.","pos":[292,352]}]}]}],"path":["description"],"extradata":"MT"}],"header":"# required metadata\n","yml":true},{"pos":[976,1010],"content":"Depreciation book upgrade overview","linkify":"Depreciation book upgrade overview","nodes":[{"content":"Depreciation book upgrade overview","pos":[0,34]}]},{"content":"In previous releases, there were two valuation concepts for fixed assets -  value models and depreciation books.","pos":[1056,1168]},{"content":"In Microsoft Dynamics 365 for Operations (1611), the value model functionality and depreciation book functionality have been merged into a single concept that is known as a book.","pos":[1169,1347]},{"content":"This topic provides some things to consider for the upgrade.","pos":[1348,1408]},{"content":"The upgrade process will move your existing setup and all existing transactions to the new book structure.","pos":[1411,1517]},{"content":"Value models will remain as they currently are, as a book that posts to the general ledger.","pos":[1518,1609]},{"content":"Depreciation books will be moved to a book that has the <bpt id=\"p1\">**</bpt>Post to general ledger<ept id=\"p1\">**</ept> option set to <bpt id=\"p2\">**</bpt>No<ept id=\"p2\">**</ept>.","pos":[1610,1714],"source":" Depreciation books will be moved to a book that has the **Post to general ledger** option set to **No**."},{"content":"Depreciation book journal names will be moved to a general ledger journal name with the posting layer set to <bpt id=\"p1\">**</bpt>None<ept id=\"p1\">**</ept>.","pos":[1715,1833],"source":" Depreciation book journal names will be moved to a general ledger journal name with the posting layer set to **None**."},{"content":"Depreciation book transactions will be moved to Fixed asset transactions.","pos":[1834,1907]},{"content":"Before running the data upgrade, you should understand the two options available for upgrading depreciation book journal lines to transaction vouchers, and the number sequence that will be used for the voucher series.","pos":[1910,2127]},{"content":"Option 1:  <bpt id=\"p1\">**</bpt>System-defined number sequence<ept id=\"p1\">**</ept> - This is the default option to optimize upgrade performance.","pos":[2130,2237],"source":"Option 1:  **System-defined number sequence** - This is the default option to optimize upgrade performance."},{"content":"The upgrade will not use the number sequences framework, but instead will allocate vouchers with a set-based approach.","pos":[2238,2356]},{"content":"After the upgrade, the new number sequence will be created with the <bpt id=\"p1\">**</bpt>Next number set<ept id=\"p1\">**</ept> appropriately based on the upgraded transactions.","pos":[2357,2494],"source":" After the upgrade, the new number sequence will be created with the **Next number set** appropriately based on the upgraded transactions."},{"content":"By default, the number sequence used will be in the FADBUpgr<ph id=\"ph1\">\\#</ph><ph id=\"ph2\">\\#</ph><ph id=\"ph3\">\\#</ph><ph id=\"ph4\">\\#</ph><ph id=\"ph5\">\\#</ph><ph id=\"ph6\">\\#</ph><ph id=\"ph7\">\\#</ph><ph id=\"ph8\">\\#</ph><ph id=\"ph9\">\\#</ph> format.","pos":[2495,2581],"source":" By default, the number sequence used will be in the FADBUpgr\\#\\#\\#\\#\\#\\#\\#\\#\\# format."},{"content":"There are a few parameters available to you to adjust the format when using this approach:","pos":[2582,2672]},{"content":"<bpt id=\"p1\">**</bpt>Number sequence code<ept id=\"p1\">**</ept> – The code to identify the number sequence.","pos":[2678,2746],"source":"**Number sequence code** – The code to identify the number sequence."},{"content":"This number sequence code cannot exist since it will be created by the upgrade.","pos":[2747,2826]},{"pos":[2835,2879],"content":"Constant name: <bpt id=\"p1\">**</bpt>NumberSequenceDefaultCode<ept id=\"p1\">**</ept>","source":"Constant name: **NumberSequenceDefaultCode**"},{"content":"Default value: \"FADBUpgr\"","pos":[2888,2913]},{"pos":[2918,3011],"content":"<bpt id=\"p1\">**</bpt>Prefix<ept id=\"p1\">**</ept> – The constant string value that will be used as a prefix for the voucher numbers.","source":"**Prefix** – The constant string value that will be used as a prefix for the voucher numbers."},{"pos":[3020,3075],"content":"Constant name: <bpt id=\"p1\">**</bpt>NumberSequenceDefaultParameterPrefix<ept id=\"p1\">**</ept>","source":"Constant name: **NumberSequenceDefaultParameterPrefix**"},{"content":"Default value: \"FADBUpgr\"","pos":[3084,3109]},{"pos":[3114,3202],"content":"<bpt id=\"p1\">**</bpt>Alphanumeric length<ept id=\"p1\">**</ept> – The length of the alphanumeric segment of the number sequence.","source":"**Alphanumeric length** – The length of the alphanumeric segment of the number sequence."},{"content":"Constant name: **NumberSequenceDefaultParameterAlpanumericLength **","pos":[3211,3278]},{"content":"Default value: 9","pos":[3287,3303]},{"pos":[3308,3378],"content":"<bpt id=\"p1\">**</bpt>Start number<ept id=\"p1\">**</ept> - The first number to be used in the number sequence.","source":"**Start number** - The first number to be used in the number sequence."},{"content":"Constant name: **NumberSequenceDefaultParameterStartNumber  **","pos":[3387,3449]},{"content":"Default value: 1","pos":[3458,3474]},{"content":"Option 2: <bpt id=\"p1\">**</bpt>Existing user-defined number sequence<ept id=\"p1\">**</ept> - This option will allow you to define the number sequence to be used for the upgrade.","pos":[3476,3614],"source":"Option 2: **Existing user-defined number sequence** - This option will allow you to define the number sequence to be used for the upgrade."},{"content":"Consider using this option if you need advanced number sequence configuration.","pos":[3615,3693]},{"content":"To use a number sequence, you must modify the upgrade class ReleaseUpdateDB70<ph id=\"ph1\">\\_</ph>FixedAssetJournalDepBookRemovalDepBookJournalTrans with the following information:","pos":[3694,3855],"source":" To use a number sequence, you must modify the upgrade class ReleaseUpdateDB70\\_FixedAssetJournalDepBookRemovalDepBookJournalTrans with the following information:"},{"pos":[3861,3920],"content":"<bpt id=\"p1\">**</bpt>Number sequence code<ept id=\"p1\">**</ept> – The code of the number sequence.","source":"**Number sequence code** – The code of the number sequence."},{"content":"Constant name: **NumberSequenceExistingCode **","pos":[3929,3975]},{"content":"Default value: No default, this must be updated to the number sequence code.","pos":[3984,4060]},{"content":"<bpt id=\"p1\">**</bpt>Shared number sequence<ept id=\"p1\">**</ept> – A boolean value to identify the scope of the number sequence.","pos":[4065,4155],"source":"**Shared number sequence** – A boolean value to identify the scope of the number sequence."},{"content":"Use \"true\" for shared number sequences across all companies, and \"false\" for a company-specific scope.","pos":[4156,4258]},{"content":"When using \"false\", the number sequence with the specified name must exist in every company that contains depreciation book transactions.","pos":[4259,4396]},{"content":"Shared number sequences exist in every partition that contains depreciation book transactions.","pos":[4397,4491]},{"content":"Constant name: **NumberSequenceExistingIsShared **","pos":[4500,4550]},{"content":"Default value: true","pos":[4559,4578]},{"content":"The parameters are located at the beginning of the ReleaseUpdateDB70<ph id=\"ph1\">\\_</ph>FixedAssetJournalDepBookRemovalDepBookJournalTrans class.","pos":[4580,4707],"source":"The parameters are located at the beginning of the ReleaseUpdateDB70\\_FixedAssetJournalDepBookRemovalDepBookJournalTrans class."},{"pos":[4710,4963],"content":"<bpt id=\"p1\">*</bpt>// Specify a preferable approach of vouchers allocation<ept id=\"p1\">*</ept><ph id=\"ph1\"> \n</ph><bpt id=\"p2\">*</bpt>// true, if you want to use an existing number sequence code<ept id=\"p2\">*</ept><ph id=\"ph2\"> \n</ph><bpt id=\"p3\">*</bpt>// false, if you intend to use the system-defined number sequence (default)<ept id=\"p3\">*</ept> const boolean NumberSequenceUseExistingCode = false;","source":"*// Specify a preferable approach of vouchers allocation* \n*// true, if you want to use an existing number sequence code* \n*// false, if you intend to use the system-defined number sequence (default)* const boolean NumberSequenceUseExistingCode = false;"},{"content":"<bpt id=\"p1\">*</bpt>// If using the system-defined number sequence approach, specify the parameters for the number sequence.<ept id=\"p1\">*</ept><ph id=\"ph1\">\n</ph><bpt id=\"p2\">*</bpt>// A new number sequence will be created with these parameters.<ept id=\"p2\">*</ept>","pos":[4967,5139],"source":"*// If using the system-defined number sequence approach, specify the parameters for the number sequence.*\n*// A new number sequence will be created with these parameters.*"},{"content":"const str NumberSequenceDefaultCode = 'FADBUpgr'; const str NumberSequenceDefaultParameterPrefix = 'FADBUpgr'; const int NumberSequenceDefaultParameterAlpanumericLength = 9; const int NumberSequenceDefaultParameterStartNumber = 1;","pos":[5140,5374],"source":" \nconst str NumberSequenceDefaultCode = 'FADBUpgr'; \nconst str NumberSequenceDefaultParameterPrefix = 'FADBUpgr'; \nconst int NumberSequenceDefaultParameterAlpanumericLength = 9; \nconst int NumberSequenceDefaultParameterStartNumber = 1;"},{"content":"<bpt id=\"p1\">*</bpt>// If using the existing number sequence approach, specify the existing number sequence code.<ept id=\"p1\">*</ept><ph id=\"ph1\"> \n</ph><bpt id=\"p2\">*</bpt>// Voucher allocation will go row-by-row for existing number sequences.<ept id=\"p2\">*</ept>","pos":[5379,5549],"source":"*// If using the existing number sequence approach, specify the existing number sequence code.* \n*// Voucher allocation will go row-by-row for existing number sequences.*"},{"content":"const str NumberSequenceExistingCode = ''; <bpt id=\"p1\">*</bpt>// Specify the scope of the existing number sequence code<ept id=\"p1\">*</ept><ph id=\"ph1\"> \n</ph><bpt id=\"p2\">*</bpt>// true, if the specified number sequence is shared<ept id=\"p2\">*</ept><ph id=\"ph2\"> \n</ph><bpt id=\"p3\">*</bpt>// false, if the specified number sequence is per-company<ept id=\"p3\">*</ept><ph id=\"ph3\"> \n</ph><bpt id=\"p4\">*</bpt>// The default system-defined number sequence will be used if a number sequence code with the specified scope is not found.<ept id=\"p4\">*</ept>","pos":[5550,5897],"source":" \nconst str NumberSequenceExistingCode = ''; \n*// Specify the scope of the existing number sequence code* \n*// true, if the specified number sequence is shared* \n*// false, if the specified number sequence is per-company* \n*// The default system-defined number sequence will be used if a number sequence code with the specified scope is not found.*"},{"content":"const boolean NumberSequenceExistingIsShared = true;","pos":[5898,5951],"source":" \nconst boolean NumberSequenceExistingIsShared = true;"},{"content":"Rebuild the project that contains the class after the constants have been modified.","pos":[5954,6037]},{"content":"When using the system-generated number sequence approach (option 1), the upgrade will use set-based processing to allocate the voucher numbers as specified in the upgrade script parameters.","pos":[6040,6229]},{"content":"It will also create a new number sequence with specified parameters after the allocation.","pos":[6230,6319]},{"content":"When using the user-defined existing number sequence approach (option 2), the data upgrade checks whether the number sequence with the specified scope exists in the database for each partition and company with depreciation book transactions.","pos":[6322,6563]},{"content":"If it does exist, the upgrade will use row-by-row processing to allocate the voucher numbers as specified by the number sequence using the number sequence framework.","pos":[6564,6729]},{"content":"If the number sequence does not exist with the specified scope, the upgrade will use the default system-defined number sequence approach to allocate the voucher numbers, and will create a new number sequence with specified default parameters after the allocation.","pos":[6730,6993]},{"pos":[6995,7203],"content":"With either approach, the data upgrade script will also use the number sequence for the <bpt id=\"p1\">**</bpt>Voucher series<ept id=\"p1\">**</ept> field on the new general ledger journal names created for the former depreciation book journal names.","source":"With either approach, the data upgrade script will also use the number sequence for the **Voucher series** field on the new general ledger journal names created for the former depreciation book journal names."}]}