{"content":"---\n# required metadata\n\ntitle: Run the Document Routing Agent as a Windows service\ndescription: The Document Routing Agent can be run as either a desktop application or a Microsoft Windows service. This topic provides important information that will help you select the correct execution mode.\nauthor: sericks007\nmanager: AnnBe\nms.date: 06/20/2017\nms.topic: article\nms.prod: \nms.service: dynamics-ax-platform\nms.technology: \n\n# optional metadata\n\n# ms.search.form: \n# ROBOTS: \naudience: IT Pro\n# ms.devlang: \nms.reviewer: sericks\nms.search.scope: Operations, Platform, UnifiedOperations\n# ms.tgt_pltfrm: \nms.custom: 191133\nms.assetid: 7adc7228-4360-4a54-8a3e-4d916e727dd2\nms.search.region: Global\n# ms.search.industry: \nms.author: tjvass\nms.search.validFrom: 2016-08-30\nms.dyn365.ops.version: Platform update 2\n\n---\n\n# Run the Document Routing Agent as a Windows service\n\n[!include[banner](../includes/banner.md)]\n\n\nThe Document Routing Agent can be run as either a desktop application or a Microsoft Windows service. This topic provides important information that will help you select the correct execution mode.\n\nEarlier versions of the Document Routing Agent required an active Microsoft Windows sign-in to keep the desktop application running. In Microsoft Dynamics AX platform update 2 (August 2016), the Document Routing Agent includes an option that lets you select the mode of execution. The process can run as either a desktop application or a Windows service. When the application runs as a Windows service, it can be started automatically after a computer restart. It can also be configured to run under the security context of a specific user account. This enhancement lets customers host the Document Routing Agent on secured domain resources such as network print servers.\n\n## Service applications\nAn application is a program that a user interacts with on the desktop. A service is a process that runs in the background and doesn't have an active window. The Document Routing Agent now supports both execution modes. It's important that you understand why you might select one mode instead of the other and the steps that are involved in running the process as a service. For more information about Windows services, see [Introduction to Windows Service Applications](https://msdn.microsoft.com/en-us/library/d56de412(v=vs.110).aspx) on MSDN. Here are some of the main benefits of running the Document Routing Agent as a background service:\n\n-   The service can be configured to start automatically after a computer restart. No user intervention is required.\n-   The service runs in the background. No active application runs in the notification area.\n-   The service routes documents without requiring that a user sign in by using cached credentials.\n\nAlthough there are many benefits of running the Document Routing Agent as a Windows service, there are also limitations. The next section discusses an issue that affects the handling of document reports, such as checks, that require custom page margins.\n\n## Managing documents that require custom margins\nWhen the Document Routing Agent runs as a Windows service, document reports, such as checks, that require custom margins can't be printed directly to network printers. Instead, the Document Routing Agent automatically routes those document to a target folder. New configuration properties in the application's **Settings** dialog box let you define the target location for document reports that require custom margins. When the Document Routing Agent runs as a desktop application, it continues to take advantage of Adobe Reader to spool the document to the shared printer device that is selected in Finance and Operations. To handle scenarios where documents that have custom margins must be printed, we recommend that you install the Document Routing Agent in multiple locations. Then install the printers that will handle those documents only on the Document Routing Agents that will run in desktop application mode. Alternatively, use a post-execution process to pick up the files in the target directory and direct them as appropriate.\n\n## Installing the latest build\nThe enhancements to the Document Routing Agent are available as part of the Dynamics AX platform update 2 (August 2016) release. Just download the application to the host machine to replace the previous version of the client. Follow these steps to maintain the existing Document Routing Agent configuration settings.\n\n1.  Save a copy of the current Document Routing Agent configuration file. This file is located at C:\\\\Users\\\\&lt;UserID&gt;\\\\AppData\\\\Local\\\\Microsoft\\\\Microsoft Dynamics 365 for Finance and Operations Document Routing\\\\Microsoft.Dynamics.AX.Framework.DocumentRouting.config, where &lt;UserID&gt; is the Active Directory Domain Services (AD DS) user name that the Document Routing Agent was installed under.\n2.  Uninstall the current version of the Document Routing Agent.\n3.  After Dynamics AX has been upgraded to Dynamics AX platform update 2 (August 2016), install the new version of the Document Routing Agent by following the instructions in [Install the Document Routing Agent to enable network printer devices](install-document-routing-agent.md). **Note:** Although you install the application at this point, don't run it yet.\n4.  Copy the configuration file from step 1, and paste it into the following directory: C:\\\\ProgramData\\\\Microsoft\\\\Microsoft Dynamics 365 for Finance and Operations Document Routing. This step helps guarantee that all your previous configuration settings are used for the new version of the Document Routing Agent application.\n5.  Run the Document Routing Agent.\n6.  Sign in by using your Microsoft Azure Active Directory (Azure AD)/Dynamics AX credentials.\n7.  View and verify your settings and printers by clicking the appropriate menu items.\n\nThe next section provides detailed instructions for selecting the Windows service execution mode.\n\n## Changing the default execution mode\nBy default, the Document Routing Agent runs as a desktop application. To run the process as a Windows service, make sure that you are familiar with the process for [installing the Document Routing Agent to enable network printer devices](install-document-routing-agent.md), and then complete the following tasks.\n\n### Task 1: Update the execution mode for the Document Routing Agent\n\n1.  Start the Document Routing Agent by using the desktop icon.\n2.  Select the **Sign In** option, and sign in by using your Azure AD credentials.\n3.  On the ribbon, click **Settings**.\n4.  Enable the **Run as a Windows Service** option.\n5.  Provide a target folder for PDF files that are produced for documents that have custom margins.\n6.  Click **OK**, and close the Document Routing Agent window.\n\n### Task 2: Configure and start the Windows service\n\n1.  Open Service Manager in Windows.\n2.  Select the **Microsoft Dynamics 365 for Finance and Operations Document Routing Service** item in the list.\n3.  Right-click the name, and then click **Properties**.\n4.  On the **Log On** tab, select the **This account** option, and then supply the AD DS credentials that are used to run the service. **Note:** Make sure that the selected account has access to the shared network devices.\n5.  Click **OK**.\n6.  Start the service.\n\nThe Document Routing Agent is now running as a Windows service.\n\n\n\n","nodes":[{"pos":[4,812],"embed":true,"restype":"x-metadata","content":"# required metadata\n\ntitle: Run the Document Routing Agent as a Windows service\ndescription: The Document Routing Agent can be run as either a desktop application or a Microsoft Windows service. This topic provides important information that will help you select the correct execution mode.\nauthor: sericks007\nmanager: AnnBe\nms.date: 06/20/2017\nms.topic: article\nms.prod: \nms.service: dynamics-ax-platform\nms.technology: \n\n# optional metadata\n\n# ms.search.form: \n# ROBOTS: \naudience: IT Pro\n# ms.devlang: \nms.reviewer: sericks\nms.search.scope: Operations, Platform, UnifiedOperations\n# ms.tgt_pltfrm: \nms.custom: 191133\nms.assetid: 7adc7228-4360-4a54-8a3e-4d916e727dd2\nms.search.region: Global\n# ms.search.industry: \nms.author: tjvass\nms.search.validFrom: 2016-08-30\nms.dyn365.ops.version: Platform update 2\n","nodes":[{"content":"Run the Document Routing Agent as a Windows service","nodes":[{"pos":[0,51],"content":"Run the Document Routing Agent as a Windows service","nodes":[{"content":"Run the Document Routing Agent as a Windows service","pos":[0,51]}]}],"path":["title"],"extradata":"MT"},{"content":"The Document Routing Agent can be run as either a desktop application or a Microsoft Windows service. This topic provides important information that will help you select the correct execution mode.","nodes":[{"pos":[0,197],"content":"The Document Routing Agent can be run as either a desktop application or a Microsoft Windows service. This topic provides important information that will help you select the correct execution mode.","nodes":[{"content":"The Document Routing Agent can be run as either a desktop application or a Microsoft Windows service. This topic provides important information that will help you select the correct execution mode.","pos":[0,197],"nodes":[{"content":"The Document Routing Agent can be run as either a desktop application or a Microsoft Windows service.","pos":[0,101]},{"content":"This topic provides important information that will help you select the correct execution mode.","pos":[102,197]}]}]}],"path":["description"],"extradata":"MT"}],"header":"# required metadata\n","yml":true},{"pos":[820,871],"content":"Run the Document Routing Agent as a Windows service","linkify":"Run the Document Routing Agent as a Windows service","nodes":[{"content":"Run the Document Routing Agent as a Windows service","pos":[0,51]}]},{"content":"The Document Routing Agent can be run as either a desktop application or a Microsoft Windows service.","pos":[917,1018]},{"content":"This topic provides important information that will help you select the correct execution mode.","pos":[1019,1114]},{"content":"Earlier versions of the Document Routing Agent required an active Microsoft Windows sign-in to keep the desktop application running.","pos":[1116,1248]},{"content":"In Microsoft Dynamics AX platform update 2 (August 2016), the Document Routing Agent includes an option that lets you select the mode of execution.","pos":[1249,1396]},{"content":"The process can run as either a desktop application or a Windows service.","pos":[1397,1470]},{"content":"When the application runs as a Windows service, it can be started automatically after a computer restart.","pos":[1471,1576]},{"content":"It can also be configured to run under the security context of a specific user account.","pos":[1577,1664]},{"content":"This enhancement lets customers host the Document Routing Agent on secured domain resources such as network print servers.","pos":[1665,1787]},{"pos":[1792,1812],"content":"Service applications","linkify":"Service applications","nodes":[{"content":"Service applications","pos":[0,20]}]},{"content":"An application is a program that a user interacts with on the desktop.","pos":[1813,1883]},{"content":"A service is a process that runs in the background and doesn't have an active window.","pos":[1884,1969]},{"content":"The Document Routing Agent now supports both execution modes.","pos":[1970,2031]},{"content":"It's important that you understand why you might select one mode instead of the other and the steps that are involved in running the process as a service.","pos":[2032,2186]},{"content":"For more information about Windows services, see <bpt id=\"p1\">[</bpt>Introduction to Windows Service Applications<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/d56de412(v=vs.110).aspx)</ept> on MSDN.","pos":[2187,2357],"source":" For more information about Windows services, see [Introduction to Windows Service Applications](https://msdn.microsoft.com/en-us/library/d56de412(v=vs.110).aspx) on MSDN."},{"content":"Here are some of the main benefits of running the Document Routing Agent as a background service:","pos":[2358,2455]},{"content":"The service can be configured to start automatically after a computer restart.","pos":[2461,2539]},{"content":"No user intervention is required.","pos":[2540,2573]},{"content":"The service runs in the background.","pos":[2578,2613]},{"content":"No active application runs in the notification area.","pos":[2614,2666]},{"content":"The service routes documents without requiring that a user sign in by using cached credentials.","pos":[2671,2766]},{"content":"Although there are many benefits of running the Document Routing Agent as a Windows service, there are also limitations.","pos":[2768,2888]},{"content":"The next section discusses an issue that affects the handling of document reports, such as checks, that require custom page margins.","pos":[2889,3021]},{"pos":[3026,3072],"content":"Managing documents that require custom margins","linkify":"Managing documents that require custom margins","nodes":[{"content":"Managing documents that require custom margins","pos":[0,46]}]},{"content":"When the Document Routing Agent runs as a Windows service, document reports, such as checks, that require custom margins can't be printed directly to network printers.","pos":[3073,3240]},{"content":"Instead, the Document Routing Agent automatically routes those document to a target folder.","pos":[3241,3332]},{"content":"New configuration properties in the application's <bpt id=\"p1\">**</bpt>Settings<ept id=\"p1\">**</ept> dialog box let you define the target location for document reports that require custom margins.","pos":[3333,3491],"source":" New configuration properties in the application's **Settings** dialog box let you define the target location for document reports that require custom margins."},{"content":"When the Document Routing Agent runs as a desktop application, it continues to take advantage of Adobe Reader to spool the document to the shared printer device that is selected in Finance and Operations.","pos":[3492,3696]},{"content":"To handle scenarios where documents that have custom margins must be printed, we recommend that you install the Document Routing Agent in multiple locations.","pos":[3697,3854]},{"content":"Then install the printers that will handle those documents only on the Document Routing Agents that will run in desktop application mode.","pos":[3855,3992]},{"content":"Alternatively, use a post-execution process to pick up the files in the target directory and direct them as appropriate.","pos":[3993,4113]},{"pos":[4118,4145],"content":"Installing the latest build","linkify":"Installing the latest build","nodes":[{"content":"Installing the latest build","pos":[0,27]}]},{"content":"The enhancements to the Document Routing Agent are available as part of the Dynamics AX platform update 2 (August 2016) release.","pos":[4146,4274]},{"content":"Just download the application to the host machine to replace the previous version of the client.","pos":[4275,4371]},{"content":"Follow these steps to maintain the existing Document Routing Agent configuration settings.","pos":[4372,4462]},{"content":"Save a copy of the current Document Routing Agent configuration file.","pos":[4468,4537]},{"content":"This file is located at C:<ph id=\"ph1\">\\\\</ph>Users<ph id=\"ph2\">\\\\</ph><ph id=\"ph3\">&amp;lt;</ph>UserID<ph id=\"ph4\">&amp;gt;</ph><ph id=\"ph5\">\\\\</ph>AppData<ph id=\"ph6\">\\\\</ph>Local<ph id=\"ph7\">\\\\</ph>Microsoft<ph id=\"ph8\">\\\\</ph>Microsoft Dynamics 365 for Finance and Operations Document Routing<ph id=\"ph9\">\\\\</ph>Microsoft.Dynamics.AX.Framework.DocumentRouting.config, where <ph id=\"ph10\">&amp;lt;</ph>UserID<ph id=\"ph11\">&amp;gt;</ph> is the Active Directory Domain Services (AD DS) user name that the Document Routing Agent was installed under.","pos":[4538,4871],"source":" This file is located at C:\\\\Users\\\\&lt;UserID&gt;\\\\AppData\\\\Local\\\\Microsoft\\\\Microsoft Dynamics 365 for Finance and Operations Document Routing\\\\Microsoft.Dynamics.AX.Framework.DocumentRouting.config, where &lt;UserID&gt; is the Active Directory Domain Services (AD DS) user name that the Document Routing Agent was installed under."},{"content":"Uninstall the current version of the Document Routing Agent.","pos":[4876,4936]},{"content":"After Dynamics AX has been upgraded to Dynamics AX platform update 2 (August 2016), install the new version of the Document Routing Agent by following the instructions in <bpt id=\"p1\">[</bpt>Install the Document Routing Agent to enable network printer devices<ept id=\"p1\">](install-document-routing-agent.md)</ept>.","pos":[4941,5218],"source":"After Dynamics AX has been upgraded to Dynamics AX platform update 2 (August 2016), install the new version of the Document Routing Agent by following the instructions in [Install the Document Routing Agent to enable network printer devices](install-document-routing-agent.md)."},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept> Although you install the application at this point, don't run it yet.","pos":[5219,5298],"source":"**Note:** Although you install the application at this point, don't run it yet."},{"content":"Copy the configuration file from step 1, and paste it into the following directory: C:<ph id=\"ph1\">\\\\</ph>ProgramData<ph id=\"ph2\">\\\\</ph>Microsoft<ph id=\"ph3\">\\\\</ph>Microsoft Dynamics 365 for Finance and Operations Document Routing.","pos":[5303,5482],"source":"Copy the configuration file from step 1, and paste it into the following directory: C:\\\\ProgramData\\\\Microsoft\\\\Microsoft Dynamics 365 for Finance and Operations Document Routing."},{"content":"This step helps guarantee that all your previous configuration settings are used for the new version of the Document Routing Agent application.","pos":[5483,5626]},{"content":"Run the Document Routing Agent.","pos":[5631,5662]},{"content":"Sign in by using your Microsoft Azure Active Directory (Azure AD)/Dynamics AX credentials.","pos":[5667,5757]},{"content":"View and verify your settings and printers by clicking the appropriate menu items.","pos":[5762,5844]},{"content":"The next section provides detailed instructions for selecting the Windows service execution mode.","pos":[5846,5943]},{"pos":[5948,5983],"content":"Changing the default execution mode","linkify":"Changing the default execution mode","nodes":[{"content":"Changing the default execution mode","pos":[0,35]}]},{"content":"By default, the Document Routing Agent runs as a desktop application.","pos":[5984,6053]},{"content":"To run the process as a Windows service, make sure that you are familiar with the process for <bpt id=\"p1\">[</bpt>installing the Document Routing Agent to enable network printer devices<ept id=\"p1\">](install-document-routing-agent.md)</ept>, and then complete the following tasks.","pos":[6054,6296],"source":" To run the process as a Windows service, make sure that you are familiar with the process for [installing the Document Routing Agent to enable network printer devices](install-document-routing-agent.md), and then complete the following tasks."},{"pos":[6302,6366],"content":"Task 1: Update the execution mode for the Document Routing Agent","linkify":"Task 1: Update the execution mode for the Document Routing Agent","nodes":[{"content":"Task 1: Update the execution mode for the Document Routing Agent","pos":[0,64]}]},{"content":"Start the Document Routing Agent by using the desktop icon.","pos":[6372,6431]},{"pos":[6436,6514],"content":"Select the <bpt id=\"p1\">**</bpt>Sign In<ept id=\"p1\">**</ept> option, and sign in by using your Azure AD credentials.","source":"Select the **Sign In** option, and sign in by using your Azure AD credentials."},{"pos":[6519,6553],"content":"On the ribbon, click <bpt id=\"p1\">**</bpt>Settings<ept id=\"p1\">**</ept>.","source":"On the ribbon, click **Settings**."},{"pos":[6558,6605],"content":"Enable the <bpt id=\"p1\">**</bpt>Run as a Windows Service<ept id=\"p1\">**</ept> option.","source":"Enable the **Run as a Windows Service** option."},{"content":"Provide a target folder for PDF files that are produced for documents that have custom margins.","pos":[6610,6705]},{"pos":[6710,6768],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>, and close the Document Routing Agent window.","source":"Click **OK**, and close the Document Routing Agent window."},{"pos":[6774,6821],"content":"Task 2: Configure and start the Windows service","linkify":"Task 2: Configure and start the Windows service","nodes":[{"content":"Task 2: Configure and start the Windows service","pos":[0,47]}]},{"content":"Open Service Manager in Windows.","pos":[6827,6859]},{"pos":[6864,6971],"content":"Select the <bpt id=\"p1\">**</bpt>Microsoft Dynamics 365 for Finance and Operations Document Routing Service<ept id=\"p1\">**</ept> item in the list.","source":"Select the **Microsoft Dynamics 365 for Finance and Operations Document Routing Service** item in the list."},{"pos":[6976,7028],"content":"Right-click the name, and then click <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept>.","source":"Right-click the name, and then click **Properties**."},{"content":"On the <bpt id=\"p1\">**</bpt>Log On<ept id=\"p1\">**</ept> tab, select the <bpt id=\"p2\">**</bpt>This account<ept id=\"p2\">**</ept> option, and then supply the AD DS credentials that are used to run the service.","pos":[7033,7163],"source":"On the **Log On** tab, select the **This account** option, and then supply the AD DS credentials that are used to run the service."},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept> Make sure that the selected account has access to the shared network devices.","pos":[7164,7251],"source":"**Note:** Make sure that the selected account has access to the shared network devices."},{"pos":[7256,7269],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","source":"Click **OK**."},{"content":"Start the service.","pos":[7274,7292]},{"content":"The Document Routing Agent is now running as a Windows service.","pos":[7294,7357]}]}