{"content":"---\n# required metadata\n\ntitle: Customize model elements using extensions\ndescription: In this tutorial, you’ll become familiar with the Fleet Management Extension model. To demonstrate the extension capabilities of Dynamics AX, this model contains elements that extend the functionality of the Fleet Management application.\nauthor: robadawy\nmanager: AnnBe\nms.date: 06/20/2017\nms.topic: article\nms.prod: \nms.service: dynamics-ax-platform\nms.technology: \n\n# optional metadata\n\n# ms.search.form: \n# ROBOTS: \naudience: Developer\n# ms.devlang: \nms.reviewer: robinr\nms.search.scope: AX 7.0.0, Operations, UnifiedOperations\n# ms.tgt_pltfrm: \nms.custom: 11184\nms.assetid: 3190f6e2-698a-4cfa-9a2d-a6c57354920a\nms.search.region: Global\n# ms.search.industry: \nms.author: robadawy\nms.search.validFrom: 2016-02-28\nms.dyn365.ops.version: AX 7.0.0\n\n---\n\n# Customize model elements using extensions\n\n[!include[banner](../includes/banner.md)]\n\n\nIn this tutorial, you’ll become familiar with the Fleet Management Extension model. This model contains elements that extend the functionality of the Fleet Management application. You can customize model elements by creating *extensions*. Unlike the overlayering capabilities of Microsoft Dynamics AX 2012, extensions don’t overlay the baseline model elements. Instead, extensions are compiled as a separate assembly that adds to or customizes the model and the associated business logic. You can extend metadata, for example, by adding a field to a table or adding a control to a form, and also extend or customize business logic by defining event handlers and plug-in classes. You can now author event handlers on several pre-defined events on tables, forms, form data sources, form controls, and others. Plug-ins are also a new extensibility concept that enables replacing or extending the business logic of the application.\n\n## Prerequisites\nThis tutorial requires you to access the environment using Remote Desktop, and that you be provisioned as an administrator on the instance.\n\n## Understanding the Fleet Management model\nThe Fleet Management application provides a rental car company a system for managing vehicles, customers and vehicle reservations. The application is designed for use by the Fleet Clerk and Fleet Manager personas.\n\n### Fleet Clerk\n\nThe Clerk is the front desk employee who handles the face-to-face and over-the-phone interactions with customers. The Clerk is primarily concerned with entering customer information into the application, creating vehicle reservations for customers, upselling the reservation by offering vehicle accessories, and processing vehicle returns upon completion of a vehicle rental. The Clerk spends the vast majority of their time using the **Fleet Management Workspace** to prepare for interactions with customers by anticipating their needs and providing a pleasant and memorable experience, while interacting with the customer.\n\n### Fleet Manager\n\nThe Manager is the back office employee who handles setting business requirements and processes. The Manager is primarily concerned with entering vehicle information, defining the available vehicle accessories, vehicle maintenance, determining pricing, and analyzing business performance measures such as revenue, upsell success, and so on. The application's business logic revolves around the following three primary entities and the relationships between them.\n\n### Customers\n\nCustomers contact the Fleet Clerk to make vehicle reservations, choose vehicle accessories, check out and return vehicles, and pay for vehicle rentals. Customer-related information is stored in the table named **FMCustomer**.\n\n### Vehicles\n\nVehicles vary primarily in their price, which is proportional to the vehicle *class*. The names of tables that store information about vehicles begin with \"FMVehicle\".**\n\n### Reservations and rentals\n\nReservations handle the relationship between customers and vehicles. Reservation information includes reservation dates, customer information, vehicle selection and price, and additional charges such as accessories or fees. Reservation and rental information is stored in the **FMRental** and **FMRentalCharge** tables. A calculation engine handles the transactional information related to the pricing of vehicle reservations. Using this data model the Fleet Management application provides a basic car rental experience.\n\n## Extending the Fleet Management model\nThe basic Fleet Management application has been customized with additional capabilities that enable a rental car company to provide pricing incentives to its customers through discounts. The additional business logic and data that enables these discount capabilities is stored in the Fleet Management Extension model. The discount capabilities add value to the Fleet management application through three primary customizations.\n\n### The Fleet Management Extension data model\n\nTwo new tables have been added that store discount-related information. **FEDiscounts** stores the list of all discounts and their rates. **FERentalDiscountRelationTable** keeps track of the reservations that the discounts are applied to. Existing tables have been extended to account for the addition of discounts to the pricing scheme. The table that keeps track of the vehicle rate for a particular reservation, named **FMRental**, has been extended to accommodate discounts to the vehicle rate. The table that keeps track of the accessories for a reservation, named **FMRentalCharge**, has been extended to accommodate discounts applied to accessories.\n\n### The Fleet Management Extension Calculation Engine\n\nThe basic calculation engine has been customized to add the various pricing schemes defined by the new discounts. A plug-in class has replaced the functionality of the base calculation engine. When a vehicle is reserved for more than 7 days, the vehicle Fleet Management model calculates savings based on the difference between a vehicle's daily rate and a lower weekly rate. The plug-in removes the weekly-rate calculation because this same behavior can be accomplished by using discounts.\n\n### The Fleet Management User Interface Extensions\n\nThe Rental, which is contained by the form named **FMRental**, has been extended to enable the Clerk to apply discounts to a reservation. The on-screen price summary is updated in real time with savings information related to discounts that can be applied to vehicles and accessories related to the reservation. In the following steps, you'll explore the customizations that have been made in the Fleet management Extension model, as well as re-implement a portion of the customizations for yourself.\n\n## Setup\nIf you haven't opened the Fleet Management Solution in a previous tutorial, follow these steps. The fleet management solution file is available on the Dynamics AX downloadable VM.\n\n1.  On the **Desktop**, double-click the **Visual Studio** shortcut to open the development environment.\n2.  Open the **FleetManagement** solution. On the **File** menu, point to **Open**, and then click **Project/Solution**.\n3.  Browse to the desktop and open the **FleetManagement** folder. If the solution file is not on your computer, the steps to create it are listed in [Tutorial: Create a Fleet Management solution file out of the Fleet Management models in the AOT](https://community.dynamics.com/ax/b/newdynamicsax/archive/2016/05/19/tutorial-create-a-fleet-management-solution-file-out-of-the-fleet-management-models-in-the-aot).\n4.  Select the solution file named **FleetManagement**. The file type listed is Microsoft Visual Studio Solution.\n5.  Click **Open**. The solution may take some time to open.\n\n \n\n### Installing the demo data\n\nIf you've already installed the demo data, you can skip to the next section.\n\n1.  In the VM, open Internet Explorer and navigate to the application's base URL.\n2.  Sign in.\n3.  On the dashboard, open the navigation pane and navigate to **Fleet Management &gt; Setup &gt; Fleet Setup**. [![Fleet setup > Customize model](./media/fleetsetup_customizemodel.png)](./media/fleetsetup_customizemodel.png)\n4.  Click **Setup Demo Data**. \n    \n    [![Configuration > Customize Model](./media/configuration_customizemodel.png)](./media/configuration_customizemodel.png)\n    \n5.  If you're prompted to reload the demo data, click **Yes**.\n6.  When the data is finished loading, click **Close**.\n7.  On the dashboard, open the navigation bar and navigate to **System Administration &gt; Common &gt; Maintain aggregate measurements**. (Steps 7 to 9 are not applicable on newer releases)\n8.  Select **FMAggregateMeasurements**, and on the Action Pane, click **Refresh now**.\n9.  Wait until the processing completes. The ongoing processing is indicated at the top of the page by a series of moving dots. The processing is completed when the indicator disappears and the **Time Last Processed** field is updated.\n\n## Open the FMRental form on the onebox environment\n1.  In the VM, open Internet Explorer and navigate to the base URL of your Dynamics AX application. For more information, see [Access Microsoft Dynamics AX Instances](..\\dev-tools\\access-instances.md).\n2.  Sign in, if prompted.\n3.  Find the **Reservation Management** tile and click to open the Reservation Management workspace. \n\n    [![Reservation management tile](./media/reservationmanagementtile.jpg)](./media/reservationmanagementtile.jpg)\n    \n4.  When the **Reservation Management** workspace opens, click **Current rentals**. \n\n    [![Current rentals](./media/reservationmanagementworkspace.jpg)](./media/reservationmanagementworkspace.jpg)\n    \n5.  This will open the **Rental** form in grid view. \n\n    [![Rental form](./media/rentalform_customizemodel.png)](./media/rentalform_customizemodel.png)\n    \n6.  After the **Rental** form loads, click **Options &gt; Change view &gt; Header** to open the **Header view**.\n\n    [![Header view](./media/headerview_customizemodel.png)](./media/headerview_customizemodel.png)\n    \n7.  When the **Header view** form loads, scroll to the bottom and expand the **Discounts** tab. This tab isn't part of the Fleet Management model. It has been modeled in the Fleet Management Extension Model as an extension to the **FMRental** form.\n\n    [![Discounts](./media/discounts_customizemodel.png)](./media/discounts_customizemodel.png)\n    \n8.  Click **Add** to add a discount.\n9.  Select the **Frequent Customer** discount, and then click **OK**. The selected discount is added to the **Discounts** grid. \n\n    [![Frequent customer discount](./media/fcdiscount_customizemodel.png)](./media/fcdiscount_customizemodel.png)\n    \n10. Use the shortcut key, **Alt+F2** to open the FactBox.\n11. Expand the **Rental total** FactBox on the right and view the discount savings that are applied. \n\n    [![Rental total](./media/rentaltotal_customizemodel.png)](./media/rentaltotal_customizemodel.png)\n\n## Overview of the Fleet management discount extension project\nIn this tutorial, the **FleetManagementDiscounts** Project contains the model elements that belong to the model named **Fleet Management Extension**. Here, you'll explore and learn about the project elements.\n\n### Navigate to FMRental.Extension in the Tree Designer\n\n1.  In the Visual Studio, in **Solution Explorer**, in the **FleetManagement Discounts** project, expand **User Interface &gt; Form Extensions**. \n    \n    [![Solution explorer](./media/solutionexplorer1_customizemodel.png)](./media/solutionexplorer1_customizemodel.png)\n    \n    The **FMRental.Extension** element is an extension element that extends the functionality of the **FMRental** form by adding two new data sources and a new tab control.\n2.  In **Solution Explorer**, double-click **FMRental.Extension** to open the designer. As the following image shows:\n    -   The data sources shown in *italic* text are data sources defined in the baseline form.\n    -   The data sources shown in **bold** are the ones defined in the current extension.\n\n    The designer presents an integrated view of the model element, including its extensions. Read-only nodes are shown in italic text, while nodes that belong to the current extension are shown in bold, with other visual cues that indicate the type of customization. \n    \n    [![FMRentalExt\\_CustomizeModel](./media/fmrentalext_customizemodel.png)](./media/fmrentalext_customizemodel.png)\n        \n3.  In the designer's search box, type 'e:' as shown in the image below. This filters the current designer to only show nodes that belong to the current extension. \n\n    [![Current extension](./media/rentalext-e_customizemodel.png)](./media/rentalext-e_customizemodel.png)\n    \n4.  You can also type 'e:LineViewDiscounts' to filter the designer to show nodes that match the name **LineViewDiscounts** and that belong to the current extension. \n\n    [![LineViewDiscounts](./media/lineviewdiscounts_customizemodel.png)](./media/lineviewdiscounts_customizemodel.png)\n    \n5.  Expand the **LineViewDiscounts** node to see its contents. \n\n    [![Expand LineViewDiscounts node](./media/expandlvdnode_customizemodel.png)](./media/expandlvdnode_customizemodel.png)\n\n### Open the FMRental.Extension XML file to view the metadata\n\n1.  In the **Solution Explorer**, right-click FMRental.Extension form extension, and then click **Open with**.\n2.  In the **Open with** dialog box, select **XML (Text) Editor**, and then click **OK**.\n3.  When prompted to close the designer, click **Yes**.\n4.  Click the corresponding minus signs to collapse the child nodes of the **Controls** and **DataSources** nodes. Refer to the following image for the correct result. \n\n    [![Rental code](./media/fmrentalcode_customizemodel.png)](./media/fmrentalcode_customizemodel.png) \n    \n    The XML file contains the metadata associated with the **FMRental.Extension** element. You can see that this file contains metadata that describes only one tab page control and two data sources that are part of the extension. You can also see that it doesn't contain any metadata from the base form.\n\n### View other elements in the Fleet Management discount extension project\n\nThe **FleetManagement Discounts** project contains two new tables, **FEDiscount** and **FERentalDiscountRelationTable**, and two extensions to existing Fleet Management tables, **FMRental** and **FMRentalCharge**.\n\n1.  In **Solution Explorer**, in FleetManagement Discounts, double-click **Data Model &gt; Table Extensions &gt; FMRental.Extension** to open the designer.\n2.  Expand the **Fields** node to see that this extension contains one added field, FEVehicleRateDiscount, to the base FMRental table. \n\n    [![FEVehicleRateDiscount](./media/nodes_customizemodel.png)](./media/nodes_customizemodel.png)\n    \n3.  Similarly, open the **FMRentalChange.Extension** element in the designer to explore its contents.\n\n### Inspect the data event handlers\n\nIn **Solution Explorer**, in the FleetManagement Discounts project, double-click **Code &gt; Classes &gt; FMRentalCharge\\_Extension** to open the code editor. \n\n[![FMRentalChargeCode](./media/fmrentalchargecode_customizemodel.png)](./media/fmrentalchargecode_customizemodel.png) \n    \nThis class contains event handler implementations that subscribe to the **Updating** and **Inserting** events of the **FMRentalCharge** table. Microsoft Dynamics AX introduces data events that can occur on tables and other types. You can subscribe to data events of a table, enabling your application to extend business logic without overlayering base X++ code. Later in this tutorial, you'll see how easy it is to subscribe to table events. **Note:** Notice that this class is an extension class (indicated by the \\_Extension suffix). You can author event handlers in any class, this class does not need to be an extension class. Extension classes are needed in order to create extension methods. For more details on extension methods, refer to the \"Extension methods\" section of [X++ debugger features](..\\dev-tools\\new-x-debugger-features.md)article.\n\n### View the plug-in classes\n\nIn the event handler code of the **FMRentalCharge\\_Extension** class shown in the previous section, notice that both event handlers call **FMTotalsEngineBase::GetInstance** to retrieve the current instance of the Fleet Management calculation engine. The calculation engines are implemented by using plug-in classes. A class factory creates the appropriate instances of a plug-in class based on configuration or business data.\n\n1.  In the code editor window that displays FMRentalCharge\\_Extension.xpp, right-click **GetInstance**, and then click **Go To Definition**. This will open the code of the abstract class **FMTotalsEngineBase**. This abstract class is called a **plugin point** and it's associated with the following attribute: \\[Microsoft.Dynamics.AX.Platform.Extensibility.ExportInterfaceAttribute()\\] \n\n    [![Go to Definition](./media/godefinition_customizemodel.png)](./media/godefinition_customizemodel.png) \n    \n    Plug-in classes represent extensions or implementations of abstract classes or interfaces. Plug-in classes are associated with attributes defining their metadata and the plug-in point. In this example, there are two plug-in classes associated with the **FMTotalsEngineBase** plug-in point. The base calculation engine is defined by the plug-in class **FMTotalsEngine**. You can find it in the project **FleetManagement Migrated &gt; Code &gt; Classes**. \n    \n    [![FMTotalsEngineBase](./media/code1_customizemodel.png)](./media/code1_customizemodel.png) \n    \n    The discount calculation engine is defined by the plug-in class **FEDiscountEngine**. You can find it in the project **FleetManagement Discounts &gt; Code &gt; Classes**. \n    \n    [![FEDiscountEngine](./media/code2_customizemodel.png)](./media/code2_customizemodel.png)\n    \n2.  Look at the **GetInstance** method. It uses the plug-in factory **SysPluginFactory::Instance** to instantiate the current calculation engine based on current plug-in metadata. The plug-in metadata is specified in the global configuration table, **FMParameters**. \n    \n    [![FMParameters](./media/code3_customizemodel.png)](./media/code3_customizemodel.png) \n    \n    Dynamics AX also supports configurable plug-in classes where the plug-in metadata associate with the class isn't known at development time and is configurable at runtime by an administrator. This isn't in the scope of this tutorial.\n\n## Create additional Fleet Management extensions\nThis section shows how you can use the Visual Studio tools to create and interact with extensions.\n\n### Extend the FMVehicle Table\n\n1.  In **Solution Explorer**, select the **FleetManagement Discounts** project.\n2.  In Visual studio, in **Application Explorer,** click **View &gt; Application Explorer**, and search for the table named FMVehicle. Type \"FMVehicle type:Table\" in the filter bar and press **Enter**. \n\n    [![AppExplorer search for FMVehicle](./media/appexplorersmall_customizemodel.png)](./media/appexplorersmall_customizemodel.png)\n    \n3.  Right-click **FMVehicle**, and then click **Create extension**. \n\n    [![AppExplorer Create extension](./media/appexplorerlarge1_customizemodel.png)](./media/appexplorerlarge1_customizemodel.png)\n    \n    This will create an extension of the **FMVehicle** table in the **FleetManagement Discounts** project named **FMVehicle.Extension**. \n    \n    [![FMVehicle.Extension](./media/expanddiscountsnode2_customizemodel.png)](./media/expanddiscountsnode2_customizemodel.png)\n        \n4.  In **Solution Explorer**, right-click **FMVehicle.Extension**, and then click **Open with**. In the dialog box, select **XML (Text) Editor**, and then click **OK**. **Note**: This extension file is simply a template that doesn't contain metadata from the base **FMVehicle** table. An extension file will always contain only the metadata that defines the extension and nothing from the base model element. \n\n    [![FMVehicle](./media/code4_customizemodel.png)](./media/code4_customizemodel.png)\n    \n5.  Close the XML editor.\n6.  In **Solution Explorer**, double-click **FMVehicle.Extension** to open the designer.\n7.  Right-click **Fields** and add a new integer field. Change the name of the field to **NumberOfCyclinders**.\n8.  In the **Properties** window, set the **Label** property of the new field to **NumberofCylinders**.\n9.  Drag-and-drop the **NumberOfCylinders** field into the **AutoReport** field group to entend the field group of the base table. \n\n    [![NumberOfCylinders\\_CustomizeModel](./media/numberofcylinders_customizemodel.png)](./media/numberofcylinders_customizemodel.png)\n    \n10. Save FMVehicle.Extension.\n11. Expand the **Events** node. The **Events** node lists all events that the table exposes. This includes events that are defined by the framework, and delegate methods that are defined by application developers. \n\n    [![Events node](./media/eventsnode_customizemodel.png)](./media/eventsnode_customizemodel.png)\n    \n    **Note**: Different framework events are exposed on the designers of many types of element and sub-elements, like table events, form events, form data source events, and form control events.\n12. Right-click onValidatedWrite, and then select **Copy event handler method**. \n\n    [![onValidateWrite](./media/onvalidatewrite_customizemodel.png)](./media/onvalidatewrite_customizemodel.png) \n    \n    This step copies the event handler method signature to the clipboard.\n13. Add a new class named **FMVehicleEventHandlers** to the **FleetManagement Discounts** project.\n14. In **Solution Explorer**, double-click **FEVehicleEventHandlers** to open the code editor.\n15. Right-click and paste the event handler method that you copied in step 12.\n\n        Class FMVehicleEventHandlers\n        {\n            /// <summary>\n            ///\n            /// </summary>\n            /// <param name=\"sender\"></param>\n            /// <param name=\"e\"></param>\n            [DataEventHandler(tableStr(FMVehicle), DataEventType::ValidatedWrite)]\n            public static void FMVehicle_onValidatedWrite(Common sender, DataEventArgs e)\n            {\n            }\n        }\n\n     \n\n16. Insert the following code into the **FMVehicle\\_onValidatedWrite** event handler. This code validates that the number of cylinders can't be greater than 8.\n\n           [DataEventHandler(tableStr(FMVehicle), DataEventType::ValidatedWrite)]\n            public static void FMVehicle_onValidatedWrite(Common sender, DataEventArgs e)\n            {\n                ValidateEventArgs validateArgs = e as ValidateEventArgs;\n                FMVehicle vehicle = sender as FMVehicle;\n                boolean result = validateArgs.parmValidateResult();\n\n                if (vehicle.NumberOfCylinders > 8)\n                {\n                    result = checkFailed(\"Invalid number of cylinders.\");\n                    validateArgs.parmValidateResult(result);\n                }\n            }\n\n17. Save FMVehicleEventHandlers class **Tip**: You can paste and define your event handlers in any class of your model. The class FMVehicleEventHandlers is used only as an example.\n\n### Extend the FMVehicle Form\n\nNext, add an extension to the **FMVehicle** form in the **FleetManagement Discounts** project. First, be sure to select this project in **Solution Explorer**.\n\n1.  Use **Application Explorer** to find the form named **FMVehicle**, and in the **Application Explorer** filter bar, enter the *FMVehicle type:form*.\n2.  Right-click the form, and then click **Create extension**.\n3.  Add a new integer control named **NumberOfCylinders** to the **Attributes2** group control as shown below. You can find this control by expanding **Design &gt; Tab &gt; TabPageDetails &gt; TabHeader &gt; DetailsDetails &gt; Attributes2**. \n\n    [![Number of Cylinders](./media/numcylinteger_customizemodel.png)](./media/numcylinteger_customizemodel.png)\n    \n4.  Bind the new control to the **NumberOfCylinders** data field in the properties window as follows. \n    \n    [![Bind control](./media/datafield_customizemodel.png)](./media/datafield_customizemodel.png)\n    \n5.  Save FMVehicle.Extension and build the project.\n\n### Test your extensions\n\n1.  In **Solution Explorer**, right-click **FleetManagement Discounts**, and then click **Set as StartUp project**.\n2.  Similarly, in FleetManagement Discounts, set the **FMVehicle.Extension** form as the startup object.\n3.  Press **Ctrl+F5** to start without debugging, or use the **Debug** menu.\n4.  After the **Vehicles** form opens, select a vehicle to view its details.\n5.  Expand the **Details** tab and notice the new **Number of Cylinders** field. \n\n    [![Details with number of cylinders](./media/nbofcyls.jpg)](./media/nbofcyls.jpg)\n    \n6.  In the Action Pane, click **Edit**, and change the value in the **Number of cylinders** field to 12.\n7.  In the Action Pane, click **Save**.\n8.  Notice the validation error.\n9.  Enter a valid number of cylinders, less than 9, and then save the new value.\n\n## Experiment with event handlers on form controls\nThis is an example of adding event handler methods on existing controls.\n\n1.  Find the **AddLine** command button control in the **FMRental** form designer, right-click the **OnClicked** event, and select **Copy event handler method**.\n\n    [![Add line OnClicked event](./media/addlineonclickedevent.jpg)](./media/addlineonclickedevent.jpg)\n    \n2.  Paste the event handler method in a class of the Fleet Management Extension model and add X++ code to implement it.\n\n<!-- -->\n\n    /// <summary>\n    ///\n    /// </summary>\n    /// <param name=\"sender\"></param>\n    /// <param name=\"e\"></param>\n    [FormControlEventHandler(formControlStr(FMRental, AddLine), FormControlEventType::Clicked)]\n    public static void AddLine_OnClicked(FormControl sender, FormControlEventArgs e)\n    {\n    }\n\n-   When implementing the AddLine\\_OnClicked event handler, you can access the button control instance using the **sender** parameter.\n\n<!-- -->\n\n    FormButtonControl button = sender as FormButtonControl;\n\n-   If you need to access the parent form or any of its variables, this example shows how to access the **FormRun** instance and one of its data sources.\n\n<!-- -->\n\n    FormRun fr;\n    fr = sender.formRun();\n    var frDs = fr.dataSource(\"FMRental\");\n\n## Experiment with event handlers on form data sources\nJust like tables, form controls and other element types, form data sources and form data source fields provide framework-level events. The following example shows how you can use the ValidatingWrite event on a form data source or the Validating event on a form data source field to validate user input on the FMRental form. This functionality is available as of Platform Update 7.\n\n```\n    /// <summary>\n    /// When saving a new rental, prevent setting the start mileage on the FMRental form to a value that is equal to 1\n    /// </summary>\n    [FormDataSourceEventHandler(formDataSourceStr(FMRental, FMRental), FormDataSourceEventType::ValidatingWrite)]\n    public static void FMRental_OnValidatingWrite(FormDataSource sender, FormDataSourceEventArgs e)\n    {\n        var datasource = sender as FormDataSource;\n        var args = e as FormDataSourceCancelEventArgs;\n        if (args != null && datasource != null)\n        {\n            FMRental record = datasource.cursor() as FMRental;\n            if (record.recId == 0)\n            {\n                if(record.startmileage == 1)\n                {\n                    boolean doCancel = !checkFailed(\"Start Mileage = 1 is not allowed\");\n                    args.cancel(doCancel);\n                }\n            }\n        }\n    }\n```\n```\n    /// <summary>\n    /// Prevent changing the start mileage field on the FMRental form to a value that is equal to 1\n    /// </summary>\n    [FormDataFieldEventHandler(formDataFieldStr(FMRental, FMRental, StartMileage), FormDataFieldEventType::Validating)]\n    public static void StartMileage_OnValidating(FormDataObject sender, FormDataFieldEventArgs e)\n    {\n        var dataObject = sender as FormDataObject;\n        var args = e as FormDataFieldCancelEventArgs;\n        if (args != null && dataObject != null)\n        {\n            var datasource = dataObject.datasource() as FormDataSource;\n            if (datasource != null)\n            {\n                FMRental record = datasource.cursor() as FMRental;\n                if (record.RecId > 0)\n                {\n                    if (record.StartMileage == 1 )\n                    {\n                        boolean doCancel = !checkFailed(\"Start Mileage = 1 is not allowed\");\n                        args.cancel(doCancel);\n                    }\n                }\n            }\n        }\n    }\n```\n## Experiment with table extension display and edit methods\nExtension methods enable you to extend tables by creating new display and edit methods on these tables without over-layering X++ code (Extension method must belong to a class named with an \\_Extension suffix). For example, this class shows how you can extend the FMVehicle table with an extension display method named CupHoldersDisplay.\n\n    public static class FMVehicle_Extension\n    {\n       public static display int CupHoldersDisplay(FMVehicle vehicle)\n       {\n         return 7;\n       }\n    }\n\nOn a form or form extension, you can bind a control to this display method by setting \"Data Source = FMVehicle\" and \"Data method = \"FMVehicle\\_Extension::CupHoldersDisplay\" as the image below shows.\n\n![Extension display method](./media/extensiondisplaymethod.jpg)\n\n## Create a Fleet extension package for deployment\nTo deploy your extension to another environment, for example, a test, pre-production or production environment, you must create a deployment package.\n\n1.  In Visual Studio, on the **Dynamics AX** menu, point to **Deploy**, and then click **Create Deployment Package**. \n\n    ![Create deployment package](./media/createdeploymentpackage_customizemodel.png)\n    \n2.  Select the **Fleet Management Extension** check box.\n3.  In the **Package file location** text box, enter \"c:FMLab\".\n4.  Click **Create**. This will create a deployment package that contains the Fleet management Extension package.\n\n\nSee also\n--------\n\n[Download FMLab sample code](https://github.com/Microsoft/FMLab)\n\n\n\n","nodes":[{"pos":[4,834],"embed":true,"restype":"x-metadata","content":"# required metadata\n\ntitle: Customize model elements using extensions\ndescription: In this tutorial, you’ll become familiar with the Fleet Management Extension model. To demonstrate the extension capabilities of Dynamics AX, this model contains elements that extend the functionality of the Fleet Management application.\nauthor: robadawy\nmanager: AnnBe\nms.date: 06/20/2017\nms.topic: article\nms.prod: \nms.service: dynamics-ax-platform\nms.technology: \n\n# optional metadata\n\n# ms.search.form: \n# ROBOTS: \naudience: Developer\n# ms.devlang: \nms.reviewer: robinr\nms.search.scope: AX 7.0.0, Operations, UnifiedOperations\n# ms.tgt_pltfrm: \nms.custom: 11184\nms.assetid: 3190f6e2-698a-4cfa-9a2d-a6c57354920a\nms.search.region: Global\n# ms.search.industry: \nms.author: robadawy\nms.search.validFrom: 2016-02-28\nms.dyn365.ops.version: AX 7.0.0\n","nodes":[{"content":"Customize model elements using extensions","nodes":[{"pos":[0,41],"content":"Customize model elements using extensions","nodes":[{"content":"Customize model elements using extensions","pos":[0,41]}]}],"path":["title"],"extradata":"MT"},{"content":"In this tutorial, you’ll become familiar with the Fleet Management Extension model. To demonstrate the extension capabilities of Dynamics AX, this model contains elements that extend the functionality of the Fleet Management application.","nodes":[{"pos":[0,237],"content":"In this tutorial, you’ll become familiar with the Fleet Management Extension model. To demonstrate the extension capabilities of Dynamics AX, this model contains elements that extend the functionality of the Fleet Management application.","nodes":[{"content":"In this tutorial, you’ll become familiar with the Fleet Management Extension model. To demonstrate the extension capabilities of Dynamics AX, this model contains elements that extend the functionality of the Fleet Management application.","pos":[0,237],"nodes":[{"content":"In this tutorial, you’ll become familiar with the Fleet Management Extension model.","pos":[0,83]},{"content":"To demonstrate the extension capabilities of Dynamics AX, this model contains elements that extend the functionality of the Fleet Management application.","pos":[84,237]}]}]}],"path":["description"],"extradata":"MT"}],"header":"# required metadata\n","yml":true},{"pos":[842,883],"content":"Customize model elements using extensions","linkify":"Customize model elements using extensions","nodes":[{"content":"Customize model elements using extensions","pos":[0,41]}]},{"content":"In this tutorial, you’ll become familiar with the Fleet Management Extension model.","pos":[929,1012]},{"content":"This model contains elements that extend the functionality of the Fleet Management application.","pos":[1013,1108]},{"content":"You can customize model elements by creating <bpt id=\"p1\">*</bpt>extensions<ept id=\"p1\">*</ept>.","pos":[1109,1167],"source":" You can customize model elements by creating *extensions*."},{"content":"Unlike the overlayering capabilities of Microsoft Dynamics AX 2012, extensions don’t overlay the baseline model elements.","pos":[1168,1289]},{"content":"Instead, extensions are compiled as a separate assembly that adds to or customizes the model and the associated business logic.","pos":[1290,1417]},{"content":"You can extend metadata, for example, by adding a field to a table or adding a control to a form, and also extend or customize business logic by defining event handlers and plug-in classes.","pos":[1418,1607]},{"content":"You can now author event handlers on several pre-defined events on tables, forms, form data sources, form controls, and others.","pos":[1608,1735]},{"content":"Plug-ins are also a new extensibility concept that enables replacing or extending the business logic of the application.","pos":[1736,1856]},{"pos":[1861,1874],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"This tutorial requires you to access the environment using Remote Desktop, and that you be provisioned as an administrator on the instance.","pos":[1875,2014]},{"pos":[2019,2059],"content":"Understanding the Fleet Management model","linkify":"Understanding the Fleet Management model","nodes":[{"content":"Understanding the Fleet Management model","pos":[0,40]}]},{"content":"The Fleet Management application provides a rental car company a system for managing vehicles, customers and vehicle reservations.","pos":[2060,2190]},{"content":"The application is designed for use by the Fleet Clerk and Fleet Manager personas.","pos":[2191,2273]},{"pos":[2279,2290],"content":"Fleet Clerk","linkify":"Fleet Clerk","nodes":[{"content":"Fleet Clerk","pos":[0,11]}]},{"content":"The Clerk is the front desk employee who handles the face-to-face and over-the-phone interactions with customers.","pos":[2292,2405]},{"content":"The Clerk is primarily concerned with entering customer information into the application, creating vehicle reservations for customers, upselling the reservation by offering vehicle accessories, and processing vehicle returns upon completion of a vehicle rental.","pos":[2406,2667]},{"content":"The Clerk spends the vast majority of their time using the <bpt id=\"p1\">**</bpt>Fleet Management Workspace<ept id=\"p1\">**</ept> to prepare for interactions with customers by anticipating their needs and providing a pleasant and memorable experience, while interacting with the customer.","pos":[2668,2916],"source":" The Clerk spends the vast majority of their time using the **Fleet Management Workspace** to prepare for interactions with customers by anticipating their needs and providing a pleasant and memorable experience, while interacting with the customer."},{"pos":[2922,2935],"content":"Fleet Manager","linkify":"Fleet Manager","nodes":[{"content":"Fleet Manager","pos":[0,13]}]},{"content":"The Manager is the back office employee who handles setting business requirements and processes.","pos":[2937,3033]},{"content":"The Manager is primarily concerned with entering vehicle information, defining the available vehicle accessories, vehicle maintenance, determining pricing, and analyzing business performance measures such as revenue, upsell success, and so on.","pos":[3034,3277]},{"content":"The application's business logic revolves around the following three primary entities and the relationships between them.","pos":[3278,3399]},{"pos":[3405,3414],"content":"Customers","linkify":"Customers","nodes":[{"content":"Customers","pos":[0,9]}]},{"content":"Customers contact the Fleet Clerk to make vehicle reservations, choose vehicle accessories, check out and return vehicles, and pay for vehicle rentals.","pos":[3416,3567]},{"content":"Customer-related information is stored in the table named <bpt id=\"p1\">**</bpt>FMCustomer<ept id=\"p1\">**</ept>.","pos":[3568,3641],"source":" Customer-related information is stored in the table named **FMCustomer**."},{"pos":[3647,3655],"content":"Vehicles","linkify":"Vehicles","nodes":[{"content":"Vehicles","pos":[0,8]}]},{"content":"Vehicles vary primarily in their price, which is proportional to the vehicle <bpt id=\"p1\">*</bpt>class<ept id=\"p1\">*</ept>.","pos":[3657,3742],"source":"Vehicles vary primarily in their price, which is proportional to the vehicle *class*."},{"content":"The names of tables that store information about vehicles begin with \"FMVehicle\".**","pos":[3743,3826]},{"pos":[3832,3856],"content":"Reservations and rentals","linkify":"Reservations and rentals","nodes":[{"content":"Reservations and rentals","pos":[0,24]}]},{"content":"Reservations handle the relationship between customers and vehicles.","pos":[3858,3926]},{"content":"Reservation information includes reservation dates, customer information, vehicle selection and price, and additional charges such as accessories or fees.","pos":[3927,4081]},{"content":"Reservation and rental information is stored in the <bpt id=\"p1\">**</bpt>FMRental<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>FMRentalCharge<ept id=\"p2\">**</ept> tables.","pos":[4082,4177],"source":" Reservation and rental information is stored in the **FMRental** and **FMRentalCharge** tables."},{"content":"A calculation engine handles the transactional information related to the pricing of vehicle reservations.","pos":[4178,4284]},{"content":"Using this data model the Fleet Management application provides a basic car rental experience.","pos":[4285,4379]},{"pos":[4384,4420],"content":"Extending the Fleet Management model","linkify":"Extending the Fleet Management model","nodes":[{"content":"Extending the Fleet Management model","pos":[0,36]}]},{"content":"The basic Fleet Management application has been customized with additional capabilities that enable a rental car company to provide pricing incentives to its customers through discounts.","pos":[4421,4607]},{"content":"The additional business logic and data that enables these discount capabilities is stored in the Fleet Management Extension model.","pos":[4608,4738]},{"content":"The discount capabilities add value to the Fleet management application through three primary customizations.","pos":[4739,4848]},{"pos":[4854,4895],"content":"The Fleet Management Extension data model","linkify":"The Fleet Management Extension data model","nodes":[{"content":"The Fleet Management Extension data model","pos":[0,41]}]},{"content":"Two new tables have been added that store discount-related information.","pos":[4897,4968]},{"content":"<bpt id=\"p1\">**</bpt>FEDiscounts<ept id=\"p1\">**</ept> stores the list of all discounts and their rates.","pos":[4969,5034],"source":"**FEDiscounts** stores the list of all discounts and their rates."},{"content":"<bpt id=\"p1\">**</bpt>FERentalDiscountRelationTable<ept id=\"p1\">**</ept> keeps track of the reservations that the discounts are applied to.","pos":[5035,5135],"source":"**FERentalDiscountRelationTable** keeps track of the reservations that the discounts are applied to."},{"content":"Existing tables have been extended to account for the addition of discounts to the pricing scheme.","pos":[5136,5234]},{"content":"The table that keeps track of the vehicle rate for a particular reservation, named <bpt id=\"p1\">**</bpt>FMRental<ept id=\"p1\">**</ept>, has been extended to accommodate discounts to the vehicle rate.","pos":[5235,5395],"source":" The table that keeps track of the vehicle rate for a particular reservation, named **FMRental**, has been extended to accommodate discounts to the vehicle rate."},{"content":"The table that keeps track of the accessories for a reservation, named <bpt id=\"p1\">**</bpt>FMRentalCharge<ept id=\"p1\">**</ept>, has been extended to accommodate discounts applied to accessories.","pos":[5396,5553],"source":" The table that keeps track of the accessories for a reservation, named **FMRentalCharge**, has been extended to accommodate discounts applied to accessories."},{"pos":[5559,5608],"content":"The Fleet Management Extension Calculation Engine","linkify":"The Fleet Management Extension Calculation Engine","nodes":[{"content":"The Fleet Management Extension Calculation Engine","pos":[0,49]}]},{"content":"The basic calculation engine has been customized to add the various pricing schemes defined by the new discounts.","pos":[5610,5723]},{"content":"A plug-in class has replaced the functionality of the base calculation engine.","pos":[5724,5802]},{"content":"When a vehicle is reserved for more than 7 days, the vehicle Fleet Management model calculates savings based on the difference between a vehicle's daily rate and a lower weekly rate.","pos":[5803,5985]},{"content":"The plug-in removes the weekly-rate calculation because this same behavior can be accomplished by using discounts.","pos":[5986,6100]},{"pos":[6106,6152],"content":"The Fleet Management User Interface Extensions","linkify":"The Fleet Management User Interface Extensions","nodes":[{"content":"The Fleet Management User Interface Extensions","pos":[0,46]}]},{"content":"The Rental, which is contained by the form named <bpt id=\"p1\">**</bpt>FMRental<ept id=\"p1\">**</ept>, has been extended to enable the Clerk to apply discounts to a reservation.","pos":[6154,6291],"source":"The Rental, which is contained by the form named **FMRental**, has been extended to enable the Clerk to apply discounts to a reservation."},{"content":"The on-screen price summary is updated in real time with savings information related to discounts that can be applied to vehicles and accessories related to the reservation.","pos":[6292,6465]},{"content":"In the following steps, you'll explore the customizations that have been made in the Fleet management Extension model, as well as re-implement a portion of the customizations for yourself.","pos":[6466,6654]},{"pos":[6659,6664],"content":"Setup","linkify":"Setup","nodes":[{"content":"Setup","pos":[0,5]}]},{"content":"If you haven't opened the Fleet Management Solution in a previous tutorial, follow these steps.","pos":[6665,6760]},{"content":"The fleet management solution file is available on the Dynamics AX downloadable VM.","pos":[6761,6844]},{"pos":[6850,6950],"content":"On the <bpt id=\"p1\">**</bpt>Desktop<ept id=\"p1\">**</ept>, double-click the <bpt id=\"p2\">**</bpt>Visual Studio<ept id=\"p2\">**</ept> shortcut to open the development environment.","source":"On the **Desktop**, double-click the **Visual Studio** shortcut to open the development environment."},{"content":"Open the <bpt id=\"p1\">**</bpt>FleetManagement<ept id=\"p1\">**</ept> solution.","pos":[6955,6993],"source":"Open the **FleetManagement** solution."},{"content":"On the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, point to <bpt id=\"p2\">**</bpt>Open<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Project/Solution<ept id=\"p3\">**</ept>.","pos":[6994,7071],"source":" On the **File** menu, point to **Open**, and then click **Project/Solution**."},{"content":"Browse to the desktop and open the <bpt id=\"p1\">**</bpt>FleetManagement<ept id=\"p1\">**</ept> folder.","pos":[7076,7138],"source":"Browse to the desktop and open the **FleetManagement** folder."},{"content":"If the solution file is not on your computer, the steps to create it are listed in <bpt id=\"p1\">[</bpt>Tutorial: Create a Fleet Management solution file out of the Fleet Management models in the AOT<ept id=\"p1\">](https://community.dynamics.com/ax/b/newdynamicsax/archive/2016/05/19/tutorial-create-a-fleet-management-solution-file-out-of-the-fleet-management-models-in-the-aot)</ept>.","pos":[7139,7485],"source":" If the solution file is not on your computer, the steps to create it are listed in [Tutorial: Create a Fleet Management solution file out of the Fleet Management models in the AOT](https://community.dynamics.com/ax/b/newdynamicsax/archive/2016/05/19/tutorial-create-a-fleet-management-solution-file-out-of-the-fleet-management-models-in-the-aot)."},{"content":"Select the solution file named <bpt id=\"p1\">**</bpt>FleetManagement<ept id=\"p1\">**</ept>.","pos":[7490,7541],"source":"Select the solution file named **FleetManagement**."},{"content":"The file type listed is Microsoft Visual Studio Solution.","pos":[7542,7599]},{"content":"Click <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept>.","pos":[7604,7619],"source":"Click **Open**."},{"content":"The solution may take some time to open.","pos":[7620,7660]},{"pos":[7669,7693],"content":"Installing the demo data","linkify":"Installing the demo data","nodes":[{"content":"Installing the demo data","pos":[0,24]}]},{"content":"If you've already installed the demo data, you can skip to the next section.","pos":[7695,7771]},{"content":"In the VM, open Internet Explorer and navigate to the application's base URL.","pos":[7777,7854]},{"content":"Sign in.","pos":[7859,7867]},{"content":"On the dashboard, open the navigation pane and navigate to <bpt id=\"p1\">**</bpt>Fleet Management <ph id=\"ph1\">&amp;gt;</ph> Setup <ph id=\"ph2\">&amp;gt;</ph> Fleet Setup<ept id=\"p1\">**</ept>.","pos":[7872,7980],"source":"On the dashboard, open the navigation pane and navigate to **Fleet Management &gt; Setup &gt; Fleet Setup**."},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Fleet setup &gt; Customize model<ept id=\"p1\">](./media/fleetsetup_customizemodel.png)](./media/fleetsetup_customizemodel.png)</ept>","pos":[7981,8093],"source":"[![Fleet setup > Customize model](./media/fleetsetup_customizemodel.png)](./media/fleetsetup_customizemodel.png)"},{"pos":[8098,8124],"content":"Click <bpt id=\"p1\">**</bpt>Setup Demo Data<ept id=\"p1\">**</ept>.","source":"Click **Setup Demo Data**."},{"pos":[8135,8255],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Configuration &gt; Customize Model<ept id=\"p1\">](./media/configuration_customizemodel.png)](./media/configuration_customizemodel.png)</ept>","source":"[![Configuration > Customize Model](./media/configuration_customizemodel.png)](./media/configuration_customizemodel.png)"},{"pos":[8265,8323],"content":"If you're prompted to reload the demo data, click <bpt id=\"p1\">**</bpt>Yes<ept id=\"p1\">**</ept>.","source":"If you're prompted to reload the demo data, click **Yes**."},{"pos":[8328,8379],"content":"When the data is finished loading, click <bpt id=\"p1\">**</bpt>Close<ept id=\"p1\">**</ept>.","source":"When the data is finished loading, click **Close**."},{"content":"On the dashboard, open the navigation bar and navigate to <bpt id=\"p1\">**</bpt>System Administration <ph id=\"ph1\">&amp;gt;</ph> Common <ph id=\"ph2\">&amp;gt;</ph> Maintain aggregate measurements<ept id=\"p1\">**</ept>.","pos":[8384,8517],"source":"On the dashboard, open the navigation bar and navigate to **System Administration &gt; Common &gt; Maintain aggregate measurements**."},{"content":"(Steps 7 to 9 are not applicable on newer releases)","pos":[8518,8569]},{"pos":[8574,8656],"content":"Select <bpt id=\"p1\">**</bpt>FMAggregateMeasurements<ept id=\"p1\">**</ept>, and on the Action Pane, click <bpt id=\"p2\">**</bpt>Refresh now<ept id=\"p2\">**</ept>.","source":"Select **FMAggregateMeasurements**, and on the Action Pane, click **Refresh now**."},{"content":"Wait until the processing completes.","pos":[8661,8697]},{"content":"The ongoing processing is indicated at the top of the page by a series of moving dots.","pos":[8698,8784]},{"content":"The processing is completed when the indicator disappears and the <bpt id=\"p1\">**</bpt>Time Last Processed<ept id=\"p1\">**</ept> field is updated.","pos":[8785,8892],"source":" The processing is completed when the indicator disappears and the **Time Last Processed** field is updated."},{"pos":[8897,8945],"content":"Open the FMRental form on the onebox environment","linkify":"Open the FMRental form on the onebox environment","nodes":[{"content":"Open the FMRental form on the onebox environment","pos":[0,48]}]},{"content":"In the VM, open Internet Explorer and navigate to the base URL of your Dynamics AX application.","pos":[8950,9045]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Access Microsoft Dynamics AX Instances<ept id=\"p1\">](..\\dev-tools\\access-instances.md)</ept>.","pos":[9046,9147],"source":" For more information, see [Access Microsoft Dynamics AX Instances](..\\dev-tools\\access-instances.md)."},{"content":"Sign in, if prompted.","pos":[9152,9173]},{"pos":[9178,9274],"content":"Find the <bpt id=\"p1\">**</bpt>Reservation Management<ept id=\"p1\">**</ept> tile and click to open the Reservation Management workspace.","source":"Find the **Reservation Management** tile and click to open the Reservation Management workspace."},{"pos":[9281,9391],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Reservation management tile<ept id=\"p1\">](./media/reservationmanagementtile.jpg)](./media/reservationmanagementtile.jpg)</ept>","source":"[![Reservation management tile](./media/reservationmanagementtile.jpg)](./media/reservationmanagementtile.jpg)"},{"pos":[9401,9480],"content":"When the <bpt id=\"p1\">**</bpt>Reservation Management<ept id=\"p1\">**</ept> workspace opens, click <bpt id=\"p2\">**</bpt>Current rentals<ept id=\"p2\">**</ept>.","source":"When the **Reservation Management** workspace opens, click **Current rentals**."},{"pos":[9487,9595],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Current rentals<ept id=\"p1\">](./media/reservationmanagementworkspace.jpg)](./media/reservationmanagementworkspace.jpg)</ept>","source":"[![Current rentals](./media/reservationmanagementworkspace.jpg)](./media/reservationmanagementworkspace.jpg)"},{"pos":[9605,9653],"content":"This will open the <bpt id=\"p1\">**</bpt>Rental<ept id=\"p1\">**</ept> form in grid view.","source":"This will open the **Rental** form in grid view."},{"pos":[9660,9754],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Rental form<ept id=\"p1\">](./media/rentalform_customizemodel.png)](./media/rentalform_customizemodel.png)</ept>","source":"[![Rental form](./media/rentalform_customizemodel.png)](./media/rentalform_customizemodel.png)"},{"pos":[9764,9872],"content":"After the <bpt id=\"p1\">**</bpt>Rental<ept id=\"p1\">**</ept> form loads, click <bpt id=\"p2\">**</bpt>Options <ph id=\"ph1\">&amp;gt;</ph> Change view <ph id=\"ph2\">&amp;gt;</ph> Header<ept id=\"p2\">**</ept> to open the <bpt id=\"p3\">**</bpt>Header view<ept id=\"p3\">**</ept>.","source":"After the **Rental** form loads, click **Options &gt; Change view &gt; Header** to open the **Header view**."},{"pos":[9878,9972],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Header view<ept id=\"p1\">](./media/headerview_customizemodel.png)](./media/headerview_customizemodel.png)</ept>","source":"[![Header view](./media/headerview_customizemodel.png)](./media/headerview_customizemodel.png)"},{"content":"When the <bpt id=\"p1\">**</bpt>Header view<ept id=\"p1\">**</ept> form loads, scroll to the bottom and expand the <bpt id=\"p2\">**</bpt>Discounts<ept id=\"p2\">**</ept> tab.","pos":[9982,10073],"source":"When the **Header view** form loads, scroll to the bottom and expand the **Discounts** tab."},{"content":"This tab isn't part of the Fleet Management model.","pos":[10074,10124]},{"content":"It has been modeled in the Fleet Management Extension Model as an extension to the <bpt id=\"p1\">**</bpt>FMRental<ept id=\"p1\">**</ept> form.","pos":[10125,10226],"source":" It has been modeled in the Fleet Management Extension Model as an extension to the **FMRental** form."},{"pos":[10232,10322],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Discounts<ept id=\"p1\">](./media/discounts_customizemodel.png)](./media/discounts_customizemodel.png)</ept>","source":"[![Discounts](./media/discounts_customizemodel.png)](./media/discounts_customizemodel.png)"},{"pos":[10332,10364],"content":"Click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> to add a discount.","source":"Click **Add** to add a discount."},{"content":"Select the <bpt id=\"p1\">**</bpt>Frequent Customer<ept id=\"p1\">**</ept> discount, and then click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","pos":[10369,10434],"source":"Select the **Frequent Customer** discount, and then click **OK**."},{"content":"The selected discount is added to the <bpt id=\"p1\">**</bpt>Discounts<ept id=\"p1\">**</ept> grid.","pos":[10435,10492],"source":" The selected discount is added to the **Discounts** grid."},{"pos":[10499,10608],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Frequent customer discount<ept id=\"p1\">](./media/fcdiscount_customizemodel.png)](./media/fcdiscount_customizemodel.png)</ept>","source":"[![Frequent customer discount](./media/fcdiscount_customizemodel.png)](./media/fcdiscount_customizemodel.png)"},{"pos":[10618,10671],"content":"Use the shortcut key, <bpt id=\"p1\">**</bpt>Alt+F2<ept id=\"p1\">**</ept> to open the FactBox.","source":"Use the shortcut key, **Alt+F2** to open the FactBox."},{"pos":[10676,10772],"content":"Expand the <bpt id=\"p1\">**</bpt>Rental total<ept id=\"p1\">**</ept> FactBox on the right and view the discount savings that are applied.","source":"Expand the **Rental total** FactBox on the right and view the discount savings that are applied."},{"pos":[10779,10876],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Rental total<ept id=\"p1\">](./media/rentaltotal_customizemodel.png)](./media/rentaltotal_customizemodel.png)</ept>","source":"[![Rental total](./media/rentaltotal_customizemodel.png)](./media/rentaltotal_customizemodel.png)"},{"pos":[10881,10940],"content":"Overview of the Fleet management discount extension project","linkify":"Overview of the Fleet management discount extension project","nodes":[{"content":"Overview of the Fleet management discount extension project","pos":[0,59]}]},{"content":"In this tutorial, the <bpt id=\"p1\">**</bpt>FleetManagementDiscounts<ept id=\"p1\">**</ept> Project contains the model elements that belong to the model named <bpt id=\"p2\">**</bpt>Fleet Management Extension<ept id=\"p2\">**</ept>.","pos":[10941,11090],"source":"In this tutorial, the **FleetManagementDiscounts** Project contains the model elements that belong to the model named **Fleet Management Extension**."},{"content":"Here, you'll explore and learn about the project elements.","pos":[11091,11149]},{"pos":[11155,11206],"content":"Navigate to FMRental.Extension in the Tree Designer","linkify":"Navigate to FMRental.Extension in the Tree Designer","nodes":[{"content":"Navigate to FMRental.Extension in the Tree Designer","pos":[0,51]}]},{"pos":[11212,11353],"content":"In the Visual Studio, in <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, in the <bpt id=\"p2\">**</bpt>FleetManagement Discounts<ept id=\"p2\">**</ept> project, expand <bpt id=\"p3\">**</bpt>User Interface <ph id=\"ph1\">&amp;gt;</ph> Form Extensions<ept id=\"p3\">**</ept>.","source":"In the Visual Studio, in **Solution Explorer**, in the **FleetManagement Discounts** project, expand **User Interface &gt; Form Extensions**."},{"pos":[11364,11478],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Solution explorer<ept id=\"p1\">](./media/solutionexplorer1_customizemodel.png)](./media/solutionexplorer1_customizemodel.png)</ept>","source":"[![Solution explorer](./media/solutionexplorer1_customizemodel.png)](./media/solutionexplorer1_customizemodel.png)"},{"pos":[11488,11656],"content":"The <bpt id=\"p1\">**</bpt>FMRental.Extension<ept id=\"p1\">**</ept> element is an extension element that extends the functionality of the <bpt id=\"p2\">**</bpt>FMRental<ept id=\"p2\">**</ept> form by adding two new data sources and a new tab control.","source":"The **FMRental.Extension** element is an extension element that extends the functionality of the **FMRental** form by adding two new data sources and a new tab control."},{"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, double-click <bpt id=\"p2\">**</bpt>FMRental.Extension<ept id=\"p2\">**</ept> to open the designer.","pos":[11661,11744],"source":"In **Solution Explorer**, double-click **FMRental.Extension** to open the designer."},{"content":"As the following image shows:","pos":[11745,11774]},{"pos":[11783,11869],"content":"The data sources shown in <bpt id=\"p1\">*</bpt>italic<ept id=\"p1\">*</ept> text are data sources defined in the baseline form.","source":"The data sources shown in *italic* text are data sources defined in the baseline form."},{"pos":[11878,11959],"content":"The data sources shown in <bpt id=\"p1\">**</bpt>bold<ept id=\"p1\">**</ept> are the ones defined in the current extension.","source":"The data sources shown in **bold** are the ones defined in the current extension."},{"content":"The designer presents an integrated view of the model element, including its extensions.","pos":[11965,12053]},{"content":"Read-only nodes are shown in italic text, while nodes that belong to the current extension are shown in bold, with other visual cues that indicate the type of customization.","pos":[12054,12227]},{"pos":[12238,12350],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>FMRentalExt<ph id=\"ph2\">\\_</ph>CustomizeModel<ept id=\"p1\">](./media/fmrentalext_customizemodel.png)](./media/fmrentalext_customizemodel.png)</ept>","source":"[![FMRentalExt\\_CustomizeModel](./media/fmrentalext_customizemodel.png)](./media/fmrentalext_customizemodel.png)"},{"content":"In the designer's search box, type 'e:' as shown in the image below.","pos":[12364,12432]},{"content":"This filters the current designer to only show nodes that belong to the current extension.","pos":[12433,12523]},{"pos":[12530,12632],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Current extension<ept id=\"p1\">](./media/rentalext-e_customizemodel.png)](./media/rentalext-e_customizemodel.png)</ept>","source":"[![Current extension](./media/rentalext-e_customizemodel.png)](./media/rentalext-e_customizemodel.png)"},{"pos":[12642,12802],"content":"You can also type 'e:LineViewDiscounts' to filter the designer to show nodes that match the name <bpt id=\"p1\">**</bpt>LineViewDiscounts<ept id=\"p1\">**</ept> and that belong to the current extension.","source":"You can also type 'e:LineViewDiscounts' to filter the designer to show nodes that match the name **LineViewDiscounts** and that belong to the current extension."},{"pos":[12809,12923],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>LineViewDiscounts<ept id=\"p1\">](./media/lineviewdiscounts_customizemodel.png)](./media/lineviewdiscounts_customizemodel.png)</ept>","source":"[![LineViewDiscounts](./media/lineviewdiscounts_customizemodel.png)](./media/lineviewdiscounts_customizemodel.png)"},{"pos":[12933,12991],"content":"Expand the <bpt id=\"p1\">**</bpt>LineViewDiscounts<ept id=\"p1\">**</ept> node to see its contents.","source":"Expand the **LineViewDiscounts** node to see its contents."},{"pos":[12998,13116],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Expand LineViewDiscounts node<ept id=\"p1\">](./media/expandlvdnode_customizemodel.png)](./media/expandlvdnode_customizemodel.png)</ept>","source":"[![Expand LineViewDiscounts node](./media/expandlvdnode_customizemodel.png)](./media/expandlvdnode_customizemodel.png)"},{"pos":[13122,13179],"content":"Open the FMRental.Extension XML file to view the metadata","linkify":"Open the FMRental.Extension XML file to view the metadata","nodes":[{"content":"Open the FMRental.Extension XML file to view the metadata","pos":[0,57]}]},{"pos":[13185,13291],"content":"In the <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, right-click FMRental.Extension form extension, and then click <bpt id=\"p2\">**</bpt>Open with<ept id=\"p2\">**</ept>.","source":"In the **Solution Explorer**, right-click FMRental.Extension form extension, and then click **Open with**."},{"pos":[13296,13381],"content":"In the <bpt id=\"p1\">**</bpt>Open with<ept id=\"p1\">**</ept> dialog box, select <bpt id=\"p2\">**</bpt>XML (Text) Editor<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>.","source":"In the **Open with** dialog box, select **XML (Text) Editor**, and then click **OK**."},{"pos":[13386,13437],"content":"When prompted to close the designer, click <bpt id=\"p1\">**</bpt>Yes<ept id=\"p1\">**</ept>.","source":"When prompted to close the designer, click **Yes**."},{"content":"Click the corresponding minus signs to collapse the child nodes of the <bpt id=\"p1\">**</bpt>Controls<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>DataSources<ept id=\"p2\">**</ept> nodes.","pos":[13442,13552],"source":"Click the corresponding minus signs to collapse the child nodes of the **Controls** and **DataSources** nodes."},{"content":"Refer to the following image for the correct result.","pos":[13553,13605]},{"pos":[13612,13710],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Rental code<ept id=\"p1\">](./media/fmrentalcode_customizemodel.png)](./media/fmrentalcode_customizemodel.png)</ept>","source":"[![Rental code](./media/fmrentalcode_customizemodel.png)](./media/fmrentalcode_customizemodel.png)"},{"content":"The XML file contains the metadata associated with the <bpt id=\"p1\">**</bpt>FMRental.Extension<ept id=\"p1\">**</ept> element.","pos":[13721,13807],"source":"The XML file contains the metadata associated with the **FMRental.Extension** element."},{"content":"You can see that this file contains metadata that describes only one tab page control and two data sources that are part of the extension.","pos":[13808,13946]},{"content":"You can also see that it doesn't contain any metadata from the base form.","pos":[13947,14020]},{"pos":[14026,14096],"content":"View other elements in the Fleet Management discount extension project","linkify":"View other elements in the Fleet Management discount extension project","nodes":[{"content":"View other elements in the Fleet Management discount extension project","pos":[0,70]}]},{"pos":[14098,14311],"content":"The <bpt id=\"p1\">**</bpt>FleetManagement Discounts<ept id=\"p1\">**</ept> project contains two new tables, <bpt id=\"p2\">**</bpt>FEDiscount<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>FERentalDiscountRelationTable<ept id=\"p3\">**</ept>, and two extensions to existing Fleet Management tables, <bpt id=\"p4\">**</bpt>FMRental<ept id=\"p4\">**</ept> and <bpt id=\"p5\">**</bpt>FMRentalCharge<ept id=\"p5\">**</ept>.","source":"The **FleetManagement Discounts** project contains two new tables, **FEDiscount** and **FERentalDiscountRelationTable**, and two extensions to existing Fleet Management tables, **FMRental** and **FMRentalCharge**."},{"pos":[14317,14468],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, in FleetManagement Discounts, double-click <bpt id=\"p2\">**</bpt>Data Model <ph id=\"ph1\">&amp;gt;</ph> Table Extensions <ph id=\"ph2\">&amp;gt;</ph> FMRental.Extension<ept id=\"p2\">**</ept> to open the designer.","source":"In **Solution Explorer**, in FleetManagement Discounts, double-click **Data Model &gt; Table Extensions &gt; FMRental.Extension** to open the designer."},{"pos":[14473,14603],"content":"Expand the <bpt id=\"p1\">**</bpt>Fields<ept id=\"p1\">**</ept> node to see that this extension contains one added field, FEVehicleRateDiscount, to the base FMRental table.","source":"Expand the **Fields** node to see that this extension contains one added field, FEVehicleRateDiscount, to the base FMRental table."},{"pos":[14610,14704],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>FEVehicleRateDiscount<ept id=\"p1\">](./media/nodes_customizemodel.png)](./media/nodes_customizemodel.png)</ept>","source":"[![FEVehicleRateDiscount](./media/nodes_customizemodel.png)](./media/nodes_customizemodel.png)"},{"pos":[14714,14811],"content":"Similarly, open the <bpt id=\"p1\">**</bpt>FMRentalChange.Extension<ept id=\"p1\">**</ept> element in the designer to explore its contents.","source":"Similarly, open the **FMRentalChange.Extension** element in the designer to explore its contents."},{"pos":[14817,14848],"content":"Inspect the data event handlers","linkify":"Inspect the data event handlers","nodes":[{"content":"Inspect the data event handlers","pos":[0,31]}]},{"pos":[14850,15008],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, in the FleetManagement Discounts project, double-click <bpt id=\"p2\">**</bpt>Code <ph id=\"ph1\">&amp;gt;</ph> Classes <ph id=\"ph2\">&amp;gt;</ph> FMRentalCharge<ph id=\"ph3\">\\_</ph>Extension<ept id=\"p2\">**</ept> to open the code editor.","source":"In **Solution Explorer**, in the FleetManagement Discounts project, double-click **Code &gt; Classes &gt; FMRentalCharge\\_Extension** to open the code editor."},{"pos":[15011,15128],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>FMRentalChargeCode<ept id=\"p1\">](./media/fmrentalchargecode_customizemodel.png)](./media/fmrentalchargecode_customizemodel.png)</ept>","source":"[![FMRentalChargeCode](./media/fmrentalchargecode_customizemodel.png)](./media/fmrentalchargecode_customizemodel.png)"},{"content":"This class contains event handler implementations that subscribe to the <bpt id=\"p1\">**</bpt>Updating<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Inserting<ept id=\"p2\">**</ept> events of the <bpt id=\"p3\">**</bpt>FMRentalCharge<ept id=\"p3\">**</ept> table.","pos":[15135,15277],"source":"This class contains event handler implementations that subscribe to the **Updating** and **Inserting** events of the **FMRentalCharge** table."},{"content":"Microsoft Dynamics AX introduces data events that can occur on tables and other types.","pos":[15278,15364]},{"content":"You can subscribe to data events of a table, enabling your application to extend business logic without overlayering base X++ code.","pos":[15365,15496]},{"content":"Later in this tutorial, you'll see how easy it is to subscribe to table events.","pos":[15497,15576]},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept> Notice that this class is an extension class (indicated by the <ph id=\"ph1\">\\_</ph>Extension suffix).","pos":[15577,15670],"source":"**Note:** Notice that this class is an extension class (indicated by the \\_Extension suffix)."},{"content":"You can author event handlers in any class, this class does not need to be an extension class.","pos":[15671,15765]},{"content":"Extension classes are needed in order to create extension methods.","pos":[15766,15832]},{"content":"For more details on extension methods, refer to the \"Extension methods\" section of <bpt id=\"p1\">[</bpt>X++ debugger features<ept id=\"p1\">](..\\dev-tools\\new-x-debugger-features.md)</ept>article.","pos":[15833,15988],"source":" For more details on extension methods, refer to the \"Extension methods\" section of [X++ debugger features](..\\dev-tools\\new-x-debugger-features.md)article."},{"pos":[15994,16018],"content":"View the plug-in classes","linkify":"View the plug-in classes","nodes":[{"content":"View the plug-in classes","pos":[0,24]}]},{"content":"In the event handler code of the <bpt id=\"p1\">**</bpt>FMRentalCharge<ph id=\"ph1\">\\_</ph>Extension<ept id=\"p1\">**</ept> class shown in the previous section, notice that both event handlers call <bpt id=\"p2\">**</bpt>FMTotalsEngineBase::GetInstance<ept id=\"p2\">**</ept> to retrieve the current instance of the Fleet Management calculation engine.","pos":[16020,16269],"source":"In the event handler code of the **FMRentalCharge\\_Extension** class shown in the previous section, notice that both event handlers call **FMTotalsEngineBase::GetInstance** to retrieve the current instance of the Fleet Management calculation engine."},{"content":"The calculation engines are implemented by using plug-in classes.","pos":[16270,16335]},{"content":"A class factory creates the appropriate instances of a plug-in class based on configuration or business data.","pos":[16336,16445]},{"content":"In the code editor window that displays FMRentalCharge<ph id=\"ph1\">\\_</ph>Extension.xpp, right-click <bpt id=\"p1\">**</bpt>GetInstance<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Go To Definition<ept id=\"p2\">**</ept>.","pos":[16451,16587],"source":"In the code editor window that displays FMRentalCharge\\_Extension.xpp, right-click **GetInstance**, and then click **Go To Definition**."},{"content":"This will open the code of the abstract class <bpt id=\"p1\">**</bpt>FMTotalsEngineBase<ept id=\"p1\">**</ept>.","pos":[16588,16657],"source":" This will open the code of the abstract class **FMTotalsEngineBase**."},{"content":"This abstract class is called a <bpt id=\"p1\">**</bpt>plugin point<ept id=\"p1\">**</ept> and it's associated with the following attribute: <ph id=\"ph1\">\\[</ph>Microsoft.Dynamics.AX.Platform.Extensibility.ExportInterfaceAttribute()<ph id=\"ph2\">\\]</ph>","pos":[16658,16832],"source":" This abstract class is called a **plugin point** and it's associated with the following attribute: \\[Microsoft.Dynamics.AX.Platform.Extensibility.ExportInterfaceAttribute()\\]"},{"pos":[16839,16942],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Go to Definition<ept id=\"p1\">](./media/godefinition_customizemodel.png)](./media/godefinition_customizemodel.png)</ept>","source":"[![Go to Definition](./media/godefinition_customizemodel.png)](./media/godefinition_customizemodel.png)"},{"content":"Plug-in classes represent extensions or implementations of abstract classes or interfaces.","pos":[16953,17043]},{"content":"Plug-in classes are associated with attributes defining their metadata and the plug-in point.","pos":[17044,17137]},{"content":"In this example, there are two plug-in classes associated with the <bpt id=\"p1\">**</bpt>FMTotalsEngineBase<ept id=\"p1\">**</ept> plug-in point.","pos":[17138,17242],"source":" In this example, there are two plug-in classes associated with the **FMTotalsEngineBase** plug-in point."},{"content":"The base calculation engine is defined by the plug-in class <bpt id=\"p1\">**</bpt>FMTotalsEngine<ept id=\"p1\">**</ept>.","pos":[17243,17322],"source":" The base calculation engine is defined by the plug-in class **FMTotalsEngine**."},{"content":"You can find it in the project <bpt id=\"p1\">**</bpt>FleetManagement Migrated <ph id=\"ph1\">&amp;gt;</ph> Code <ph id=\"ph2\">&amp;gt;</ph> Classes<ept id=\"p1\">**</ept>.","pos":[17323,17406],"source":" You can find it in the project **FleetManagement Migrated &gt; Code &gt; Classes**."},{"pos":[17417,17508],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>FMTotalsEngineBase<ept id=\"p1\">](./media/code1_customizemodel.png)](./media/code1_customizemodel.png)</ept>","source":"[![FMTotalsEngineBase](./media/code1_customizemodel.png)](./media/code1_customizemodel.png)"},{"content":"The discount calculation engine is defined by the plug-in class <bpt id=\"p1\">**</bpt>FEDiscountEngine<ept id=\"p1\">**</ept>.","pos":[17519,17604],"source":"The discount calculation engine is defined by the plug-in class **FEDiscountEngine**."},{"content":"You can find it in the project <bpt id=\"p1\">**</bpt>FleetManagement Discounts <ph id=\"ph1\">&amp;gt;</ph> Code <ph id=\"ph2\">&amp;gt;</ph> Classes<ept id=\"p1\">**</ept>.","pos":[17605,17689],"source":" You can find it in the project **FleetManagement Discounts &gt; Code &gt; Classes**."},{"pos":[17700,17789],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>FEDiscountEngine<ept id=\"p1\">](./media/code2_customizemodel.png)](./media/code2_customizemodel.png)</ept>","source":"[![FEDiscountEngine](./media/code2_customizemodel.png)](./media/code2_customizemodel.png)"},{"content":"Look at the <bpt id=\"p1\">**</bpt>GetInstance<ept id=\"p1\">**</ept> method.","pos":[17799,17834],"source":"Look at the **GetInstance** method."},{"content":"It uses the plug-in factory <bpt id=\"p1\">**</bpt>SysPluginFactory::Instance<ept id=\"p1\">**</ept> to instantiate the current calculation engine based on current plug-in metadata.","pos":[17835,17974],"source":" It uses the plug-in factory **SysPluginFactory::Instance** to instantiate the current calculation engine based on current plug-in metadata."},{"content":"The plug-in metadata is specified in the global configuration table, <bpt id=\"p1\">**</bpt>FMParameters<ept id=\"p1\">**</ept>.","pos":[17975,18061],"source":" The plug-in metadata is specified in the global configuration table, **FMParameters**."},{"pos":[18072,18157],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>FMParameters<ept id=\"p1\">](./media/code3_customizemodel.png)](./media/code3_customizemodel.png)</ept>","source":"[![FMParameters](./media/code3_customizemodel.png)](./media/code3_customizemodel.png)"},{"content":"Dynamics AX also supports configurable plug-in classes where the plug-in metadata associate with the class isn't known at development time and is configurable at runtime by an administrator.","pos":[18168,18358]},{"content":"This isn't in the scope of this tutorial.","pos":[18359,18400]},{"pos":[18405,18450],"content":"Create additional Fleet Management extensions","linkify":"Create additional Fleet Management extensions","nodes":[{"content":"Create additional Fleet Management extensions","pos":[0,45]}]},{"content":"This section shows how you can use the Visual Studio tools to create and interact with extensions.","pos":[18451,18549]},{"pos":[18555,18581],"content":"Extend the FMVehicle Table","linkify":"Extend the FMVehicle Table","nodes":[{"content":"Extend the FMVehicle Table","pos":[0,26]}]},{"pos":[18587,18662],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, select the <bpt id=\"p2\">**</bpt>FleetManagement Discounts<ept id=\"p2\">**</ept> project.","source":"In **Solution Explorer**, select the **FleetManagement Discounts** project."},{"content":"In Visual studio, in <bpt id=\"p1\">**</bpt>Application Explorer,<ept id=\"p1\">**</ept> click <bpt id=\"p2\">**</bpt>View <ph id=\"ph1\">&amp;gt;</ph> Application Explorer<ept id=\"p2\">**</ept>, and search for the table named FMVehicle.","pos":[18667,18797],"source":"In Visual studio, in **Application Explorer,** click **View &gt; Application Explorer**, and search for the table named FMVehicle."},{"content":"Type \"FMVehicle type:Table\" in the filter bar and press <bpt id=\"p1\">**</bpt>Enter<ept id=\"p1\">**</ept>.","pos":[18798,18864],"source":" Type \"FMVehicle type:Table\" in the filter bar and press **Enter**."},{"pos":[18871,18998],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>AppExplorer search for FMVehicle<ept id=\"p1\">](./media/appexplorersmall_customizemodel.png)](./media/appexplorersmall_customizemodel.png)</ept>","source":"[![AppExplorer search for FMVehicle](./media/appexplorersmall_customizemodel.png)](./media/appexplorersmall_customizemodel.png)"},{"pos":[19008,19071],"content":"Right-click <bpt id=\"p1\">**</bpt>FMVehicle<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Create extension<ept id=\"p2\">**</ept>.","source":"Right-click **FMVehicle**, and then click **Create extension**."},{"pos":[19078,19203],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>AppExplorer Create extension<ept id=\"p1\">](./media/appexplorerlarge1_customizemodel.png)](./media/appexplorerlarge1_customizemodel.png)</ept>","source":"[![AppExplorer Create extension](./media/appexplorerlarge1_customizemodel.png)](./media/appexplorerlarge1_customizemodel.png)"},{"pos":[19213,19345],"content":"This will create an extension of the <bpt id=\"p1\">**</bpt>FMVehicle<ept id=\"p1\">**</ept> table in the <bpt id=\"p2\">**</bpt>FleetManagement Discounts<ept id=\"p2\">**</ept> project named <bpt id=\"p3\">**</bpt>FMVehicle.Extension<ept id=\"p3\">**</ept>.","source":"This will create an extension of the **FMVehicle** table in the **FleetManagement Discounts** project named **FMVehicle.Extension**."},{"pos":[19356,19478],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>FMVehicle.Extension<ept id=\"p1\">](./media/expanddiscountsnode2_customizemodel.png)](./media/expanddiscountsnode2_customizemodel.png)</ept>","source":"[![FMVehicle.Extension](./media/expanddiscountsnode2_customizemodel.png)](./media/expanddiscountsnode2_customizemodel.png)"},{"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, right-click <bpt id=\"p2\">**</bpt>FMVehicle.Extension<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Open with<ept id=\"p3\">**</ept>.","pos":[19492,19584],"source":"In **Solution Explorer**, right-click **FMVehicle.Extension**, and then click **Open with**."},{"content":"In the dialog box, select <bpt id=\"p1\">**</bpt>XML (Text) Editor<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","pos":[19585,19656],"source":" In the dialog box, select **XML (Text) Editor**, and then click **OK**."},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>: This extension file is simply a template that doesn't contain metadata from the base <bpt id=\"p2\">**</bpt>FMVehicle<ept id=\"p2\">**</ept> table.","pos":[19657,19772],"source":"**Note**: This extension file is simply a template that doesn't contain metadata from the base **FMVehicle** table."},{"content":"An extension file will always contain only the metadata that defines the extension and nothing from the base model element.","pos":[19773,19896]},{"pos":[19903,19985],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>FMVehicle<ept id=\"p1\">](./media/code4_customizemodel.png)](./media/code4_customizemodel.png)</ept>","source":"[![FMVehicle](./media/code4_customizemodel.png)](./media/code4_customizemodel.png)"},{"content":"Close the XML editor.","pos":[19995,20016]},{"pos":[20021,20105],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, double-click <bpt id=\"p2\">**</bpt>FMVehicle.Extension<ept id=\"p2\">**</ept> to open the designer.","source":"In **Solution Explorer**, double-click **FMVehicle.Extension** to open the designer."},{"content":"Right-click <bpt id=\"p1\">**</bpt>Fields<ept id=\"p1\">**</ept> and add a new integer field.","pos":[20110,20161],"source":"Right-click **Fields** and add a new integer field."},{"content":"Change the name of the field to <bpt id=\"p1\">**</bpt>NumberOfCyclinders<ept id=\"p1\">**</ept>.","pos":[20162,20217],"source":" Change the name of the field to **NumberOfCyclinders**."},{"pos":[20222,20321],"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window, set the <bpt id=\"p2\">**</bpt>Label<ept id=\"p2\">**</ept> property of the new field to <bpt id=\"p3\">**</bpt>NumberofCylinders<ept id=\"p3\">**</ept>.","source":"In the **Properties** window, set the **Label** property of the new field to **NumberofCylinders**."},{"pos":[20326,20452],"content":"Drag-and-drop the <bpt id=\"p1\">**</bpt>NumberOfCylinders<ept id=\"p1\">**</ept> field into the <bpt id=\"p2\">**</bpt>AutoReport<ept id=\"p2\">**</ept> field group to entend the field group of the base table.","source":"Drag-and-drop the **NumberOfCylinders** field into the **AutoReport** field group to entend the field group of the base table."},{"pos":[20459,20589],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>NumberOfCylinders<ph id=\"ph2\">\\_</ph>CustomizeModel<ept id=\"p1\">](./media/numberofcylinders_customizemodel.png)](./media/numberofcylinders_customizemodel.png)</ept>","source":"[![NumberOfCylinders\\_CustomizeModel](./media/numberofcylinders_customizemodel.png)](./media/numberofcylinders_customizemodel.png)"},{"content":"Save FMVehicle.Extension.","pos":[20599,20624]},{"content":"Expand the <bpt id=\"p1\">**</bpt>Events<ept id=\"p1\">**</ept> node.","pos":[20629,20656],"source":"Expand the **Events** node."},{"content":"The <bpt id=\"p1\">**</bpt>Events<ept id=\"p1\">**</ept> node lists all events that the table exposes.","pos":[20657,20717],"source":" The **Events** node lists all events that the table exposes."},{"content":"This includes events that are defined by the framework, and delegate methods that are defined by application developers.","pos":[20718,20838]},{"pos":[20845,20939],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Events node<ept id=\"p1\">](./media/eventsnode_customizemodel.png)](./media/eventsnode_customizemodel.png)</ept>","source":"[![Events node](./media/eventsnode_customizemodel.png)](./media/eventsnode_customizemodel.png)"},{"pos":[20949,21139],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>: Different framework events are exposed on the designers of many types of element and sub-elements, like table events, form events, form data source events, and form control events.","source":"**Note**: Different framework events are exposed on the designers of many types of element and sub-elements, like table events, form events, form data source events, and form control events."},{"pos":[21144,21220],"content":"Right-click onValidatedWrite, and then select <bpt id=\"p1\">**</bpt>Copy event handler method<ept id=\"p1\">**</ept>.","source":"Right-click onValidatedWrite, and then select **Copy event handler method**."},{"pos":[21227,21335],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>onValidateWrite<ept id=\"p1\">](./media/onvalidatewrite_customizemodel.png)](./media/onvalidatewrite_customizemodel.png)</ept>","source":"[![onValidateWrite](./media/onvalidatewrite_customizemodel.png)](./media/onvalidatewrite_customizemodel.png)"},{"content":"This step copies the event handler method signature to the clipboard.","pos":[21346,21415]},{"pos":[21420,21514],"content":"Add a new class named <bpt id=\"p1\">**</bpt>FMVehicleEventHandlers<ept id=\"p1\">**</ept> to the <bpt id=\"p2\">**</bpt>FleetManagement Discounts<ept id=\"p2\">**</ept> project.","source":"Add a new class named **FMVehicleEventHandlers** to the **FleetManagement Discounts** project."},{"pos":[21519,21609],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, double-click <bpt id=\"p2\">**</bpt>FEVehicleEventHandlers<ept id=\"p2\">**</ept> to open the code editor.","source":"In **Solution Explorer**, double-click **FEVehicleEventHandlers** to open the code editor."},{"content":"Right-click and paste the event handler method that you copied in step 12.","pos":[21614,21688]},{"content":"Insert the following code into the <bpt id=\"p1\">**</bpt>FMVehicle<ph id=\"ph1\">\\_</ph>onValidatedWrite<ept id=\"p1\">**</ept> event handler.","pos":[22116,22197],"source":"Insert the following code into the **FMVehicle\\_onValidatedWrite** event handler."},{"content":"This code validates that the number of cylinders can't be greater than 8.","pos":[22198,22271]},{"content":"Save FMVehicleEventHandlers class <bpt id=\"p1\">**</bpt>Tip<ept id=\"p1\">**</ept>: You can paste and define your event handlers in any class of your model.","pos":[22899,23014],"source":"Save FMVehicleEventHandlers class **Tip**: You can paste and define your event handlers in any class of your model."},{"content":"The class FMVehicleEventHandlers is used only as an example.","pos":[23015,23075]},{"pos":[23081,23106],"content":"Extend the FMVehicle Form","linkify":"Extend the FMVehicle Form","nodes":[{"content":"Extend the FMVehicle Form","pos":[0,25]}]},{"content":"Next, add an extension to the <bpt id=\"p1\">**</bpt>FMVehicle<ept id=\"p1\">**</ept> form in the <bpt id=\"p2\">**</bpt>FleetManagement Discounts<ept id=\"p2\">**</ept> project.","pos":[23108,23202],"source":"Next, add an extension to the **FMVehicle** form in the **FleetManagement Discounts** project."},{"content":"First, be sure to select this project in <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>.","pos":[23203,23266],"source":" First, be sure to select this project in **Solution Explorer**."},{"pos":[23272,23419],"content":"Use <bpt id=\"p1\">**</bpt>Application Explorer<ept id=\"p1\">**</ept> to find the form named <bpt id=\"p2\">**</bpt>FMVehicle<ept id=\"p2\">**</ept>, and in the <bpt id=\"p3\">**</bpt>Application Explorer<ept id=\"p3\">**</ept> filter bar, enter the <bpt id=\"p4\">*</bpt>FMVehicle type:form<ept id=\"p4\">*</ept>.","source":"Use **Application Explorer** to find the form named **FMVehicle**, and in the **Application Explorer** filter bar, enter the *FMVehicle type:form*."},{"pos":[23424,23482],"content":"Right-click the form, and then click <bpt id=\"p1\">**</bpt>Create extension<ept id=\"p1\">**</ept>.","source":"Right-click the form, and then click **Create extension**."},{"content":"Add a new integer control named <bpt id=\"p1\">**</bpt>NumberOfCylinders<ept id=\"p1\">**</ept> to the <bpt id=\"p2\">**</bpt>Attributes2<ept id=\"p2\">**</ept> group control as shown below.","pos":[23487,23593],"source":"Add a new integer control named **NumberOfCylinders** to the **Attributes2** group control as shown below."},{"content":"You can find this control by expanding <bpt id=\"p1\">**</bpt>Design <ph id=\"ph1\">&amp;gt;</ph> Tab <ph id=\"ph2\">&amp;gt;</ph> TabPageDetails <ph id=\"ph3\">&amp;gt;</ph> TabHeader <ph id=\"ph4\">&amp;gt;</ph> DetailsDetails <ph id=\"ph5\">&amp;gt;</ph> Attributes2<ept id=\"p1\">**</ept>.","pos":[23594,23725],"source":" You can find this control by expanding **Design &gt; Tab &gt; TabPageDetails &gt; TabHeader &gt; DetailsDetails &gt; Attributes2**."},{"pos":[23732,23840],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Number of Cylinders<ept id=\"p1\">](./media/numcylinteger_customizemodel.png)](./media/numcylinteger_customizemodel.png)</ept>","source":"[![Number of Cylinders](./media/numcylinteger_customizemodel.png)](./media/numcylinteger_customizemodel.png)"},{"pos":[23850,23947],"content":"Bind the new control to the <bpt id=\"p1\">**</bpt>NumberOfCylinders<ept id=\"p1\">**</ept> data field in the properties window as follows.","source":"Bind the new control to the **NumberOfCylinders** data field in the properties window as follows."},{"pos":[23958,24051],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Bind control<ept id=\"p1\">](./media/datafield_customizemodel.png)](./media/datafield_customizemodel.png)</ept>","source":"[![Bind control](./media/datafield_customizemodel.png)](./media/datafield_customizemodel.png)"},{"content":"Save FMVehicle.Extension and build the project.","pos":[24061,24108]},{"pos":[24114,24134],"content":"Test your extensions","linkify":"Test your extensions","nodes":[{"content":"Test your extensions","pos":[0,20]}]},{"pos":[24140,24251],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, right-click <bpt id=\"p2\">**</bpt>FleetManagement Discounts<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Set as StartUp project<ept id=\"p3\">**</ept>.","source":"In **Solution Explorer**, right-click **FleetManagement Discounts**, and then click **Set as StartUp project**."},{"pos":[24256,24356],"content":"Similarly, in FleetManagement Discounts, set the <bpt id=\"p1\">**</bpt>FMVehicle.Extension<ept id=\"p1\">**</ept> form as the startup object.","source":"Similarly, in FleetManagement Discounts, set the **FMVehicle.Extension** form as the startup object."},{"pos":[24361,24433],"content":"Press <bpt id=\"p1\">**</bpt>Ctrl+F5<ept id=\"p1\">**</ept> to start without debugging, or use the <bpt id=\"p2\">**</bpt>Debug<ept id=\"p2\">**</ept> menu.","source":"Press **Ctrl+F5** to start without debugging, or use the **Debug** menu."},{"pos":[24438,24510],"content":"After the <bpt id=\"p1\">**</bpt>Vehicles<ept id=\"p1\">**</ept> form opens, select a vehicle to view its details.","source":"After the **Vehicles** form opens, select a vehicle to view its details."},{"pos":[24515,24591],"content":"Expand the <bpt id=\"p1\">**</bpt>Details<ept id=\"p1\">**</ept> tab and notice the new <bpt id=\"p2\">**</bpt>Number of Cylinders<ept id=\"p2\">**</ept> field.","source":"Expand the **Details** tab and notice the new **Number of Cylinders** field."},{"pos":[24598,24679],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Details with number of cylinders<ept id=\"p1\">](./media/nbofcyls.jpg)](./media/nbofcyls.jpg)</ept>","source":"[![Details with number of cylinders](./media/nbofcyls.jpg)](./media/nbofcyls.jpg)"},{"pos":[24689,24789],"content":"In the Action Pane, click <bpt id=\"p1\">**</bpt>Edit<ept id=\"p1\">**</ept>, and change the value in the <bpt id=\"p2\">**</bpt>Number of cylinders<ept id=\"p2\">**</ept> field to 12.","source":"In the Action Pane, click **Edit**, and change the value in the **Number of cylinders** field to 12."},{"pos":[24794,24829],"content":"In the Action Pane, click <bpt id=\"p1\">**</bpt>Save<ept id=\"p1\">**</ept>.","source":"In the Action Pane, click **Save**."},{"content":"Notice the validation error.","pos":[24834,24862]},{"content":"Enter a valid number of cylinders, less than 9, and then save the new value.","pos":[24867,24943]},{"pos":[24948,24995],"content":"Experiment with event handlers on form controls","linkify":"Experiment with event handlers on form controls","nodes":[{"content":"Experiment with event handlers on form controls","pos":[0,47]}]},{"content":"This is an example of adding event handler methods on existing controls.","pos":[24996,25068]},{"pos":[25074,25231],"content":"Find the <bpt id=\"p1\">**</bpt>AddLine<ept id=\"p1\">**</ept> command button control in the <bpt id=\"p2\">**</bpt>FMRental<ept id=\"p2\">**</ept> form designer, right-click the <bpt id=\"p3\">**</bpt>OnClicked<ept id=\"p3\">**</ept> event, and select <bpt id=\"p4\">**</bpt>Copy event handler method<ept id=\"p4\">**</ept>.","source":"Find the **AddLine** command button control in the **FMRental** form designer, right-click the **OnClicked** event, and select **Copy event handler method**."},{"pos":[25237,25336],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Add line OnClicked event<ept id=\"p1\">](./media/addlineonclickedevent.jpg)](./media/addlineonclickedevent.jpg)</ept>","source":"[![Add line OnClicked event](./media/addlineonclickedevent.jpg)](./media/addlineonclickedevent.jpg)"},{"content":"Paste the event handler method in a class of the Fleet Management Extension model and add X++ code to implement it.","pos":[25346,25461]},{"pos":[25787,25917],"content":"When implementing the AddLine<ph id=\"ph1\">\\_</ph>OnClicked event handler, you can access the button control instance using the <bpt id=\"p1\">**</bpt>sender<ept id=\"p1\">**</ept> parameter.","source":"When implementing the AddLine\\_OnClicked event handler, you can access the button control instance using the **sender** parameter."},{"pos":[25994,26143],"content":"If you need to access the parent form or any of its variables, this example shows how to access the <bpt id=\"p1\">**</bpt>FormRun<ept id=\"p1\">**</ept> instance and one of its data sources.","source":"If you need to access the parent form or any of its variables, this example shows how to access the **FormRun** instance and one of its data sources."},{"pos":[26244,26295],"content":"Experiment with event handlers on form data sources","linkify":"Experiment with event handlers on form data sources","nodes":[{"content":"Experiment with event handlers on form data sources","pos":[0,51]}]},{"content":"Just like tables, form controls and other element types, form data sources and form data source fields provide framework-level events.","pos":[26296,26430]},{"content":"The following example shows how you can use the ValidatingWrite event on a form data source or the Validating event on a form data source field to validate user input on the FMRental form.","pos":[26431,26619]},{"content":"This functionality is available as of Platform Update 7.","pos":[26620,26676]},{"pos":[28644,28700],"content":"Experiment with table extension display and edit methods","linkify":"Experiment with table extension display and edit methods","nodes":[{"content":"Experiment with table extension display and edit methods","pos":[0,56]}]},{"content":"Extension methods enable you to extend tables by creating new display and edit methods on these tables without over-layering X++ code (Extension method must belong to a class named with an <ph id=\"ph1\">\\_</ph>Extension suffix).","pos":[28701,28910],"source":"Extension methods enable you to extend tables by creating new display and edit methods on these tables without over-layering X++ code (Extension method must belong to a class named with an \\_Extension suffix)."},{"content":"For example, this class shows how you can extend the FMVehicle table with an extension display method named CupHoldersDisplay.","pos":[28911,29037]},{"content":"On a form or form extension, you can bind a control to this display method by setting \"Data Source = FMVehicle\" and \"Data method = \"FMVehicle<ph id=\"ph1\">\\_</ph>Extension::CupHoldersDisplay\" as the image below shows.","pos":[29203,29401],"source":"On a form or form extension, you can bind a control to this display method by setting \"Data Source = FMVehicle\" and \"Data method = \"FMVehicle\\_Extension::CupHoldersDisplay\" as the image below shows."},{"content":"Extension display method","pos":[29405,29429]},{"pos":[29471,29518],"content":"Create a Fleet extension package for deployment","linkify":"Create a Fleet extension package for deployment","nodes":[{"content":"Create a Fleet extension package for deployment","pos":[0,47]}]},{"content":"To deploy your extension to another environment, for example, a test, pre-production or production environment, you must create a deployment package.","pos":[29519,29668]},{"pos":[29674,29787],"content":"In Visual Studio, on the <bpt id=\"p1\">**</bpt>Dynamics AX<ept id=\"p1\">**</ept> menu, point to <bpt id=\"p2\">**</bpt>Deploy<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Create Deployment Package<ept id=\"p3\">**</ept>.","source":"In Visual Studio, on the **Dynamics AX** menu, point to **Deploy**, and then click **Create Deployment Package**."},{"content":"Create deployment package","pos":[29796,29821]},{"pos":[29884,29936],"content":"Select the <bpt id=\"p1\">**</bpt>Fleet Management Extension<ept id=\"p1\">**</ept> check box.","source":"Select the **Fleet Management Extension** check box."},{"pos":[29941,30000],"content":"In the <bpt id=\"p1\">**</bpt>Package file location<ept id=\"p1\">**</ept> text box, enter \"c:FMLab\".","source":"In the **Package file location** text box, enter \"c:FMLab\"."},{"content":"Click <bpt id=\"p1\">**</bpt>Create<ept id=\"p1\">**</ept>.","pos":[30005,30022],"source":"Click **Create**."},{"content":"This will create a deployment package that contains the Fleet management Extension package.","pos":[30023,30114]},{"pos":[30117,30125],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[30136,30200],"content":"<bpt id=\"p1\">[</bpt>Download FMLab sample code<ept id=\"p1\">](https://github.com/Microsoft/FMLab)</ept>","source":"[Download FMLab sample code](https://github.com/Microsoft/FMLab)"}]}