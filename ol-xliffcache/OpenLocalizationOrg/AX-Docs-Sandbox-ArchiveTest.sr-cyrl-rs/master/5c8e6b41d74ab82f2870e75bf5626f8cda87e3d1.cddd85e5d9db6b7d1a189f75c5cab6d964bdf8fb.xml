{"content":"---\n# required metadata\n\ntitle: Install the Document Routing Agent to enable network printer devices\ndescription: This article describes how to install and configure the Document Routing Agent for deployments of Microsoft Dynamics 365 for Finance and Operations.\nauthor: sericks007\nmanager: AnnBe\nms.date: 06/20/2017\nms.topic: article\nms.prod: \nms.service: dynamics-ax-platform\nms.technology: \n\n# optional metadata\n\n# ms.search.form: \n# ROBOTS: \naudience: IT Pro\n# ms.devlang: \nms.reviewer: sericks\nms.search.scope: AX 7.0.0, Operations, UnifiedOperations\n# ms.tgt_pltfrm: \nms.custom: 98663\nms.assetid: cd017bfd-2eba-4e8a-ab9b-a0ce393c2108\nms.search.region: Global\n# ms.search.industry: \nms.author: tjvass\nms.search.validFrom: 2016-02-28\nms.dyn365.ops.version: AX 7.0.0\n\n---\n\n# Install the Document Routing Agent to enable network printer devices\n\n[!include[banner](../includes/banner.md)]\n\n\nThis article describes how to install and configure the Document Routing Agent for deployments of Microsoft Dynamics 365 for Finance and Operations.\n\nWhat's important to know?\n-------------------------\n\n-   Microsoft Dynamics 365 for Finance and Operations offers a downloadable application that you can use to enable network printing scenarios.\n-   You can enable network printers for specific companies by using in-client administrative pages.\n-   Access to network printing resources requires Active Directory Domain Services (AD DS) authentication.\n-   The Microsoft Azure Active Directory (Azure AD) account that is used to configure the Document Routing Agent must share the same domain as the Azure tenant.\n-   The application requires Adobe Acrobat Viewer.\n-   The client is supported only on Windows 8.1 and Windows 10, or on Microsoft Windows Server 2012 R2.\n-   RTM & Platform Update 1 deployments require .NET 4 on the client\n-   Platform Update 2 or later require .NET 4.62 on the client machine\n\nNetwork printers that are registered for Finance and Operations applications can be used by all legal entities (also known as companies) that are defined in the environment. Network printer settings are company-specific. Therefore, administrators can restrict access, based on the user's active company. For example, users in the active company might have access to all the network printers that are registered by the Document Routing Agent. However, users in another company won't have access to those printers until access is explicitly enabled for that company.\n\n## Key concepts\nThis article will help you with the following tasks:\n\n-   Identify the chief components that are involved in the support for network printing in Finance and Operations applications.\n-   Learn about the function of the Document Routing Agent.\n-   Configure the Document Routing Agent to work against an existing Finance and Operations application.\n-   Use administration pages to manage access to network printers.\n\n## Install the Document Routing Agent\nFinance and Operations applications use the Document Routing Agent to manage the spooling of documents to network printer devices. You can obtain the client by using direct links that are embedded in the web application. Use the following procedure to download the application to your local computer. You will then be able to access both local and network printers that are connected to your computer, from a single deployment of Finance and Operations.\n\n1.  Open the **Manage network printers** page (**Organization administration** &gt; **Setup** &gt; **Network printers**).\n2.  On the **Options** tab, in the **Application** group, click **Download document routing agent installer**. \n    \n    [![download-document-routing-agent-installer](./media/download-document-routing-agent-installer.png)](./media/download-document-routing-agent-installer.png)\n\n3.  Run the downloaded file to begin the installation process.\n4.  Complete the setup process.\n\nAfter the application is installed, you can begin to register local printers as network printers for the Finance and Operations applications.\n\n## Configure the Document Routing Agent\nUse the following procedure to configure the client application so that it can communicate with the Azure services that host the documents that are in-flight.\n\n1.  Close all browser instances that are running the Finance and Operations application, to reset local Azure authentication tokens.\n2.  On your desktop, run the Document Routing Agent.\n3.  On the toolbar, click **Settings**. \n    \n    [![the-document-routing-agent-window](./media/the-document-routing-agent-window.png)](./media/the-document-routing-agent-window.png)\n\n4.  Add the following settings:\n    -   **Application ID** – The ID that is unique to the application and should be entered automatically.\n    -   **Finance and Operations URL** – The base URL of the Finance and Operations application.\n    -   **Azure AD tenant** – The domain name of the Azure AD.\n\n5.  Click **OK**.\n6.  Click **Sign In** to sign in to your account. **Note:** The account must share the same domain as the Azure AD that is associated with the Finance and Operations application. The Document Routing Agent is now ready to process documents.\n\nAfter you've successfully signed in, the **Printers** button becomes available on the toolbar.\n\n## Register network printers in Dynamics 365 for Finance and Operations\nBefore you complete this procedure, make sure that you've installed all the network printers on the local host computer. All the printer devices that are installed will be available for service registration. Be sure to select only the printers that you want to expose in the Finance and Operations applications.\n\n1.  On the toolbar, click **Printers**.\n2.  Select the printers to make available in the Finance and Operations applications. \n    \n    [![printers-to-add](./media/printers-to-add.png)](./media/printers-to-add.png)\n\n3.  Specify a default name for the printer.\n4.  Click **OK**.\n\nAfter you've completed this procedure, the selected printer devices are registered in the Finance and Operations application's network printer catalog. System administrators can now enable the printers for access from within the application.\n\n## Administer network printers\nUse client pages to manage access to the network printers that have been registered by one or more Document Routing Agents. Network printers are uniquely identified by their path. Therefore, printers are listed one time, even if they have been registered by more than one Document Routing Agent. Use the following procedure to activate the Application Object Server (AOS) network printers.\n\n1.  Open the **Manage network printers** page (**Organization administration** &gt; **Setup** &gt; **Network printers**). \n\n    [![manage-network-printers-page](./media/manage-network-printers-page.png)](./media/manage-network-printers-page.png)\n    \n2.  Edit the existing entries that are mapped to each network printer. As part of your changes, edit the connection path.\n3.  To include a printer as an option in the **Print Destinations** field, set the **Active** field to **Yes**.\n\nCongratulations, you're done. The network printers can now be used in the Finance and Operations application.\n\n## Frequently asked questions\n###### Does the Document Routing Agent have to be installed on each computer where a user connects by using a browser?\n\nNo. Client installations of the Document Routing Agent can be shared by individuals who access the provisioned Finance and Operations environment. We recommend that you install agents on one or more Print Servers or other domain-hosted clients that have access to network printers.\n\n###### If the Document Routing Agent belongs on a network Print Server, why doesn't the client run as a service?\n\nWe agree. Our research and development (R&D) team is actively working to enhance the agent so that it runs as a Microsoft Windows service that can be managed by using Windows PowerShell commands.\n\n###### Will Microsoft add support for Microsoft Windows Server 2008 servers?\n\nNot at this time. There are several hard dependencies on Azure capabilities that are available only in Windows Server 2012 R2.\n\n###### Does the user who installs the Document Routing Agent have to be part of a Finance and Operations security group?\n\nYes. To access the agent installation links, the user must be part of the **Document routing client** security role.\n\n\n\n","nodes":[{"pos":[4,770],"embed":true,"restype":"x-metadata","content":"# required metadata\n\ntitle: Install the Document Routing Agent to enable network printer devices\ndescription: This article describes how to install and configure the Document Routing Agent for deployments of Microsoft Dynamics 365 for Finance and Operations.\nauthor: sericks007\nmanager: AnnBe\nms.date: 06/20/2017\nms.topic: article\nms.prod: \nms.service: dynamics-ax-platform\nms.technology: \n\n# optional metadata\n\n# ms.search.form: \n# ROBOTS: \naudience: IT Pro\n# ms.devlang: \nms.reviewer: sericks\nms.search.scope: AX 7.0.0, Operations, UnifiedOperations\n# ms.tgt_pltfrm: \nms.custom: 98663\nms.assetid: cd017bfd-2eba-4e8a-ab9b-a0ce393c2108\nms.search.region: Global\n# ms.search.industry: \nms.author: tjvass\nms.search.validFrom: 2016-02-28\nms.dyn365.ops.version: AX 7.0.0\n","nodes":[{"content":"Install the Document Routing Agent to enable network printer devices","nodes":[{"pos":[0,68],"content":"Install the Document Routing Agent to enable network printer devices","nodes":[{"content":"Install the Document Routing Agent to enable network printer devices","pos":[0,68]}]}],"path":["title"],"extradata":"MT"},{"content":"This article describes how to install and configure the Document Routing Agent for deployments of Microsoft Dynamics 365 for Finance and Operations.","nodes":[{"pos":[0,148],"content":"This article describes how to install and configure the Document Routing Agent for deployments of Microsoft Dynamics 365 for Finance and Operations.","nodes":[{"content":"This article describes how to install and configure the Document Routing Agent for deployments of Microsoft Dynamics 365 for Finance and Operations.","pos":[0,148]}]}],"path":["description"],"extradata":"MT"}],"header":"# required metadata\n","yml":true},{"pos":[778,846],"content":"Install the Document Routing Agent to enable network printer devices","linkify":"Install the Document Routing Agent to enable network printer devices","nodes":[{"content":"Install the Document Routing Agent to enable network printer devices","pos":[0,68]}]},{"content":"This article describes how to install and configure the Document Routing Agent for deployments of Microsoft Dynamics 365 for Finance and Operations.","pos":[892,1040]},{"pos":[1042,1067],"content":"What's important to know?","linkify":"What's important to know?","nodes":[{"content":"What's important to know?","pos":[0,25]}]},{"content":"Microsoft Dynamics 365 for Finance and Operations offers a downloadable application that you can use to enable network printing scenarios.","pos":[1099,1237]},{"content":"You can enable network printers for specific companies by using in-client administrative pages.","pos":[1242,1337]},{"content":"Access to network printing resources requires Active Directory Domain Services (AD DS) authentication.","pos":[1342,1444]},{"content":"The Microsoft Azure Active Directory (Azure AD) account that is used to configure the Document Routing Agent must share the same domain as the Azure tenant.","pos":[1449,1605]},{"content":"The application requires Adobe Acrobat Viewer.","pos":[1610,1656]},{"content":"The client is supported only on Windows 8.1 and Windows 10, or on Microsoft Windows Server 2012 R2.","pos":[1661,1760]},{"content":"RTM &amp; Platform Update 1 deployments require .NET 4 on the client","pos":[1765,1829],"source":"RTM & Platform Update 1 deployments require .NET 4 on the client"},{"content":"Platform Update 2 or later require .NET 4.62 on the client machine","pos":[1834,1900]},{"content":"Network printers that are registered for Finance and Operations applications can be used by all legal entities (also known as companies) that are defined in the environment.","pos":[1902,2075]},{"content":"Network printer settings are company-specific.","pos":[2076,2122]},{"content":"Therefore, administrators can restrict access, based on the user's active company.","pos":[2123,2205]},{"content":"For example, users in the active company might have access to all the network printers that are registered by the Document Routing Agent.","pos":[2206,2343]},{"content":"However, users in another company won't have access to those printers until access is explicitly enabled for that company.","pos":[2344,2466]},{"pos":[2471,2483],"content":"Key concepts","linkify":"Key concepts","nodes":[{"content":"Key concepts","pos":[0,12]}]},{"content":"This article will help you with the following tasks:","pos":[2484,2536]},{"content":"Identify the chief components that are involved in the support for network printing in Finance and Operations applications.","pos":[2542,2665]},{"content":"Learn about the function of the Document Routing Agent.","pos":[2670,2725]},{"content":"Configure the Document Routing Agent to work against an existing Finance and Operations application.","pos":[2730,2830]},{"content":"Use administration pages to manage access to network printers.","pos":[2835,2897]},{"pos":[2902,2936],"content":"Install the Document Routing Agent","linkify":"Install the Document Routing Agent","nodes":[{"content":"Install the Document Routing Agent","pos":[0,34]}]},{"content":"Finance and Operations applications use the Document Routing Agent to manage the spooling of documents to network printer devices.","pos":[2937,3067]},{"content":"You can obtain the client by using direct links that are embedded in the web application.","pos":[3068,3157]},{"content":"Use the following procedure to download the application to your local computer.","pos":[3158,3237]},{"content":"You will then be able to access both local and network printers that are connected to your computer, from a single deployment of Finance and Operations.","pos":[3238,3390]},{"pos":[3396,3513],"content":"Open the <bpt id=\"p1\">**</bpt>Manage network printers<ept id=\"p1\">**</ept> page (<bpt id=\"p2\">**</bpt>Organization administration<ept id=\"p2\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>Setup<ept id=\"p3\">**</ept> <ph id=\"ph2\">&amp;gt;</ph> <bpt id=\"p4\">**</bpt>Network printers<ept id=\"p4\">**</ept>).","source":"Open the **Manage network printers** page (**Organization administration** &gt; **Setup** &gt; **Network printers**)."},{"pos":[3518,3624],"content":"On the <bpt id=\"p1\">**</bpt>Options<ept id=\"p1\">**</ept> tab, in the <bpt id=\"p2\">**</bpt>Application<ept id=\"p2\">**</ept> group, click <bpt id=\"p3\">**</bpt>Download document routing agent installer<ept id=\"p3\">**</ept>.","source":"On the **Options** tab, in the **Application** group, click **Download document routing agent installer**."},{"pos":[3635,3791],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>download-document-routing-agent-installer<ept id=\"p1\">](./media/download-document-routing-agent-installer.png)](./media/download-document-routing-agent-installer.png)</ept>","source":"[![download-document-routing-agent-installer](./media/download-document-routing-agent-installer.png)](./media/download-document-routing-agent-installer.png)"},{"content":"Run the downloaded file to begin the installation process.","pos":[3797,3855]},{"content":"Complete the setup process.","pos":[3860,3887]},{"content":"After the application is installed, you can begin to register local printers as network printers for the Finance and Operations applications.","pos":[3889,4030]},{"pos":[4035,4071],"content":"Configure the Document Routing Agent","linkify":"Configure the Document Routing Agent","nodes":[{"content":"Configure the Document Routing Agent","pos":[0,36]}]},{"content":"Use the following procedure to configure the client application so that it can communicate with the Azure services that host the documents that are in-flight.","pos":[4072,4230]},{"content":"Close all browser instances that are running the Finance and Operations application, to reset local Azure authentication tokens.","pos":[4236,4364]},{"content":"On your desktop, run the Document Routing Agent.","pos":[4369,4417]},{"pos":[4422,4457],"content":"On the toolbar, click <bpt id=\"p1\">**</bpt>Settings<ept id=\"p1\">**</ept>.","source":"On the toolbar, click **Settings**."},{"pos":[4468,4600],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>the-document-routing-agent-window<ept id=\"p1\">](./media/the-document-routing-agent-window.png)](./media/the-document-routing-agent-window.png)</ept>","source":"[![the-document-routing-agent-window](./media/the-document-routing-agent-window.png)](./media/the-document-routing-agent-window.png)"},{"content":"Add the following settings:","pos":[4606,4633]},{"pos":[4642,4740],"content":"<bpt id=\"p1\">**</bpt>Application ID<ept id=\"p1\">**</ept> – The ID that is unique to the application and should be entered automatically.","source":"**Application ID** – The ID that is unique to the application and should be entered automatically."},{"pos":[4749,4837],"content":"<bpt id=\"p1\">**</bpt>Finance and Operations URL<ept id=\"p1\">**</ept> – The base URL of the Finance and Operations application.","source":"**Finance and Operations URL** – The base URL of the Finance and Operations application."},{"pos":[4846,4900],"content":"<bpt id=\"p1\">**</bpt>Azure AD tenant<ept id=\"p1\">**</ept> – The domain name of the Azure AD.","source":"**Azure AD tenant** – The domain name of the Azure AD."},{"pos":[4906,4919],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","source":"Click **OK**."},{"content":"Click <bpt id=\"p1\">**</bpt>Sign In<ept id=\"p1\">**</ept> to sign in to your account.","pos":[4924,4969],"source":"Click **Sign In** to sign in to your account."},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept> The account must share the same domain as the Azure AD that is associated with the Finance and Operations application.","pos":[4970,5098],"source":"**Note:** The account must share the same domain as the Azure AD that is associated with the Finance and Operations application."},{"content":"The Document Routing Agent is now ready to process documents.","pos":[5099,5160]},{"pos":[5162,5256],"content":"After you've successfully signed in, the <bpt id=\"p1\">**</bpt>Printers<ept id=\"p1\">**</ept> button becomes available on the toolbar.","source":"After you've successfully signed in, the **Printers** button becomes available on the toolbar."},{"pos":[5261,5329],"content":"Register network printers in Dynamics 365 for Finance and Operations","linkify":"Register network printers in Dynamics 365 for Finance and Operations","nodes":[{"content":"Register network printers in Dynamics 365 for Finance and Operations","pos":[0,68]}]},{"content":"Before you complete this procedure, make sure that you've installed all the network printers on the local host computer.","pos":[5330,5450]},{"content":"All the printer devices that are installed will be available for service registration.","pos":[5451,5537]},{"content":"Be sure to select only the printers that you want to expose in the Finance and Operations applications.","pos":[5538,5641]},{"pos":[5647,5682],"content":"On the toolbar, click <bpt id=\"p1\">**</bpt>Printers<ept id=\"p1\">**</ept>.","source":"On the toolbar, click **Printers**."},{"content":"Select the printers to make available in the Finance and Operations applications.","pos":[5687,5768]},{"pos":[5779,5857],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>printers-to-add<ept id=\"p1\">](./media/printers-to-add.png)](./media/printers-to-add.png)</ept>","source":"[![printers-to-add](./media/printers-to-add.png)](./media/printers-to-add.png)"},{"content":"Specify a default name for the printer.","pos":[5863,5902]},{"pos":[5907,5920],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","source":"Click **OK**."},{"content":"After you've completed this procedure, the selected printer devices are registered in the Finance and Operations application's network printer catalog.","pos":[5922,6073]},{"content":"System administrators can now enable the printers for access from within the application.","pos":[6074,6163]},{"pos":[6168,6195],"content":"Administer network printers","linkify":"Administer network printers","nodes":[{"content":"Administer network printers","pos":[0,27]}]},{"content":"Use client pages to manage access to the network printers that have been registered by one or more Document Routing Agents.","pos":[6196,6319]},{"content":"Network printers are uniquely identified by their path.","pos":[6320,6375]},{"content":"Therefore, printers are listed one time, even if they have been registered by more than one Document Routing Agent.","pos":[6376,6491]},{"content":"Use the following procedure to activate the Application Object Server (AOS) network printers.","pos":[6492,6585]},{"pos":[6591,6708],"content":"Open the <bpt id=\"p1\">**</bpt>Manage network printers<ept id=\"p1\">**</ept> page (<bpt id=\"p2\">**</bpt>Organization administration<ept id=\"p2\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>Setup<ept id=\"p3\">**</ept> <ph id=\"ph2\">&amp;gt;</ph> <bpt id=\"p4\">**</bpt>Network printers<ept id=\"p4\">**</ept>).","source":"Open the **Manage network printers** page (**Organization administration** &gt; **Setup** &gt; **Network printers**)."},{"pos":[6715,6832],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>manage-network-printers-page<ept id=\"p1\">](./media/manage-network-printers-page.png)](./media/manage-network-printers-page.png)</ept>","source":"[![manage-network-printers-page](./media/manage-network-printers-page.png)](./media/manage-network-printers-page.png)"},{"content":"Edit the existing entries that are mapped to each network printer.","pos":[6842,6908]},{"content":"As part of your changes, edit the connection path.","pos":[6909,6959]},{"pos":[6964,7071],"content":"To include a printer as an option in the <bpt id=\"p1\">**</bpt>Print Destinations<ept id=\"p1\">**</ept> field, set the <bpt id=\"p2\">**</bpt>Active<ept id=\"p2\">**</ept> field to <bpt id=\"p3\">**</bpt>Yes<ept id=\"p3\">**</ept>.","source":"To include a printer as an option in the **Print Destinations** field, set the **Active** field to **Yes**."},{"content":"Congratulations, you're done.","pos":[7073,7102]},{"content":"The network printers can now be used in the Finance and Operations application.","pos":[7103,7182]},{"pos":[7187,7213],"content":"Frequently asked questions","linkify":"Frequently asked questions","nodes":[{"content":"Frequently asked questions","pos":[0,26]}]},{"pos":[7221,7332],"content":"Does the Document Routing Agent have to be installed on each computer where a user connects by using a browser?","linkify":"Does the Document Routing Agent have to be installed on each computer where a user connects by using a browser?","nodes":[{"content":"Does the Document Routing Agent have to be installed on each computer where a user connects by using a browser?","pos":[0,111]}]},{"content":"No.","pos":[7334,7337]},{"content":"Client installations of the Document Routing Agent can be shared by individuals who access the provisioned Finance and Operations environment.","pos":[7338,7480]},{"content":"We recommend that you install agents on one or more Print Servers or other domain-hosted clients that have access to network printers.","pos":[7481,7615]},{"pos":[7624,7729],"content":"If the Document Routing Agent belongs on a network Print Server, why doesn't the client run as a service?","linkify":"If the Document Routing Agent belongs on a network Print Server, why doesn't the client run as a service?","nodes":[{"content":"If the Document Routing Agent belongs on a network Print Server, why doesn't the client run as a service?","pos":[0,105]}]},{"content":"We agree.","pos":[7731,7740]},{"content":"Our research and development (R&amp;D) team is actively working to enhance the agent so that it runs as a Microsoft Windows service that can be managed by using Windows PowerShell commands.","pos":[7741,7926],"source":" Our research and development (R&D) team is actively working to enhance the agent so that it runs as a Microsoft Windows service that can be managed by using Windows PowerShell commands."},{"pos":[7935,8004],"content":"Will Microsoft add support for Microsoft Windows Server 2008 servers?","linkify":"Will Microsoft add support for Microsoft Windows Server 2008 servers?","nodes":[{"content":"Will Microsoft add support for Microsoft Windows Server 2008 servers?","pos":[0,69]}]},{"content":"Not at this time.","pos":[8006,8023]},{"content":"There are several hard dependencies on Azure capabilities that are available only in Windows Server 2012 R2.","pos":[8024,8132]},{"pos":[8141,8254],"content":"Does the user who installs the Document Routing Agent have to be part of a Finance and Operations security group?","linkify":"Does the user who installs the Document Routing Agent have to be part of a Finance and Operations security group?","nodes":[{"content":"Does the user who installs the Document Routing Agent have to be part of a Finance and Operations security group?","pos":[0,113]}]},{"content":"Yes.","pos":[8256,8260]},{"content":"To access the agent installation links, the user must be part of the <bpt id=\"p1\">**</bpt>Document routing client<ept id=\"p1\">**</ept> security role.","pos":[8261,8372],"source":" To access the agent installation links, the user must be part of the **Document routing client** security role."}]}