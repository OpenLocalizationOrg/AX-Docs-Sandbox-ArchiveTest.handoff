{"content":"---\n# required metadata\n\ntitle: Version models in the automated build\ndescription: The topic explains how you can update the models in a source package and deployable package of the build output with the version of the build that produced them.\nauthor: jorisdg\nmanager: AnnBe\nms.date: 05/25/2017\nms.topic: article\nms.prod: \nms.service: dynamics-ax-platform\nms.technology: \n\n# optional metadata\n\n# ms.search.form: \n# ROBOTS: \naudience: Developer\n# ms.devlang: \nms.reviewer: robinr\nms.search.scope: AX 7.0.0, Operations, UnifiedOperations\n# ms.tgt_pltfrm: \nms.custom: 26731\nms.assetid:\nms.search.region: Global\n# ms.search.industry: \nms.author: jorisde\nms.search.validFrom: 2017-02-28\nms.dyn365.ops.version: AX 7.0.0\n\n---\n\n# Version models in the automated build\nIn Platform update 6, a new task in the automated build definition updates the models in the source package and deployable package of the build output with the version of the build that produced them.\n\nBuild definitions that were created before Platform update 6 must be manually updated to include this task. See the [Updating an existing build definition](#updating-an-existing-build-definition) section later in this topic.\n\n## Version numbers \nEven though models are compiled into one package, the metadata information of all models is retained inside the binary package. This information can be reviewed from Microsoft Dynamics Lifecycle Services (LCS) or from the client.\n\nIn LCS, follow these steps to find the version numbers of models that are installed in an environment.\n\n1. On the **Full details** page for the environment, under **Environment Version Information**, click the **View detailed version information** link. \n1. On the **Installed updates** page, in the **Machine name** field, select an Application Object Server (AOS) computer. \n1. In the table list, find the **Publisher name** field of the model, and expand the list by clicking the arrow icon. A full list of all models from that publisher is shown. The version number is shown in the **Version** column.\n\nIn the client, follow these steps to find the version numbers of models that are installed in an environment.\n\n1. Open the URL for the environment, and sign in. \n1. After the dashboard is loaded, click the gear symbol at the upper right of the page, and then click **About**. \n1. In the dialog box that appears, expand **Loaded Packages and their Models**. Find the package where the model resides, and expand the list by clicking the arrow icon. The list of models for the package is shown, together with the version number.\n\nAll version numbers are in .NET assembly format. They consist of four numbers that are separated by a dot (.), such as **1.2.3.4**.\n\n## The purpose of model versioning\nAs code is updated, the build is used to produce new packages that can be deployed to environments. Microsoft Visual Studio Team Services (VSTS) tracks the changes that have been included in each build since the previous build. When the version number of the build is included in the models that are produced, it provides end-to-end traceability of the code changes that are available in a specific environment. You can find the build number and then review the changes that are included in that build in VSTS. For customers and partners that use builds on different branches, or that use different build definitions for nightly builds, gated check-in builds, or deployment builds, each build can have a different versioning scheme. This approach helps differentiate the model metadata in the deployable packages and tie them back to their originating build definition.\n\n## Setting up versioning\nFor build definitions that are created by Platform update 6 or newer deployments, the task to include build version in models is automatically added and active. The default build number of a new build definition in VSTS consists of the year, month, and day, and the incremental number of the build for that day. For more information about build numbers in VSTS, and the options that are available, see [Build definition options](https://www.visualstudio.com/en-us/docs/build/define/options#Buildnumberformat) on the Microsoft Visual Studio docs site.\n\nThe automated build will apply the build version number to the models that are built.\n\n## Preventing models from being updated\nBy default, the build task assigns versions only to models that are in layers above the ISP layer. Therefore, customers can consume code models from third-party vendors without overwriting the version numbers that are supplied in their models. However, you can also prevent other models from having their version numbers overwritten during the build, regardless of layer. When you edit the build definition, on the **Variables** tab, in the **ModelVersionExclusions** variable, supply a comma-separated list of model names to exclude.\n\n## Updating models in lower layers\nFor third parties that develop solutions in the ISV or ISP layer, a manual change must be made to the build definition to automatically set model versions in those layers. \n\n1. Edit the build definition. On the **Tasks** tab, click the **Set Model Versions** task. \n1. In the **Arguments** field, add the following option at the end of the existing list of arguments: **-UpdateLayersAbove 7**\n\n# Updating an existing build definition\nFor build definitions that were created before Platform update 6, a new task must be manually added to the build definition.\n\n> [!NOTE]\n> This feature can be added to a build definition only after the build virtual machine (VM) has been updated to Platform update 6 or later.\n\n1. In VSTS, on the **Build & Release** page, under **Builds**, on the **All Definitions** tab, find your build definition. \n1. Click the ellipsis (â€¦), and then click **Edit**.\n\n    ![Edit the build definition](media/builddef_edit.png)\n\n1. On the **Tasks** tab, click **+ Add Task** at the bottom of the page.\n1. In the **Add tasks** pane on the right side of the page, on the **Utility** tab, scroll down to find the **PowerShell** task. \n1. Hover the mouse pointer over the task, and click the **Add** button that appears.\n\n    ![Add a PowerShell task](media/builddef_addpowershelltask.png)\n\n1. In the list of tasks on the left side of the page, click to select the **PowerShell Script** task that is added.\n1. On the right side of the page, change the **Display name**, **Script Path**, and **Arguments** properties to reflect the required settings.\n\n    ![Set the properties for the Set Model Versions task](media/builddef_setmodelversions_settings.png)\n\n1. In the list of tasks on the left side of the page, drag the **Set Model Versions** task so that it's between the **Prepare for build** and **Build the solution** tasks.\n\n    ![Set the order of the Set Model Versions task](media/builddef_setmodelversions_order.png)\n\n1. On the **Variables** tab, click **+ Add** at the bottom of the list of variables. In the first column, for the **Name** variable, enter **ModelVersionExclusions**.\n1. Click **Save** to save the new task.\n","nodes":[{"pos":[4,715],"embed":true,"restype":"x-metadata","content":"# required metadata\n\ntitle: Version models in the automated build\ndescription: The topic explains how you can update the models in a source package and deployable package of the build output with the version of the build that produced them.\nauthor: jorisdg\nmanager: AnnBe\nms.date: 05/25/2017\nms.topic: article\nms.prod: \nms.service: dynamics-ax-platform\nms.technology: \n\n# optional metadata\n\n# ms.search.form: \n# ROBOTS: \naudience: Developer\n# ms.devlang: \nms.reviewer: robinr\nms.search.scope: AX 7.0.0, Operations, UnifiedOperations\n# ms.tgt_pltfrm: \nms.custom: 26731\nms.assetid:\nms.search.region: Global\n# ms.search.industry: \nms.author: jorisde\nms.search.validFrom: 2017-02-28\nms.dyn365.ops.version: AX 7.0.0\n","nodes":[{"content":"Version models in the automated build","nodes":[{"pos":[0,37],"content":"Version models in the automated build","nodes":[{"content":"Version models in the automated build","pos":[0,37]}]}],"path":["title"],"extradata":"MT"},{"content":"The topic explains how you can update the models in a source package and deployable package of the build output with the version of the build that produced them.","nodes":[{"pos":[0,161],"content":"The topic explains how you can update the models in a source package and deployable package of the build output with the version of the build that produced them.","nodes":[{"content":"The topic explains how you can update the models in a source package and deployable package of the build output with the version of the build that produced them.","pos":[0,161]}]}],"path":["description"],"extradata":"MT"}],"header":"# required metadata\n","yml":true},{"pos":[723,760],"content":"Version models in the automated build","linkify":"Version models in the automated build","nodes":[{"content":"Version models in the automated build","pos":[0,37]}]},{"content":"In Platform update 6, a new task in the automated build definition updates the models in the source package and deployable package of the build output with the version of the build that produced them.","pos":[761,961]},{"content":"Build definitions that were created before Platform update 6 must be manually updated to include this task.","pos":[963,1070]},{"content":"See the <bpt id=\"p1\">[</bpt>Updating an existing build definition<ept id=\"p1\">](#updating-an-existing-build-definition)</ept> section later in this topic.","pos":[1071,1187],"source":" See the [Updating an existing build definition](#updating-an-existing-build-definition) section later in this topic."},{"pos":[1192,1207],"content":"Version numbers","linkify":"Version numbers","nodes":[{"content":"Version numbers","pos":[0,15]}]},{"content":"Even though models are compiled into one package, the metadata information of all models is retained inside the binary package.","pos":[1209,1336]},{"content":"This information can be reviewed from Microsoft Dynamics Lifecycle Services (LCS) or from the client.","pos":[1337,1438]},{"content":"In LCS, follow these steps to find the version numbers of models that are installed in an environment.","pos":[1440,1542]},{"pos":[1547,1693],"content":"On the <bpt id=\"p1\">**</bpt>Full details<ept id=\"p1\">**</ept> page for the environment, under <bpt id=\"p2\">**</bpt>Environment Version Information<ept id=\"p2\">**</ept>, click the <bpt id=\"p3\">**</bpt>View detailed version information<ept id=\"p3\">**</ept> link.","source":"On the **Full details** page for the environment, under **Environment Version Information**, click the **View detailed version information** link."},{"pos":[1698,1815],"content":"On the <bpt id=\"p1\">**</bpt>Installed updates<ept id=\"p1\">**</ept> page, in the <bpt id=\"p2\">**</bpt>Machine name<ept id=\"p2\">**</ept> field, select an Application Object Server (AOS) computer.","source":"On the **Installed updates** page, in the **Machine name** field, select an Application Object Server (AOS) computer."},{"content":"In the table list, find the <bpt id=\"p1\">**</bpt>Publisher name<ept id=\"p1\">**</ept> field of the model, and expand the list by clicking the arrow icon.","pos":[1820,1934],"source":"In the table list, find the **Publisher name** field of the model, and expand the list by clicking the arrow icon."},{"content":"A full list of all models from that publisher is shown.","pos":[1935,1990]},{"content":"The version number is shown in the <bpt id=\"p1\">**</bpt>Version<ept id=\"p1\">**</ept> column.","pos":[1991,2045],"source":" The version number is shown in the **Version** column."},{"content":"In the client, follow these steps to find the version numbers of models that are installed in an environment.","pos":[2047,2156]},{"content":"Open the URL for the environment, and sign in.","pos":[2161,2207]},{"pos":[2212,2322],"content":"After the dashboard is loaded, click the gear symbol at the upper right of the page, and then click <bpt id=\"p1\">**</bpt>About<ept id=\"p1\">**</ept>.","source":"After the dashboard is loaded, click the gear symbol at the upper right of the page, and then click **About**."},{"content":"In the dialog box that appears, expand <bpt id=\"p1\">**</bpt>Loaded Packages and their Models<ept id=\"p1\">**</ept>.","pos":[2327,2403],"source":"In the dialog box that appears, expand **Loaded Packages and their Models**."},{"content":"Find the package where the model resides, and expand the list by clicking the arrow icon.","pos":[2404,2493]},{"content":"The list of models for the package is shown, together with the version number.","pos":[2494,2572]},{"content":"All version numbers are in .NET assembly format.","pos":[2574,2622]},{"content":"They consist of four numbers that are separated by a dot (.), such as <bpt id=\"p1\">**</bpt>1.2.3.4<ept id=\"p1\">**</ept>.","pos":[2623,2705],"source":" They consist of four numbers that are separated by a dot (.), such as **1.2.3.4**."},{"pos":[2710,2741],"content":"The purpose of model versioning","linkify":"The purpose of model versioning","nodes":[{"content":"The purpose of model versioning","pos":[0,31]}]},{"content":"As code is updated, the build is used to produce new packages that can be deployed to environments.","pos":[2742,2841]},{"content":"Microsoft Visual Studio Team Services (VSTS) tracks the changes that have been included in each build since the previous build.","pos":[2842,2969]},{"content":"When the version number of the build is included in the models that are produced, it provides end-to-end traceability of the code changes that are available in a specific environment.","pos":[2970,3153]},{"content":"You can find the build number and then review the changes that are included in that build in VSTS.","pos":[3154,3252]},{"content":"For customers and partners that use builds on different branches, or that use different build definitions for nightly builds, gated check-in builds, or deployment builds, each build can have a different versioning scheme.","pos":[3253,3474]},{"content":"This approach helps differentiate the model metadata in the deployable packages and tie them back to their originating build definition.","pos":[3475,3611]},{"pos":[3616,3637],"content":"Setting up versioning","linkify":"Setting up versioning","nodes":[{"content":"Setting up versioning","pos":[0,21]}]},{"content":"For build definitions that are created by Platform update 6 or newer deployments, the task to include build version in models is automatically added and active.","pos":[3638,3798]},{"content":"The default build number of a new build definition in VSTS consists of the year, month, and day, and the incremental number of the build for that day.","pos":[3799,3949]},{"content":"For more information about build numbers in VSTS, and the options that are available, see <bpt id=\"p1\">[</bpt>Build definition options<ept id=\"p1\">](https://www.visualstudio.com/en-us/docs/build/define/options#Buildnumberformat)</ept> on the Microsoft Visual Studio docs site.","pos":[3950,4188],"source":" For more information about build numbers in VSTS, and the options that are available, see [Build definition options](https://www.visualstudio.com/en-us/docs/build/define/options#Buildnumberformat) on the Microsoft Visual Studio docs site."},{"content":"The automated build will apply the build version number to the models that are built.","pos":[4190,4275]},{"pos":[4280,4316],"content":"Preventing models from being updated","linkify":"Preventing models from being updated","nodes":[{"content":"Preventing models from being updated","pos":[0,36]}]},{"content":"By default, the build task assigns versions only to models that are in layers above the ISP layer.","pos":[4317,4415]},{"content":"Therefore, customers can consume code models from third-party vendors without overwriting the version numbers that are supplied in their models.","pos":[4416,4560]},{"content":"However, you can also prevent other models from having their version numbers overwritten during the build, regardless of layer.","pos":[4561,4688]},{"content":"When you edit the build definition, on the <bpt id=\"p1\">**</bpt>Variables<ept id=\"p1\">**</ept> tab, in the <bpt id=\"p2\">**</bpt>ModelVersionExclusions<ept id=\"p2\">**</ept> variable, supply a comma-separated list of model names to exclude.","pos":[4689,4851],"source":" When you edit the build definition, on the **Variables** tab, in the **ModelVersionExclusions** variable, supply a comma-separated list of model names to exclude."},{"pos":[4856,4887],"content":"Updating models in lower layers","linkify":"Updating models in lower layers","nodes":[{"content":"Updating models in lower layers","pos":[0,31]}]},{"content":"For third parties that develop solutions in the ISV or ISP layer, a manual change must be made to the build definition to automatically set model versions in those layers.","pos":[4888,5059]},{"content":"Edit the build definition.","pos":[5065,5091]},{"content":"On the <bpt id=\"p1\">**</bpt>Tasks<ept id=\"p1\">**</ept> tab, click the <bpt id=\"p2\">**</bpt>Set Model Versions<ept id=\"p2\">**</ept> task.","pos":[5092,5152],"source":" On the **Tasks** tab, click the **Set Model Versions** task."},{"pos":[5157,5280],"content":"In the <bpt id=\"p1\">**</bpt>Arguments<ept id=\"p1\">**</ept> field, add the following option at the end of the existing list of arguments: <bpt id=\"p2\">**</bpt>-UpdateLayersAbove 7<ept id=\"p2\">**</ept>","source":"In the **Arguments** field, add the following option at the end of the existing list of arguments: **-UpdateLayersAbove 7**"},{"pos":[5284,5321],"content":"Updating an existing build definition","linkify":"Updating an existing build definition","nodes":[{"content":"Updating an existing build definition","pos":[0,37]}]},{"content":"For build definitions that were created before Platform update 6, a new task must be manually added to the build definition.","pos":[5322,5446]},{"pos":[5450,5597],"content":"[!NOTE]\nThis feature can be added to a build definition only after the build virtual machine (VM) has been updated to Platform update 6 or later.","leadings":["","> "],"nodes":[{"content":"This feature can be added to a build definition only after the build virtual machine (VM) has been updated to Platform update 6 or later.","pos":[8,145]}]},{"pos":[5602,5721],"content":"In VSTS, on the <bpt id=\"p1\">**</bpt>Build &amp; Release<ept id=\"p1\">**</ept> page, under <bpt id=\"p2\">**</bpt>Builds<ept id=\"p2\">**</ept>, on the <bpt id=\"p3\">**</bpt>All Definitions<ept id=\"p3\">**</ept> tab, find your build definition.","source":"In VSTS, on the **Build & Release** page, under **Builds**, on the **All Definitions** tab, find your build definition."},{"pos":[5726,5774],"content":"Click the ellipsis (â€¦), and then click <bpt id=\"p1\">**</bpt>Edit<ept id=\"p1\">**</ept>.","source":"Click the ellipsis (â€¦), and then click **Edit**."},{"content":"Edit the build definition","pos":[5782,5807]},{"pos":[5838,5907],"content":"On the <bpt id=\"p1\">**</bpt>Tasks<ept id=\"p1\">**</ept> tab, click <bpt id=\"p2\">**</bpt>+ Add Task<ept id=\"p2\">**</ept> at the bottom of the page.","source":"On the **Tasks** tab, click **+ Add Task** at the bottom of the page."},{"pos":[5911,6036],"content":"In the <bpt id=\"p1\">**</bpt>Add tasks<ept id=\"p1\">**</ept> pane on the right side of the page, on the <bpt id=\"p2\">**</bpt>Utility<ept id=\"p2\">**</ept> tab, scroll down to find the <bpt id=\"p3\">**</bpt>PowerShell<ept id=\"p3\">**</ept> task.","source":"In the **Add tasks** pane on the right side of the page, on the **Utility** tab, scroll down to find the **PowerShell** task."},{"pos":[6041,6122],"content":"Hover the mouse pointer over the task, and click the <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> button that appears.","source":"Hover the mouse pointer over the task, and click the **Add** button that appears."},{"content":"Add a PowerShell task","pos":[6130,6151]},{"pos":[6195,6307],"content":"In the list of tasks on the left side of the page, click to select the <bpt id=\"p1\">**</bpt>PowerShell Script<ept id=\"p1\">**</ept> task that is added.","source":"In the list of tasks on the left side of the page, click to select the **PowerShell Script** task that is added."},{"pos":[6311,6450],"content":"On the right side of the page, change the <bpt id=\"p1\">**</bpt>Display name<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>Script Path<ept id=\"p2\">**</ept>, and <bpt id=\"p3\">**</bpt>Arguments<ept id=\"p3\">**</ept> properties to reflect the required settings.","source":"On the right side of the page, change the **Display name**, **Script Path**, and **Arguments** properties to reflect the required settings."},{"content":"Set the properties for the Set Model Versions task","pos":[6458,6508]},{"pos":[6560,6728],"content":"In the list of tasks on the left side of the page, drag the <bpt id=\"p1\">**</bpt>Set Model Versions<ept id=\"p1\">**</ept> task so that it's between the <bpt id=\"p2\">**</bpt>Prepare for build<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>Build the solution<ept id=\"p3\">**</ept> tasks.","source":"In the list of tasks on the left side of the page, drag the **Set Model Versions** task so that it's between the **Prepare for build** and **Build the solution** tasks."},{"content":"Set the order of the Set Model Versions task","pos":[6736,6780]},{"content":"On the <bpt id=\"p1\">**</bpt>Variables<ept id=\"p1\">**</ept> tab, click <bpt id=\"p2\">**</bpt>+ Add<ept id=\"p2\">**</ept> at the bottom of the list of variables.","pos":[6829,6910],"source":"On the **Variables** tab, click **+ Add** at the bottom of the list of variables."},{"content":"In the first column, for the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> variable, enter <bpt id=\"p2\">**</bpt>ModelVersionExclusions<ept id=\"p2\">**</ept>.","pos":[6911,6992],"source":" In the first column, for the **Name** variable, enter **ModelVersionExclusions**."},{"pos":[6996,7032],"content":"Click <bpt id=\"p1\">**</bpt>Save<ept id=\"p1\">**</ept> to save the new task.","source":"Click **Save** to save the new task."}]}