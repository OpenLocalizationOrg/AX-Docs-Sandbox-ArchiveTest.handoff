{"content":"---\n# required metadata\n\ntitle: Add dimensions to a Excel template\ndescription: This topic provides information about dimensions, dimensions that have entities, and the dimension controls that are available.\nauthor: robinarh\nmanager: AnnBe\nms.date: 06/20/2017\nms.topic: article\nms.prod: \nms.service: dynamics-ax-platform\nms.technology: \n\n# optional metadata\n\n# ms.search.form: \n# ROBOTS: \naudience: Developer\n# ms.devlang: \nms.reviewer: robinr\nms.search.scope: AX 7.0.0, Operations, UnifiedOperations\n# ms.tgt_pltfrm: \nms.custom: 11314\nms.assetid: 20e6b97e-30ed-48d4-b63c-a073f80300b2\nms.search.region: Global\n# ms.search.industry: \nms.author: rbrow\nms.search.validFrom: 2016-02-28\nms.dyn365.ops.version: AX 7.0.0\n\n---\n\n# Add dimensions to a Excel template\n\n[!include[banner](../includes/banner.md)]\n\n\nThis topic provides information about dimensions, dimensions that have entities, and the dimension controls that are available.\n\nThe only value that is present on Microsoft Excel templates after installation is the MainAccount. This is the only dimension that all customers will have. To add the dimensions to Microsoft Excel templates you need to complete the following steps:\n\n1.  Add dimensions to the DimensionCombinationEntity or the DimensionSet entity.\n2.  Add the dimensions to each template where you want dimensions in separate columns. For more information, see [Create open in Excel experiences](..\\office-integration\\office-integration-edit-excel.md).\n3.  Publish the template.\n\nThis topic shows how to modify DimensionCombinationEntity to enable the dimensions in columns for Excel. The same steps can be used to modify the DimensionSet entity. \n\n**Note:**  This information is subject to change for each release. Therefore, be sure to check back frequently for the most up-to-date information.\n\n## Add dimensions  Dynamics 365 for Operations (version 1611, build 7.1.1541.3036+, November 2016)\nModifying the **DimensionCombinationEntity** has been greatly simplified with the release of the Add financial dimensions for OData Addin in Visual Studio. \n\n1. In Microsoft Visual Studio, click **Dynamics 365** > **Addins** > **Add financial dimensions for Odata**.\n2. Type the name of the Financial dimension in the **Dimension name** column. This should be the exact name of the financial dimension. Select the **Model** that has your extensions. It should be above the AppSuite layer.** **Click **Apply**. \n\n    [![DimWiki2](./media/dimwiki2-300x225.png)](./media/dimwiki2.png)\n    \n3. Compile the project, and then synchronize it with the database. \n\n    ![8](./media/8-300x260.png) \n    \n4. Your customization is now completed. You can test it in SQL using the following statement.\n\n    select * from DIMENSIONCOMBINATIONENTITY\n\n## Add dimensions  before Dynamics 365 for Finance and Operations\nTo support interactions with dimensions as columns, for example, in the Microsoft Excel integration, you must first create the dimension columns through a customization. \n\n1. Open the Application Explorer in Visual Studio (**View** &gt; **Application Explorer**). \n2. Navigate to DimensionCombinationEntity **(AOT** &gt; **Data Model** &gt; **Data Entities**). \n3. Right-click on the entity and choose **Customize**. \n    \n    [![5](./media/5-300x187.png)](./media/5.png)\n\n4. Open the designer for the entity that you want to modify, in this example **DimensionCombinationEntity**. \n5. Create a new private static method that returns a str named **departmentValue**. \n6. In this method, you must get the dimension's value from **DimensionAttributeValueCombination**. The final method will look something like this.\n\n```\n/// <summary>\n/// This method returns the value of Department.\n/// </summary>\nprivate static str departmentValue()\n{     \n    Name dimensionName = 'Department';\n    str sqlStatement;\n\n    DimensionAttribute dimensionAttribute = DimensionAttribute::findByName(dimensionName);\n\n    if (!dimensionAttribute)\n    {\n        sqlStatement = SysComputedColumn::returnLiteral('');\n    }\n    else\n    {\n        sqlStatement = strFmt('SELECT TOP 1 T1.%1 ', dimensionAttribute.DimensionValueColumnName);\n    }\n\n    return sqlStatement;\n}\n```\n\n7. Create a new \"string unmapped field\" on the entity:\n\n    -  Set the **Name** property to the dimension name, **Department**.\n    -  Set the **Extended Data Type** property to **DimensionValue**.\n    -  Set the **DataEntityView Method** property to the method that you created earlier (for example, **departmentValue**).\n    -  Set the **Label** property to the dimension name **Department**.\n\n    [![6](./media/6-300x64.png)](./media/6.png)\n    \n8. Repeat steps 5-7 for each dimension that you want to add, changing the dimension name to the appropriate dimension. \n9. Compile the project, and then synchronize it with the database. \n\n    [![8](./media/8-300x260.png)](./media/8.png)\n    \n10. Your customization is now complete. You can test it in SQL using the following statement.\n\n```\nselect * from DIMENSIONCOMBINATIONENTITY\n```\n \n\n# See also\n\n[Dimension Entry control migration walkthrough](dimension-entry-control-migration.md)\n\n[Dimension Entry control uptake](dimension-entry-control-uptake.md)\n\n[Extensibility home page](..\\extensibility\\extensibility-home-page.md)\n\n\n\n","nodes":[{"pos":[4,714],"embed":true,"restype":"x-metadata","content":"# required metadata\n\ntitle: Add dimensions to a Excel template\ndescription: This topic provides information about dimensions, dimensions that have entities, and the dimension controls that are available.\nauthor: robinarh\nmanager: AnnBe\nms.date: 06/20/2017\nms.topic: article\nms.prod: \nms.service: dynamics-ax-platform\nms.technology: \n\n# optional metadata\n\n# ms.search.form: \n# ROBOTS: \naudience: Developer\n# ms.devlang: \nms.reviewer: robinr\nms.search.scope: AX 7.0.0, Operations, UnifiedOperations\n# ms.tgt_pltfrm: \nms.custom: 11314\nms.assetid: 20e6b97e-30ed-48d4-b63c-a073f80300b2\nms.search.region: Global\n# ms.search.industry: \nms.author: rbrow\nms.search.validFrom: 2016-02-28\nms.dyn365.ops.version: AX 7.0.0\n","nodes":[{"content":"Add dimensions to a Excel template","nodes":[{"pos":[0,34],"content":"Add dimensions to a Excel template","nodes":[{"content":"Add dimensions to a Excel template","pos":[0,34]}]}],"path":["title"],"extradata":"MT"},{"content":"This topic provides information about dimensions, dimensions that have entities, and the dimension controls that are available.","nodes":[{"pos":[0,127],"content":"This topic provides information about dimensions, dimensions that have entities, and the dimension controls that are available.","nodes":[{"content":"This topic provides information about dimensions, dimensions that have entities, and the dimension controls that are available.","pos":[0,127]}]}],"path":["description"],"extradata":"MT"}],"header":"# required metadata\n","yml":true},{"pos":[722,756],"content":"Add dimensions to a Excel template","linkify":"Add dimensions to a Excel template","nodes":[{"content":"Add dimensions to a Excel template","pos":[0,34]}]},{"content":"This topic provides information about dimensions, dimensions that have entities, and the dimension controls that are available.","pos":[802,929]},{"content":"The only value that is present on Microsoft Excel templates after installation is the MainAccount.","pos":[931,1029]},{"content":"This is the only dimension that all customers will have.","pos":[1030,1086]},{"content":"To add the dimensions to Microsoft Excel templates you need to complete the following steps:","pos":[1087,1179]},{"content":"Add dimensions to the DimensionCombinationEntity or the DimensionSet entity.","pos":[1185,1261]},{"content":"Add the dimensions to each template where you want dimensions in separate columns.","pos":[1266,1348]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Create open in Excel experiences<ept id=\"p1\">](..\\office-integration\\office-integration-edit-excel.md)</ept>.","pos":[1349,1466],"source":" For more information, see [Create open in Excel experiences](..\\office-integration\\office-integration-edit-excel.md)."},{"content":"Publish the template.","pos":[1471,1492]},{"content":"This topic shows how to modify DimensionCombinationEntity to enable the dimensions in columns for Excel.","pos":[1494,1598]},{"content":"The same steps can be used to modify the DimensionSet entity.","pos":[1599,1660]},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept>  This information is subject to change for each release.","pos":[1663,1729],"source":"**Note:**  This information is subject to change for each release."},{"content":"Therefore, be sure to check back frequently for the most up-to-date information.","pos":[1730,1810]},{"pos":[1815,1910],"content":"Add dimensions  Dynamics 365 for Operations (version 1611, build 7.1.1541.3036+, November 2016)","linkify":"Add dimensions  Dynamics 365 for Operations (version 1611, build 7.1.1541.3036+, November 2016)","nodes":[{"content":"Add dimensions  Dynamics 365 for Operations (version 1611, build 7.1.1541.3036+, November 2016)","pos":[0,95]}]},{"pos":[1911,2066],"content":"Modifying the <bpt id=\"p1\">**</bpt>DimensionCombinationEntity<ept id=\"p1\">**</ept> has been greatly simplified with the release of the Add financial dimensions for OData Addin in Visual Studio.","source":"Modifying the **DimensionCombinationEntity** has been greatly simplified with the release of the Add financial dimensions for OData Addin in Visual Studio."},{"pos":[2072,2177],"content":"In Microsoft Visual Studio, click <bpt id=\"p1\">**</bpt>Dynamics 365<ept id=\"p1\">**</ept><ph id=\"ph1\"> &gt; </ph><bpt id=\"p2\">**</bpt>Addins<ept id=\"p2\">**</ept><ph id=\"ph2\"> &gt; </ph><bpt id=\"p3\">**</bpt>Add financial dimensions for Odata<ept id=\"p3\">**</ept>.","source":"In Microsoft Visual Studio, click **Dynamics 365** > **Addins** > **Add financial dimensions for Odata**."},{"content":"Type the name of the Financial dimension in the <bpt id=\"p1\">**</bpt>Dimension name<ept id=\"p1\">**</ept> column.","pos":[2181,2255],"source":"Type the name of the Financial dimension in the **Dimension name** column."},{"content":"This should be the exact name of the financial dimension.","pos":[2256,2313]},{"content":"Select the <bpt id=\"p1\">**</bpt>Model<ept id=\"p1\">**</ept> that has your extensions.","pos":[2314,2360],"source":" Select the **Model** that has your extensions."},{"content":"It should be above the AppSuite layer.** **Click <bpt id=\"p1\">**</bpt>Apply<ept id=\"p1\">**</ept>.","pos":[2361,2420],"source":" It should be above the AppSuite layer.** **Click **Apply**."},{"pos":[2427,2492],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>DimWiki2<ept id=\"p1\">](./media/dimwiki2-300x225.png)](./media/dimwiki2.png)</ept>","source":"[![DimWiki2](./media/dimwiki2-300x225.png)](./media/dimwiki2.png)"},{"content":"Compile the project, and then synchronize it with the database.","pos":[2501,2564]},{"content":"8","pos":[2573,2574]},{"content":"Your customization is now completed.","pos":[2608,2644]},{"content":"You can test it in SQL using the following statement.","pos":[2645,2698]},{"content":"select * from DIMENSIONCOMBINATIONENTITY","pos":[2704,2744]},{"pos":[2749,2811],"content":"Add dimensions  before Dynamics 365 for Finance and Operations","linkify":"Add dimensions  before Dynamics 365 for Finance and Operations","nodes":[{"content":"Add dimensions  before Dynamics 365 for Finance and Operations","pos":[0,62]}]},{"content":"To support interactions with dimensions as columns, for example, in the Microsoft Excel integration, you must first create the dimension columns through a customization.","pos":[2812,2981]},{"pos":[2987,3075],"content":"Open the Application Explorer in Visual Studio (<bpt id=\"p1\">**</bpt>View<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>Application Explorer<ept id=\"p2\">**</ept>).","source":"Open the Application Explorer in Visual Studio (**View** &gt; **Application Explorer**)."},{"pos":[3080,3172],"content":"Navigate to DimensionCombinationEntity <bpt id=\"p1\">**</bpt>(AOT<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>Data Model<ept id=\"p2\">**</ept> <ph id=\"ph2\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>Data Entities<ept id=\"p3\">**</ept>).","source":"Navigate to DimensionCombinationEntity **(AOT** &gt; **Data Model** &gt; **Data Entities**)."},{"pos":[3177,3228],"content":"Right-click on the entity and choose <bpt id=\"p1\">**</bpt>Customize<ept id=\"p1\">**</ept>.","source":"Right-click on the entity and choose **Customize**."},{"pos":[3239,3283],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>5<ept id=\"p1\">](./media/5-300x187.png)](./media/5.png)</ept>","source":"[![5](./media/5-300x187.png)](./media/5.png)"},{"pos":[3288,3393],"content":"Open the designer for the entity that you want to modify, in this example <bpt id=\"p1\">**</bpt>DimensionCombinationEntity<ept id=\"p1\">**</ept>.","source":"Open the designer for the entity that you want to modify, in this example **DimensionCombinationEntity**."},{"pos":[3398,3478],"content":"Create a new private static method that returns a str named <bpt id=\"p1\">**</bpt>departmentValue<ept id=\"p1\">**</ept>.","source":"Create a new private static method that returns a str named **departmentValue**."},{"content":"In this method, you must get the dimension's value from <bpt id=\"p1\">**</bpt>DimensionAttributeValueCombination<ept id=\"p1\">**</ept>.","pos":[3483,3578],"source":"In this method, you must get the dimension's value from **DimensionAttributeValueCombination**."},{"content":"The final method will look something like this.","pos":[3579,3626]},{"content":"Create a new \"string unmapped field\" on the entity:","pos":[4166,4217]},{"pos":[4226,4290],"content":"Set the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> property to the dimension name, <bpt id=\"p2\">**</bpt>Department<ept id=\"p2\">**</ept>.","source":"Set the **Name** property to the dimension name, **Department**."},{"pos":[4298,4360],"content":"Set the <bpt id=\"p1\">**</bpt>Extended Data Type<ept id=\"p1\">**</ept> property to <bpt id=\"p2\">**</bpt>DimensionValue<ept id=\"p2\">**</ept>.","source":"Set the **Extended Data Type** property to **DimensionValue**."},{"pos":[4368,4485],"content":"Set the <bpt id=\"p1\">**</bpt>DataEntityView Method<ept id=\"p1\">**</ept> property to the method that you created earlier (for example, <bpt id=\"p2\">**</bpt>departmentValue<ept id=\"p2\">**</ept>).","source":"Set the **DataEntityView Method** property to the method that you created earlier (for example, **departmentValue**)."},{"pos":[4493,4557],"content":"Set the <bpt id=\"p1\">**</bpt>Label<ept id=\"p1\">**</ept> property to the dimension name <bpt id=\"p2\">**</bpt>Department<ept id=\"p2\">**</ept>.","source":"Set the **Label** property to the dimension name **Department**."},{"pos":[4563,4606],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>6<ept id=\"p1\">](./media/6-300x64.png)](./media/6.png)</ept>","source":"[![6](./media/6-300x64.png)](./media/6.png)"},{"content":"Repeat steps 5-7 for each dimension that you want to add, changing the dimension name to the appropriate dimension.","pos":[4615,4730]},{"content":"Compile the project, and then synchronize it with the database.","pos":[4735,4798]},{"pos":[4805,4849],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>8<ept id=\"p1\">](./media/8-300x260.png)](./media/8.png)</ept>","source":"[![8](./media/8-300x260.png)](./media/8.png)"},{"content":"Your customization is now complete.","pos":[4859,4894]},{"content":"You can test it in SQL using the following statement.","pos":[4895,4948]},{"pos":[5004,5012],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5014,5099],"content":"<bpt id=\"p1\">[</bpt>Dimension Entry control migration walkthrough<ept id=\"p1\">](dimension-entry-control-migration.md)</ept>","source":"[Dimension Entry control migration walkthrough](dimension-entry-control-migration.md)"},{"pos":[5101,5168],"content":"<bpt id=\"p1\">[</bpt>Dimension Entry control uptake<ept id=\"p1\">](dimension-entry-control-uptake.md)</ept>","source":"[Dimension Entry control uptake](dimension-entry-control-uptake.md)"},{"pos":[5170,5240],"content":"<bpt id=\"p1\">[</bpt>Extensibility home page<ept id=\"p1\">](..\\extensibility\\extensibility-home-page.md)</ept>","source":"[Extensibility home page](..\\extensibility\\extensibility-home-page.md)"}]}