{"content":"---\n# required metadata\n\ntitle: Extend the list of Electronic reporting functions\ndescription: Various types of functions are supported in Electronic reporting expressions for data transformation -  text, date and time, mathematical logical, information, data type conversion, and other (business domain–specific functions). In addition to built-in functions, Electronic reporting lets you extend the list of available functions. This article includes an overview of key tasks that you must complete to introduce a new function.\nauthor: kfend\nmanager: AnnBe\nms.date: 06/20/2017\nms.topic: article\nms.prod: \nms.service: dynamics-ax-platform\nms.technology: \n\n# optional metadata\n\nms.search.form: ERExpressionDesignerFormula\n# ROBOTS: \naudience: Developer, IT Pro\n# ms.devlang: \nms.reviewer: kfend\nms.search.scope: Core, AX 7.0.0, Operations, UnifiedOperations\n# ms.tgt_pltfrm: \nms.custom: 58911\nms.assetid: 62c740dc-6a88-4ded-9c41-6857b82b335e\nms.search.region: Global\n# ms.search.industry: \nms.author: nselin\nms.search.validFrom: 2016-02-28\nms.dyn365.ops.version: AX 7.0.0\n\n---\n\n# Extend the list of Electronic reporting functions\n\n[!include[banner](../includes/banner.md)]\n\n\nVarious types of functions are supported in Electronic reporting expressions for data transformation -  text, date and time, mathematical logical, information, data type conversion, and other (business domain–specific functions). In addition to built-in functions, Electronic reporting lets you extend the list of available functions. This article includes an overview of key tasks that you must complete to introduce a new function.\n\nAll Electronic reporting functions in Microsoft Dynamics 365 for Finance and Operations code are represented as classes that extend the **ERExpression** class. Two types of functions are recognized:\n\n-   **Fixed number of arguments** – These functions are represented by classes that include methods that have the prefix **parm** (see **parmInput**, **parmStartNum** in the sample code the follows). The order of arguments is set by the **SysOperationDisplayOrderAttribute** attribute.\n-   **Variable number of arguments** – These functions (see the **ERExpressionGenericCase** class) are represented by classes that implement the **ERIObjectContainer** interface. An additional **Add** method is used to declare the types that a function accepts.\n\nHere are the recommended steps for introducing a new function for Electronic reporting expressions:\n\n-   Select a base class for your function, based on the return value type (see **ERExpressionString** in the sample code that follows).\n    -   Create a new class that extends the selected class (see **ERExpressionStringMid** in the sample code the follows).\n        -   Provide required attributes:\n            -   **SysOperationLabelAttribute** – This attribute defines the function’s name.\n            -   **SysOperationHelpTextAttribute** – This attribute defines the function’s Help text.\n            -   **ERComponentGroupAttribute** – This attribute defines the group that the function belongs to. (For more information, see [Formula designer in Electronic reporting](general-electronic-reporting-formula-designer.md).)\n        -   Provide arguments:\n            -   For a fixed number of arguments function, provide methods that have the prefix **parm**, and use the **SysOperationDisplayOrderAttribute** attribute to set the order of the arguments.\n            -   For a variable number of argument function, implement the **ERIObjectContainer** interface.\n        -   Provide an evaluation method.\n\nHere is an example.\n\n    /// <summary>\n    /// Returns the characters from the middle of a text string, given a starting position and length.\n    /// </summary>\n    [\n        SysOperationLabelAttribute ('MID'),\n        SysOperationHelpTextAttribute (\"@ElectronicReporting:ExpressionStringMidHelpText\"),\n        ERComponentGroupAttribute (\"@ElectronicReporting:String\")\n    ]\n    class ERExpressionStringMid extends ERExpressionString\n    {\n        ERExpressionString input;\n        ERExpressionInt startNum;\n        ERExpressionInt numChars;\n        public str evaluateString(ERIDataContext _dataContext)\n        {\n            return subStr(\n            this.parmInput().evaluateString(_dataContext),\n            this.parmStartNum().evaluateInt(_dataContext),\n            this.parmNumChars().evaluateInt(_dataContext));\n        }\n        [DataMemberAttribute, SysOperationLabelAttribute (\"@ElectronicReporting:Input\"), SysOperationDisplayOrderAttribute (\"1\")]\n        public ERExpressionString parmInput(ERExpressionString _input = input)\n        {\n            input = _input;\n            return input;\n        }\n        [DataMemberAttribute, SysOperationLabelAttribute (\"@ElectronicReporting:NumChars\"), SysOperationDisplayOrderAttribute (\"3\")]\n        public ERExpressionInt parmNumChars(ERExpressionInt _numChars = numChars)\n        {\n            numChars = _numChars;\n            return numChars;\n        }\n        [DataMemberAttribute, SysOperationLabelAttribute (\"@ElectronicReporting:StartNum\"), SysOperationDisplayOrderAttribute (\"2\")]\n        public ERExpressionInt parmStartNum(ERExpressionInt _startNum = startNum)\n        {\n            startNum = _startNum;\n            return startNum;\n        }\n        public str toString()\n        {\n            return ERExpressionStringPresenter::namedFunctionToStr(this);\n        }\n    }\n\n## Suggested guidance\nThe following guidance is intended to help you design your custom Electronic reporting functions:\n\n-   Reuse the names of Microsoft Excel functions whenever you can, so that Electronic reporting formulas remain Excel-like. In this way, you will keep Electronic reporting formulas intelligible for end users.\n-   Electronic reporting doesn't support list types for primitive data types. Therefore, we have decided to use a data container list that has a single **Value** item in it.\n-   Release a new function's list extension as a new Finance and Operations hotfix. Electronic reporting designers will refer to the hotfix number in Electronic reporting configurations that use that new custom function. Whenever a configuration of this type is imported into a new instance of Finance and Operations, Electronic reporting will evaluate whether the required hotfix has been installed, to maintain compliance between the Electronic reporting configuration and the Finance and Operations version that configuration is imported into.\n\n\nSee also\n--------\n\n[Electronic reporting overview](general-electronic-reporting.md)\n\n[Formula designer in Electronic reporting](general-electronic-reporting-formula-designer.md)\n\n\n\n","nodes":[{"pos":[4,1071],"embed":true,"restype":"x-metadata","content":"# required metadata\n\ntitle: Extend the list of Electronic reporting functions\ndescription: Various types of functions are supported in Electronic reporting expressions for data transformation -  text, date and time, mathematical logical, information, data type conversion, and other (business domain–specific functions). In addition to built-in functions, Electronic reporting lets you extend the list of available functions. This article includes an overview of key tasks that you must complete to introduce a new function.\nauthor: kfend\nmanager: AnnBe\nms.date: 06/20/2017\nms.topic: article\nms.prod: \nms.service: dynamics-ax-platform\nms.technology: \n\n# optional metadata\n\nms.search.form: ERExpressionDesignerFormula\n# ROBOTS: \naudience: Developer, IT Pro\n# ms.devlang: \nms.reviewer: kfend\nms.search.scope: Core, AX 7.0.0, Operations, UnifiedOperations\n# ms.tgt_pltfrm: \nms.custom: 58911\nms.assetid: 62c740dc-6a88-4ded-9c41-6857b82b335e\nms.search.region: Global\n# ms.search.industry: \nms.author: nselin\nms.search.validFrom: 2016-02-28\nms.dyn365.ops.version: AX 7.0.0\n","nodes":[{"content":"Extend the list of Electronic reporting functions","nodes":[{"pos":[0,49],"content":"Extend the list of Electronic reporting functions","nodes":[{"content":"Extend the list of Electronic reporting functions","pos":[0,49]}]}],"path":["title"],"extradata":"MT"},{"content":"Various types of functions are supported in Electronic reporting expressions for data transformation -  text, date and time, mathematical logical, information, data type conversion, and other (business domain–specific functions). In addition to built-in functions, Electronic reporting lets you extend the list of available functions. This article includes an overview of key tasks that you must complete to introduce a new function.","nodes":[{"pos":[0,433],"content":"Various types of functions are supported in Electronic reporting expressions for data transformation -  text, date and time, mathematical logical, information, data type conversion, and other (business domain–specific functions). In addition to built-in functions, Electronic reporting lets you extend the list of available functions. This article includes an overview of key tasks that you must complete to introduce a new function.","nodes":[{"content":"Various types of functions are supported in Electronic reporting expressions for data transformation -  text, date and time, mathematical logical, information, data type conversion, and other (business domain–specific functions). In addition to built-in functions, Electronic reporting lets you extend the list of available functions. This article includes an overview of key tasks that you must complete to introduce a new function.","pos":[0,433],"nodes":[{"content":"Various types of functions are supported in Electronic reporting expressions for data transformation -  text, date and time, mathematical logical, information, data type conversion, and other (business domain–specific functions).","pos":[0,229]},{"content":"In addition to built-in functions, Electronic reporting lets you extend the list of available functions.","pos":[230,334]},{"content":"This article includes an overview of key tasks that you must complete to introduce a new function.","pos":[335,433]}]}]}],"path":["description"],"extradata":"MT"}],"header":"# required metadata\n","yml":true},{"pos":[1079,1128],"content":"Extend the list of Electronic reporting functions","linkify":"Extend the list of Electronic reporting functions","nodes":[{"content":"Extend the list of Electronic reporting functions","pos":[0,49]}]},{"content":"Various types of functions are supported in Electronic reporting expressions for data transformation -  text, date and time, mathematical logical, information, data type conversion, and other (business domain–specific functions).","pos":[1174,1403]},{"content":"In addition to built-in functions, Electronic reporting lets you extend the list of available functions.","pos":[1404,1508]},{"content":"This article includes an overview of key tasks that you must complete to introduce a new function.","pos":[1509,1607]},{"content":"All Electronic reporting functions in Microsoft Dynamics 365 for Finance and Operations code are represented as classes that extend the <bpt id=\"p1\">**</bpt>ERExpression<ept id=\"p1\">**</ept> class.","pos":[1609,1768],"source":"All Electronic reporting functions in Microsoft Dynamics 365 for Finance and Operations code are represented as classes that extend the **ERExpression** class."},{"content":"Two types of functions are recognized:","pos":[1769,1807]},{"content":"<bpt id=\"p1\">**</bpt>Fixed number of arguments<ept id=\"p1\">**</ept> – These functions are represented by classes that include methods that have the prefix <bpt id=\"p2\">**</bpt>parm<ept id=\"p2\">**</ept> (see <bpt id=\"p3\">**</bpt>parmInput<ept id=\"p3\">**</ept>, <bpt id=\"p4\">**</bpt>parmStartNum<ept id=\"p4\">**</ept> in the sample code the follows).","pos":[1813,2008],"source":"**Fixed number of arguments** – These functions are represented by classes that include methods that have the prefix **parm** (see **parmInput**, **parmStartNum** in the sample code the follows)."},{"content":"The order of arguments is set by the <bpt id=\"p1\">**</bpt>SysOperationDisplayOrderAttribute<ept id=\"p1\">**</ept> attribute.","pos":[2009,2094],"source":" The order of arguments is set by the **SysOperationDisplayOrderAttribute** attribute."},{"content":"<bpt id=\"p1\">**</bpt>Variable number of arguments<ept id=\"p1\">**</ept> – These functions (see the <bpt id=\"p2\">**</bpt>ERExpressionGenericCase<ept id=\"p2\">**</ept> class) are represented by classes that implement the <bpt id=\"p3\">**</bpt>ERIObjectContainer<ept id=\"p3\">**</ept> interface.","pos":[2099,2273],"source":"**Variable number of arguments** – These functions (see the **ERExpressionGenericCase** class) are represented by classes that implement the **ERIObjectContainer** interface."},{"content":"An additional <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> method is used to declare the types that a function accepts.","pos":[2274,2356],"source":" An additional **Add** method is used to declare the types that a function accepts."},{"content":"Here are the recommended steps for introducing a new function for Electronic reporting expressions:","pos":[2358,2457]},{"pos":[2463,2594],"content":"Select a base class for your function, based on the return value type (see <bpt id=\"p1\">**</bpt>ERExpressionString<ept id=\"p1\">**</ept> in the sample code that follows).","source":"Select a base class for your function, based on the return value type (see **ERExpressionString** in the sample code that follows)."},{"pos":[2603,2717],"content":"Create a new class that extends the selected class (see <bpt id=\"p1\">**</bpt>ERExpressionStringMid<ept id=\"p1\">**</ept> in the sample code the follows).","source":"Create a new class that extends the selected class (see **ERExpressionStringMid** in the sample code the follows)."},{"content":"Provide required attributes:","pos":[2730,2758]},{"pos":[2775,2851],"content":"<bpt id=\"p1\">**</bpt>SysOperationLabelAttribute<ept id=\"p1\">**</ept> – This attribute defines the function’s name.","source":"**SysOperationLabelAttribute** – This attribute defines the function’s name."},{"pos":[2868,2952],"content":"<bpt id=\"p1\">**</bpt>SysOperationHelpTextAttribute<ept id=\"p1\">**</ept> – This attribute defines the function’s Help text.","source":"**SysOperationHelpTextAttribute** – This attribute defines the function’s Help text."},{"content":"<bpt id=\"p1\">**</bpt>ERComponentGroupAttribute<ept id=\"p1\">**</ept> – This attribute defines the group that the function belongs to.","pos":[2969,3063],"source":"**ERComponentGroupAttribute** – This attribute defines the group that the function belongs to."},{"content":"(For more information, see <bpt id=\"p1\">[</bpt>Formula designer in Electronic reporting<ept id=\"p1\">](general-electronic-reporting-formula-designer.md)</ept>.)","pos":[3064,3185],"source":" (For more information, see [Formula designer in Electronic reporting](general-electronic-reporting-formula-designer.md).)"},{"content":"Provide arguments:","pos":[3198,3216]},{"pos":[3233,3416],"content":"For a fixed number of arguments function, provide methods that have the prefix <bpt id=\"p1\">**</bpt>parm<ept id=\"p1\">**</ept>, and use the <bpt id=\"p2\">**</bpt>SysOperationDisplayOrderAttribute<ept id=\"p2\">**</ept> attribute to set the order of the arguments.","source":"For a fixed number of arguments function, provide methods that have the prefix **parm**, and use the **SysOperationDisplayOrderAttribute** attribute to set the order of the arguments."},{"pos":[3433,3524],"content":"For a variable number of argument function, implement the <bpt id=\"p1\">**</bpt>ERIObjectContainer<ept id=\"p1\">**</ept> interface.","source":"For a variable number of argument function, implement the **ERIObjectContainer** interface."},{"content":"Provide an evaluation method.","pos":[3537,3566]},{"content":"Here is an example.","pos":[3568,3587]},{"pos":[5411,5429],"content":"Suggested guidance","linkify":"Suggested guidance","nodes":[{"content":"Suggested guidance","pos":[0,18]}]},{"content":"The following guidance is intended to help you design your custom Electronic reporting functions:","pos":[5430,5527]},{"content":"Reuse the names of Microsoft Excel functions whenever you can, so that Electronic reporting formulas remain Excel-like.","pos":[5533,5652]},{"content":"In this way, you will keep Electronic reporting formulas intelligible for end users.","pos":[5653,5737]},{"content":"Electronic reporting doesn't support list types for primitive data types.","pos":[5742,5815]},{"content":"Therefore, we have decided to use a data container list that has a single <bpt id=\"p1\">**</bpt>Value<ept id=\"p1\">**</ept> item in it.","pos":[5816,5911],"source":" Therefore, we have decided to use a data container list that has a single **Value** item in it."},{"content":"Release a new function's list extension as a new Finance and Operations hotfix.","pos":[5916,5995]},{"content":"Electronic reporting designers will refer to the hotfix number in Electronic reporting configurations that use that new custom function.","pos":[5996,6132]},{"content":"Whenever a configuration of this type is imported into a new instance of Finance and Operations, Electronic reporting will evaluate whether the required hotfix has been installed, to maintain compliance between the Electronic reporting configuration and the Finance and Operations version that configuration is imported into.","pos":[6133,6458]},{"pos":[6461,6469],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6480,6544],"content":"<bpt id=\"p1\">[</bpt>Electronic reporting overview<ept id=\"p1\">](general-electronic-reporting.md)</ept>","source":"[Electronic reporting overview](general-electronic-reporting.md)"},{"pos":[6546,6638],"content":"<bpt id=\"p1\">[</bpt>Formula designer in Electronic reporting<ept id=\"p1\">](general-electronic-reporting-formula-designer.md)</ept>","source":"[Formula designer in Electronic reporting](general-electronic-reporting-formula-designer.md)"}]}