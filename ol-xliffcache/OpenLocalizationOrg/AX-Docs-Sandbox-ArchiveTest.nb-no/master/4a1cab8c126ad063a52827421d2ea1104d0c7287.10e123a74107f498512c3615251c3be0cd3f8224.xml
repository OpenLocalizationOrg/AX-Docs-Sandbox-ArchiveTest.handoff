{"content":"---\n# required metadata\n\ntitle: Hardware sizing requirements for on-premises environments\ndescription: This topic lists the hardware sizing requirements for an on-premises environment.\nauthor: kfend\nmanager: AnnBe\nms.date: 06/23/2017\nms.topic: article\nms.prod: \nms.service: dynamics-ax-platform\nms.technology: \n\n# optional metadata\n\n# ms.search.form: \n# ROBOTS: \naudience: Application User, Developer, IT Pro\n# ms.devlang: \nms.reviewer: kfend\nms.search.scope: Core\n# ms.tgt_pltfrm: \nms.custom: 55651\nms.assetid: \nms.search.region: Global\n# ms.search.industry: \nms.author: chwolf\nms.search.validFrom: 2016-08-30\nms.dyn365.ops.version: Platform update 8\n\n---\n\n# Hardware sizing for on-premises environments\nBefore you begin the hardware and infrastructure sizing process for an on-premises environment, familiarize yourself with the [System requirements](../get-started/system-requirements.md) and [Setup and deployment instructions](../deployment/setup-deploy-on-premises-environments.md) to gain a solid understanding off the underlying infrastructure. \n\n  **Note:** Pay close attention to the system setup best practices for optimum performance. \n\nAfter you have reviewed the documentation, you can start the process of estimating your transactional and concurrent user volume and sizing your environment based on the average core throughput.\n\n## Factors that affect sizing\nAll the factors shown in the following illustration contribute to sizing. The more detailed information that is collected, the more precisely you can determine sizing. Hardware sizing, without supporting data, is likely to be inaccurate. The absolute minimum requirement for necessary data is the peak transaction line load per hour. \n\n[![Hardware sizing for on-premises environments](./media/lbd-sizing-01.png)](./media/lbd-sizing-01.png)\n\nViewed from left to right, the first and most important factor needed to accurately estimate sizing is a transaction profile or a transaction characterization. It’s important to always find the peak transactional volume per hour. If there are multiple peak periods, then these periods need to be accurately defined. \n\nAs you understand the load that impacts your infrastructure, you also need to understand more detail about these factors: \n\n- **Transactions** - Typically transactions have certain peaks throughout the day/week. This mostly depends on the transaction type. Time and expense entries usually show peaks once per week, whereas Sales order entries often come in bulk via integration or trickle in during the day. \n\n- **Number of concurrent users** – The number of concurrent users is the second most important sizing factor. You cannot reliably get sizing estimates based on the number of concurrent users, so if this is the only data you have available, estimate an approximate number, and then revisit this when you have more data. An accurate concurrent user definition means that: \n  - Named users are not concurrent users.\n  - Concurrent users are always a subset of named users. \n  - Peak workload defines the maximum concurrency for sizing.\n \n- Criteria for concurrent users is that the user meets all the following criteria: \n  - Logged on. \n  - Working transactions/inquiries at the time of counting. \n  - Not an idle session. \n \n- **Data composition** – This is mostly about how your system will be set up and configured. For example, how many legal entities you will have, how many items, how many BOM levels, and how complex your security setup will be. Each of those factors may have a small impact on performance, so these factors can be offset by using smart choices when it comes to infrastructure. \n\n- **Extensions** – Customizations can be simple or complex. The number of customizations and the nature of complexity and usage has a varied impact on the size of the infrastructure needed. For complex customizations, it’s advised to conduct performance evaluations to ensure that they are not only tested for efficiency but also help understand the infrastructure needs. This is even more critical when the extensions are not coded according to best practices for performance and scalability. \n\n- **Reporting and analytics** – These factors typically include running heavy queries against the various databases in the Finance and Operations database systems. Understanding and reducing the frequency when expensive reports run will help you understand the impact of them. \n\n- **Third-party solutions** – These solutions, like ISVs, have the same implications and recommendations as extensions. \n\n## Sizing your Finance and Operations environment\nTo understand your sizing requirements, you need to know the peak volume of transactions that you need to process. Most auxiliary systems, like Management Reporter or SSRS, are less mission critical. As a result, this document focuses mostly on AOS and SQL Server. \n\n**Note:** In general, the compute tiers scale out and should be set up in an N+1 fashion, meaning if you estimate three AOS, add a fourth AOS. The database tier should be set up in an Always On highly-available setup. \n\n\n## SQL Server (OLTP)\n\n### Sizing\n\n- 3K to 15K transaction lines per hour per core on DB server.\n- Typical AOS-to-SQL core ratio 3:1 for the primary SQL Server. Additional cores are required based on the chosen high availability configuration. \n  - Processing database-heavy operations may regress this to 2:1. \n- The following factors influence variations: \n  - Parameter settings in use. \n  - Levels of extensions. \n  - Usage of additional functionality, such as database log and alerts. Extreme database logging will further reduce throughput per hour per core below 3K lines. \n  - Complexity of data composition – A simple chart of accounts versus a detailed fine-grained chart of accounts has implications on throughput (as an example). \n  - Transaction characterization.\n  - 2 GB to 4 GB memory for each core. \n  - Auxiliary databases on DB server such as Management reporter and SSRS databases.\n  - Temp DB = 15% of DB size, with as many files as physical processors. \n  - SAN size and throughput based on total concurrent transaction volume/usage. \n\n### High availability \nWe recommend always utilizing SQL Server in either a cluster or mirroring setup. The second SQL node should have the same number of cores as the primary node. \n\n### Active Directory Federation Services (AD FS)\nFor AD FS sizing, see the [AD FS Server Capacity\ndocumentation](https://docs.microsoft.com/en-us/windows-server/identity/ad-fs/design/planning-for-ad-fs-server-capacity).\n\nA [sizing spreadsheet](http://adfsdocs.blob.core.windows.net/adfs/ADFSCapacity2016.xlsx)\nis available for planning the number of instances in your deployment.\n\nAOS (Online and batch)\n----------------------\n\n### Sizing\n\n- Sizing by transaction volume/usage\n  - 2K to 6K lines per core\n  - 16 GB per instance\n  - Standard box – 4 to 24 cores\n  - 10 to 15 Enterprise users per core\n  - 15 to 25 Activity users per core\n  - 25 to 50 Team members per core\n- Batch\n   - 1 to 4 batch threads per core\n   - Size based on batch window characterization\n- Note that the AOS, Data Management, and Batch are on the same role in the\nService Fabric. You need to size for these three workloads combined, and not\nseparate these like in Microsoft Dynamics AX 2012.\n- The same variability factors for SQL Server apply here.\n\n### High availability\n- Ensure that you have at least 1 to 2 more AOS available than you estimate.\n- Ensure that you have at least 3 to 4 virtual hosts available.\n\n## Management reporter\nIn most cases, unless used extensively, the recommended minimum requirements\nusing two nodes should work well. Only in cases where there is heavy use will\nyou need more than two nodes. Please scale as needed.\n\n## SQL Server Reporting Services\nFor the general availability release, only one SSRS node can be deployed. Monitor your SSRS node while testing and increase the number of cores available for SSRS on a need basis. Make sure that you have a preconfigured secondary node available on a virtual host that is different than the SSRS VM. This is important if there is an issue with the virtual machine that hosts SSRS or the virtual host. If this the case, they would need to be replaced. \n\n## Environment Orchestrator\nThe Orchestrator service is the service that manages your deployment and the related communication with LCS. This service is deployed as the primary Service Fabric service and requires at least three VMs. This service is co-located with the Service Fabric orchestration services. This and should be sized to the peak load of the cluster. For more information, see [Service Fabric cluster capacity planning considerations](/azure/service-fabric/service-fabric-cluster-capacity).  \n\n\n## Virtualization and oversubscription\nMission critical services like the AOS should be hosted on Virtual hosts that have dedicated resources – cores, memory, and disk.   \n\n","nodes":[{"pos":[4,652],"embed":true,"restype":"x-metadata","content":"# required metadata\n\ntitle: Hardware sizing requirements for on-premises environments\ndescription: This topic lists the hardware sizing requirements for an on-premises environment.\nauthor: kfend\nmanager: AnnBe\nms.date: 06/23/2017\nms.topic: article\nms.prod: \nms.service: dynamics-ax-platform\nms.technology: \n\n# optional metadata\n\n# ms.search.form: \n# ROBOTS: \naudience: Application User, Developer, IT Pro\n# ms.devlang: \nms.reviewer: kfend\nms.search.scope: Core\n# ms.tgt_pltfrm: \nms.custom: 55651\nms.assetid: \nms.search.region: Global\n# ms.search.industry: \nms.author: chwolf\nms.search.validFrom: 2016-08-30\nms.dyn365.ops.version: Platform update 8\n","nodes":[{"content":"Hardware sizing requirements for on-premises environments","nodes":[{"pos":[0,57],"content":"Hardware sizing requirements for on-premises environments","nodes":[{"content":"Hardware sizing requirements for on-premises environments","pos":[0,57]}]}],"path":["title"],"extradata":"MT"},{"content":"This topic lists the hardware sizing requirements for an on-premises environment.","nodes":[{"pos":[0,81],"content":"This topic lists the hardware sizing requirements for an on-premises environment.","nodes":[{"content":"This topic lists the hardware sizing requirements for an on-premises environment.","pos":[0,81]}]}],"path":["description"],"extradata":"MT"}],"header":"# required metadata\n","yml":true},{"pos":[660,704],"content":"Hardware sizing for on-premises environments","linkify":"Hardware sizing for on-premises environments","nodes":[{"content":"Hardware sizing for on-premises environments","pos":[0,44]}]},{"pos":[705,1052],"content":"Before you begin the hardware and infrastructure sizing process for an on-premises environment, familiarize yourself with the <bpt id=\"p1\">[</bpt>System requirements<ept id=\"p1\">](../get-started/system-requirements.md)</ept> and <bpt id=\"p2\">[</bpt>Setup and deployment instructions<ept id=\"p2\">](../deployment/setup-deploy-on-premises-environments.md)</ept> to gain a solid understanding off the underlying infrastructure.","source":"Before you begin the hardware and infrastructure sizing process for an on-premises environment, familiarize yourself with the [System requirements](../get-started/system-requirements.md) and [Setup and deployment instructions](../deployment/setup-deploy-on-premises-environments.md) to gain a solid understanding off the underlying infrastructure."},{"pos":[1057,1146],"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept> Pay close attention to the system setup best practices for optimum performance.","source":"**Note:** Pay close attention to the system setup best practices for optimum performance."},{"content":"After you have reviewed the documentation, you can start the process of estimating your transactional and concurrent user volume and sizing your environment based on the average core throughput.","pos":[1149,1343]},{"pos":[1348,1374],"content":"Factors that affect sizing","linkify":"Factors that affect sizing","nodes":[{"content":"Factors that affect sizing","pos":[0,26]}]},{"content":"All the factors shown in the following illustration contribute to sizing.","pos":[1375,1448]},{"content":"The more detailed information that is collected, the more precisely you can determine sizing.","pos":[1449,1542]},{"content":"Hardware sizing, without supporting data, is likely to be inaccurate.","pos":[1543,1612]},{"content":"The absolute minimum requirement for necessary data is the peak transaction line load per hour.","pos":[1613,1708]},{"pos":[1711,1814],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Hardware sizing for on-premises environments<ept id=\"p1\">](./media/lbd-sizing-01.png)](./media/lbd-sizing-01.png)</ept>","source":"[![Hardware sizing for on-premises environments](./media/lbd-sizing-01.png)](./media/lbd-sizing-01.png)"},{"content":"Viewed from left to right, the first and most important factor needed to accurately estimate sizing is a transaction profile or a transaction characterization.","pos":[1816,1975]},{"content":"It’s important to always find the peak transactional volume per hour.","pos":[1976,2045]},{"content":"If there are multiple peak periods, then these periods need to be accurately defined.","pos":[2046,2131]},{"content":"As you understand the load that impacts your infrastructure, you also need to understand more detail about these factors:","pos":[2134,2255]},{"content":"<bpt id=\"p1\">**</bpt>Transactions<ept id=\"p1\">**</ept> - Typically transactions have certain peaks throughout the day/week.","pos":[2260,2345],"source":"**Transactions** - Typically transactions have certain peaks throughout the day/week."},{"content":"This mostly depends on the transaction type.","pos":[2346,2390]},{"content":"Time and expense entries usually show peaks once per week, whereas Sales order entries often come in bulk via integration or trickle in during the day.","pos":[2391,2542]},{"content":"<bpt id=\"p1\">**</bpt>Number of concurrent users<ept id=\"p1\">**</ept> – The number of concurrent users is the second most important sizing factor.","pos":[2547,2654],"source":"**Number of concurrent users** – The number of concurrent users is the second most important sizing factor."},{"content":"You cannot reliably get sizing estimates based on the number of concurrent users, so if this is the only data you have available, estimate an approximate number, and then revisit this when you have more data.","pos":[2655,2863]},{"content":"An accurate concurrent user definition means that:","pos":[2864,2914]},{"content":"Named users are not concurrent users.","pos":[2920,2957]},{"content":"Concurrent users are always a subset of named users.","pos":[2962,3014]},{"content":"Peak workload defines the maximum concurrency for sizing.","pos":[3020,3077]},{"content":"Criteria for concurrent users is that the user meets all the following criteria:","pos":[3082,3162]},{"content":"Logged on.","pos":[3168,3178]},{"content":"Working transactions/inquiries at the time of counting.","pos":[3184,3239]},{"content":"Not an idle session.","pos":[3245,3265]},{"content":"<bpt id=\"p1\">**</bpt>Data composition<ept id=\"p1\">**</ept> – This is mostly about how your system will be set up and configured.","pos":[3271,3361],"source":"**Data composition** – This is mostly about how your system will be set up and configured."},{"content":"For example, how many legal entities you will have, how many items, how many BOM levels, and how complex your security setup will be.","pos":[3362,3495]},{"content":"Each of those factors may have a small impact on performance, so these factors can be offset by using smart choices when it comes to infrastructure.","pos":[3496,3644]},{"content":"<bpt id=\"p1\">**</bpt>Extensions<ept id=\"p1\">**</ept> – Customizations can be simple or complex.","pos":[3649,3706],"source":"**Extensions** – Customizations can be simple or complex."},{"content":"The number of customizations and the nature of complexity and usage has a varied impact on the size of the infrastructure needed.","pos":[3707,3836]},{"content":"For complex customizations, it’s advised to conduct performance evaluations to ensure that they are not only tested for efficiency but also help understand the infrastructure needs.","pos":[3837,4018]},{"content":"This is even more critical when the extensions are not coded according to best practices for performance and scalability.","pos":[4019,4140]},{"content":"<bpt id=\"p1\">**</bpt>Reporting and analytics<ept id=\"p1\">**</ept> – These factors typically include running heavy queries against the various databases in the Finance and Operations database systems.","pos":[4145,4306],"source":"**Reporting and analytics** – These factors typically include running heavy queries against the various databases in the Finance and Operations database systems."},{"content":"Understanding and reducing the frequency when expensive reports run will help you understand the impact of them.","pos":[4307,4419]},{"pos":[4424,4541],"content":"<bpt id=\"p1\">**</bpt>Third-party solutions<ept id=\"p1\">**</ept> – These solutions, like ISVs, have the same implications and recommendations as extensions.","source":"**Third-party solutions** – These solutions, like ISVs, have the same implications and recommendations as extensions."},{"pos":[4547,4593],"content":"Sizing your Finance and Operations environment","linkify":"Sizing your Finance and Operations environment","nodes":[{"content":"Sizing your Finance and Operations environment","pos":[0,46]}]},{"content":"To understand your sizing requirements, you need to know the peak volume of transactions that you need to process.","pos":[4594,4708]},{"content":"Most auxiliary systems, like Management Reporter or SSRS, are less mission critical.","pos":[4709,4793]},{"content":"As a result, this document focuses mostly on AOS and SQL Server.","pos":[4794,4858]},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept> In general, the compute tiers scale out and should be set up in an N+1 fashion, meaning if you estimate three AOS, add a fourth AOS.","pos":[4861,5003],"source":"**Note:** In general, the compute tiers scale out and should be set up in an N+1 fashion, meaning if you estimate three AOS, add a fourth AOS."},{"content":"The database tier should be set up in an Always On highly-available setup.","pos":[5004,5078]},{"pos":[5085,5102],"content":"SQL Server (OLTP)","linkify":"SQL Server (OLTP)","nodes":[{"content":"SQL Server (OLTP)","pos":[0,17]}]},{"pos":[5108,5114],"content":"Sizing","linkify":"Sizing","nodes":[{"content":"Sizing","pos":[0,6]}]},{"content":"3K to 15K transaction lines per hour per core on DB server.","pos":[5118,5177]},{"content":"Typical AOS-to-SQL core ratio 3:1 for the primary SQL Server.","pos":[5180,5241]},{"content":"Additional cores are required based on the chosen high availability configuration.","pos":[5242,5324]},{"content":"Processing database-heavy operations may regress this to 2:1.","pos":[5330,5391]},{"content":"The following factors influence variations:","pos":[5395,5438]},{"content":"Parameter settings in use.","pos":[5444,5470]},{"content":"Levels of extensions.","pos":[5476,5497]},{"content":"Usage of additional functionality, such as database log and alerts.","pos":[5503,5570]},{"content":"Extreme database logging will further reduce throughput per hour per core below 3K lines.","pos":[5571,5660]},{"content":"Complexity of data composition – A simple chart of accounts versus a detailed fine-grained chart of accounts has implications on throughput (as an example).","pos":[5666,5822]},{"content":"Transaction characterization.","pos":[5828,5857]},{"content":"2 GB to 4 GB memory for each core.","pos":[5862,5896]},{"content":"Auxiliary databases on DB server such as Management reporter and SSRS databases.","pos":[5902,5982]},{"content":"Temp DB = 15% of DB size, with as many files as physical processors.","pos":[5987,6055]},{"content":"SAN size and throughput based on total concurrent transaction volume/usage.","pos":[6061,6136]},{"pos":[6143,6160],"content":"High availability","linkify":"High availability","nodes":[{"content":"High availability","pos":[0,17]}]},{"content":"We recommend always utilizing SQL Server in either a cluster or mirroring setup.","pos":[6162,6242]},{"content":"The second SQL node should have the same number of cores as the primary node.","pos":[6243,6320]},{"pos":[6327,6371],"content":"Active Directory Federation Services (AD FS)","linkify":"Active Directory Federation Services (AD FS)","nodes":[{"content":"Active Directory Federation Services (AD FS)","pos":[0,44]}]},{"pos":[6372,6542],"content":"For AD FS sizing, see the <bpt id=\"p1\">[</bpt>AD FS Server Capacity documentation<ept id=\"p1\">](https://docs.microsoft.com/en-us/windows-server/identity/ad-fs/design/planning-for-ad-fs-server-capacity)</ept>.","source":"For AD FS sizing, see the [AD FS Server Capacity\ndocumentation](https://docs.microsoft.com/en-us/windows-server/identity/ad-fs/design/planning-for-ad-fs-server-capacity)."},{"pos":[6544,6702],"content":"A <bpt id=\"p1\">[</bpt>sizing spreadsheet<ept id=\"p1\">](http://adfsdocs.blob.core.windows.net/adfs/ADFSCapacity2016.xlsx)</ept> is available for planning the number of instances in your deployment.","source":"A [sizing spreadsheet](http://adfsdocs.blob.core.windows.net/adfs/ADFSCapacity2016.xlsx)\nis available for planning the number of instances in your deployment."},{"pos":[6704,6726],"content":"AOS (Online and batch)","linkify":"AOS (Online and batch)","nodes":[{"content":"AOS (Online and batch)","pos":[0,22]}]},{"pos":[6755,6761],"content":"Sizing","linkify":"Sizing","nodes":[{"content":"Sizing","pos":[0,6]}]},{"content":"Sizing by transaction volume/usage","pos":[6765,6799]},{"content":"2K to 6K lines per core","pos":[6804,6827]},{"content":"16 GB per instance","pos":[6832,6850]},{"content":"Standard box – 4 to 24 cores","pos":[6855,6883]},{"content":"10 to 15 Enterprise users per core","pos":[6888,6922]},{"content":"15 to 25 Activity users per core","pos":[6927,6959]},{"content":"25 to 50 Team members per core","pos":[6964,6994]},{"content":"Batch","pos":[6997,7002]},{"content":"1 to 4 batch threads per core","pos":[7008,7037]},{"content":"Size based on batch window characterization","pos":[7043,7086]},{"content":"Note that the AOS, Data Management, and Batch are on the same role in the Service Fabric.","pos":[7089,7178],"source":"Note that the AOS, Data Management, and Batch are on the same role in the\nService Fabric."},{"content":"You need to size for these three workloads combined, and not separate these like in Microsoft Dynamics AX 2012.","pos":[7179,7290],"source":" You need to size for these three workloads combined, and not\nseparate these like in Microsoft Dynamics AX 2012."},{"content":"The same variability factors for SQL Server apply here.","pos":[7293,7348]},{"pos":[7354,7371],"content":"High availability","linkify":"High availability","nodes":[{"content":"High availability","pos":[0,17]}]},{"content":"Ensure that you have at least 1 to 2 more AOS available than you estimate.","pos":[7374,7448]},{"content":"Ensure that you have at least 3 to 4 virtual hosts available.","pos":[7451,7512]},{"pos":[7517,7536],"content":"Management reporter","linkify":"Management reporter","nodes":[{"content":"Management reporter","pos":[0,19]}]},{"content":"In most cases, unless used extensively, the recommended minimum requirements using two nodes should work well.","pos":[7537,7647],"source":"In most cases, unless used extensively, the recommended minimum requirements\nusing two nodes should work well."},{"content":"Only in cases where there is heavy use will you need more than two nodes.","pos":[7648,7721],"source":" Only in cases where there is heavy use will\nyou need more than two nodes."},{"content":"Please scale as needed.","pos":[7722,7745]},{"pos":[7750,7779],"content":"SQL Server Reporting Services","linkify":"SQL Server Reporting Services","nodes":[{"content":"SQL Server Reporting Services","pos":[0,29]}]},{"content":"For the general availability release, only one SSRS node can be deployed.","pos":[7780,7853]},{"content":"Monitor your SSRS node while testing and increase the number of cores available for SSRS on a need basis.","pos":[7854,7959]},{"content":"Make sure that you have a preconfigured secondary node available on a virtual host that is different than the SSRS VM.","pos":[7960,8078]},{"content":"This is important if there is an issue with the virtual machine that hosts SSRS or the virtual host.","pos":[8079,8179]},{"content":"If this the case, they would need to be replaced.","pos":[8180,8229]},{"pos":[8235,8259],"content":"Environment Orchestrator","linkify":"Environment Orchestrator","nodes":[{"content":"Environment Orchestrator","pos":[0,24]}]},{"content":"The Orchestrator service is the service that manages your deployment and the related communication with LCS.","pos":[8260,8368]},{"content":"This service is deployed as the primary Service Fabric service and requires at least three VMs.","pos":[8369,8464]},{"content":"This service is co-located with the Service Fabric orchestration services.","pos":[8465,8539]},{"content":"This and should be sized to the peak load of the cluster.","pos":[8540,8597]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Service Fabric cluster capacity planning considerations<ept id=\"p1\">](/azure/service-fabric/service-fabric-cluster-capacity)</ept>.","pos":[8598,8737],"source":" For more information, see [Service Fabric cluster capacity planning considerations](/azure/service-fabric/service-fabric-cluster-capacity)."},{"pos":[8745,8780],"content":"Virtualization and oversubscription","linkify":"Virtualization and oversubscription","nodes":[{"content":"Virtualization and oversubscription","pos":[0,35]}]},{"content":"Mission critical services like the AOS should be hosted on Virtual hosts that have dedicated resources – cores, memory, and disk.","pos":[8781,8910]}]}